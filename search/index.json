[{"content":"é¡¹ç›®ä¸­ç”¨åˆ°äº†ä¹‹å‰è¯´çš„æ—¥å¿—é—¨é¢slf4j+log4jï¼Œä½†æ˜¯ä¹‹åé‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚æ¯”å¦‚ç¨‹åºæŠ¥é”™æ²¡æœ‰è®°å½•åœ¨æ—¥å¿—ï¼Œè®°å½•çš„æ—¶é—´ä¹Ÿå’ŒæœåŠ¡å™¨çš„ä¸ä¸€è‡´ï¼ˆæœåŠ¡å™¨æ˜¯ä¸œå…«åŒºæ—¶é—´ï¼‰ï¼Œæˆ–è€…è®°å½•ä¸€äº›ä¸éœ€è¦çš„ä¿¡æ¯ï¼Œæ­¤ç¯‡å°±æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚\nslf4jä¸log4j ä¹‹å‰æœ‰ä¸€ç¯‡æ–‡ç« ä»‹ç»äº†slf4jæ€ä¹ˆæ•´åˆè¿›Springbootï¼Œslf4jæ˜¯ä¸€ä¸ªæ—¥å¿—é—¨é¢ï¼Œå’Œæˆ‘ä»¬æ‰€ç”¨çš„logbackã€log4jè¿™äº›æ—¥å¿—æ¡†æ¶ä¸åŒï¼Œå®ƒæ˜¯ä¸ºè¿™äº›æ—¥å¿—æ¡†æ¶ç»Ÿä¸€è°ƒç”¨çš„APIï¼Œé€šè¿‡apiæ¥è°ƒç”¨å…·ä½“çš„æ—¥å¿—å®ç°ï¼Œç®€åŒ–äº†æ—¥å¿—çš„é…ç½®ä¸ä½¿ç”¨ã€‚slf4jè¦ä¸å…·ä½“çš„æ—¥å¿—æ¡†æ¶æ­é…ï¼Œæˆ‘ç”¨çš„æ˜¯log4jã€‚\n\u0026lt;!-- SLF4j - log4j --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.slf4j\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;slf4j-log4j12\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.8.0-alpha2\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; ä½¿ç”¨æ—¶åªè¦ç”¨æ³¨è§£@Slf4j ï¼Œç„¶åç›´æ¥ç”¨log.info() æ–¹æ³•å°±å¯ä»¥è®°å½•æ—¥å¿—äº†ã€‚\næ—¥å¿—ç­‰çº§ æ—¥å¿—åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªç­‰çº§ï¼š\nOFFï¼šæœ€é«˜ç­‰çº§çš„ï¼Œç”¨äºå…³é—­æ‰€æœ‰æ—¥å¿—è®°å½•ã€‚\nFATALï¼šä¼šå¯¼è‡´åº”ç”¨ç¨‹åºæ¨å‡ºçš„ä¸¥é‡é”™è¯¯ã€‚\nERRORï¼šè™½ç„¶å‘ç”Ÿé”™è¯¯äº‹ä»¶ï¼Œä½†ä»ç„¶ä¸å½±å“ç³»ç»Ÿçš„ç»§ç»­è¿è¡Œï¼Œä¸€èˆ¬ä¹Ÿæ˜¯ç¨‹åºçš„å„ç§Exceptionï¼Œä½†è¦æ³¨æ„çš„æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰å¼‚å¸¸éƒ½ä¼šå¯¼è‡´Errorï¼Œè¿™å°±æ˜¯ä¸‹é¢çš„è¦è¯´çš„å¼‚å¸¸æ•è·ã€‚æ‰“å°é”™è¯¯å’Œå¼‚å¸¸ä¿¡æ¯ï¼Œå¦‚æœä¸æƒ³è¾“å‡ºå¤ªå¤šçš„æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªçº§åˆ«ã€‚\nWARNï¼šè­¦å‘Šï¼Œè¡¨æ˜ä¼šå‡ºç°æ½œåœ¨é”™è¯¯çš„æƒ…å½¢ï¼Œæœ‰äº›ä¿¡æ¯ä¸æ˜¯é”™è¯¯ä¿¡æ¯ï¼Œåªæ˜¯ä¸€äº›æç¤ºã€‚\nINFOï¼šæ¶ˆæ¯åœ¨ç²—ç²’åº¦çº§åˆ«ä¸Šçªå‡ºå¼ºè°ƒåº”ç”¨ç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ã€‚æ‰“å°ä¸€äº›ä½ æ„Ÿå…´è¶£çš„æˆ–è€…é‡è¦çš„ä¿¡æ¯ï¼Œè¿™ä¸ªå¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒä¸­è¾“å‡ºç¨‹åºè¿è¡Œçš„ä¸€äº›é‡è¦ä¿¡æ¯ï¼Œä½†æ˜¯ä¸èƒ½æ»¥ç”¨ï¼Œé¿å…æ‰“å°è¿‡å¤šçš„æ—¥å¿—ã€‚\nDEBUGï¼šä¸»è¦ç”¨äºå¼€å‘è¿‡ç¨‹ä¸­æ‰“å°ä¸€äº›è¿è¡Œä¿¡æ¯ã€‚ä½†æ˜¯æ‰“å°ä½†ä¿¡æ¯é‡è¿‡å¤šï¼Œé¡¹ç›®ä¸Šçº¿åä¸è¦ç”¨ã€‚\nTRACEï¼šè·Ÿè¸ªæ—¥å¿—ï¼Œæ—¥å¿—æ¶ˆæ¯çš„ç²’åº¦å¤ªç»†ï¼Œå¾ˆä½çš„æ—¥å¿—çº§åˆ«ï¼Œä¸€èˆ¬ä¸ä¼šä½¿ç”¨ã€‚\nALLï¼šæœ€ä½ç­‰çº§çš„ï¼Œç”¨äºæ‰“å¼€æ‰€æœ‰æ—¥å¿—è®°å½•ã€‚\né€šè¿‡ä¿®æ”¹æ—¥å¿—é…ç½®æ–‡ä»¶log4j.propertiesæ¥æ”¹å˜æ—¥å¿—ç­‰çº§ï¼š\nlog4j.rootLogger = ERROR,stdout,log //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ—¥å¿—ç­‰çº§ é”™è¯¯æ•è· åœ¨SpringBootæˆ‘ä»¬å¸Œæœ›æœ‰ç»Ÿä¸€çš„æ“ä½œæ¥æ•è·ç³»ç»Ÿè¿è¡Œè¿‡ç¨‹ä¸­å‚æ•°çš„æ‰€æœ‰é”™è¯¯ï¼Œå¯¹æœªé¢„æµ‹åˆ°å¯¹é”™è¯¯è®¾ç½®å‹å¥½çš„è¿”å›å€¼ç»™ç”¨æˆ·ï¼Œé¿å…è¿”å›500çŠ¶æ€ç ã€‚ç”šè‡³å¯ä»¥å°†ç³»ç»Ÿäº§ç”Ÿçš„æŠ¥é”™é€šè¿‡é‚®ä»¶å‘é€ç»™å¼€å‘è€…ï¼Œè®©ç”Ÿäº§ç¯å¢ƒä¸­çš„é”™è¯¯èƒ½å¾—åˆ°å¿«é€Ÿç›´æ¥çš„ç›‘æµ‹å’Œè§£å†³ã€‚\næˆ‘ä»¬ç”¨åˆ°@RestControllerAdviceå’Œ@ExceptionHandler è¿™ä¸¤ä¸ªæ³¨è§£\n@Slf4j @RestControllerAdvice // ç”¨äºæ‹¦æˆªå¼‚å¸¸çš„æ³¨è§£ public class ExceptionProcesser extends ResponseEntityExceptionHandler { @Autowired private MailService mailService; /** * å…¨å±€å¼‚å¸¸æ•è·å…¥æ—¥å¿— */ // æ­¤æ³¨è§£ç”¨æ¥æ ‡ç¤ºå¤„ç†å“ªä¸ªç±»çš„å¼‚å¸¸ \t@ExceptionHandler(value = Exception.class) // è¡¨ç¤ºæ‰€æœ‰çš„å¼‚å¸¸éƒ½ä¼šå¤„ç† \tpublic CommonResult\u0026lt;String\u0026gt; defaultErrorHandler(Exception e) { // slf4jä¸‹çš„æ—¥å¿—ç”¨æ³•ï¼Œç®€æ´æ˜“ç”¨ \tlog.error(\u0026#34;defaultErrorHandler:\u0026#34;, e); // å°†æŠ¥é”™æ ˆçš„ä¿¡æ¯è½¬ä¸ºå­—ç¬¦ä¸² \tStringWriter errors = new StringWriter(); e.printStackTrace(new PrintWriter(errors)); // å‘é€é‚®ä»¶ç»™å¼€å‘è€… \tmailService.sendSimpleMail(\u0026#34;xxxxx@qq.com\u0026#34;, \u0026#34;é¡¹ç›®æŠ¥é”™\u0026#34;, errors.toString()); return CommonResult.failed(\u0026#34;è¿™é‡Œå¯èƒ½æœ‰bugï¼ŒæŠ¥é”™ä¿¡æ¯å‘ç»™ccqäº†ï¼Œæ‰¾ä»–æ”¹bugå»\u0026#34;); } /** * å¯¹ä¸€äº›æ— æ³•try/catchçš„å…·ä½“é”™è¯¯è¿˜å¯ä»¥ä¸“é—¨å¤„ç† */ @ExceptionHandler(MultipartException.class) // è¡¨ç¤ºåªå¤„ç†MultipartExceptionè¿™ä¸ªç±»ç›¸å…³çš„å¼‚å¸¸  public CommonResult\u0026lt;String\u0026gt; handleUploadFileTooLargeError() { return CommonResult.failed(ResultCode.FILE_TOO_BIG); } } æ—¥å¿—æ—¶å·® åº”ç”¨éƒ¨ç½²åˆ°çº¿ä¸Šçš„æ—¶å€™å¯èƒ½ä¼šé‡åˆ°æ—¥å¿—çš„è®°å½•æ—¶é—´å’Œæˆ‘ä»¬çš„ä¸œå…«åŒºæ—¶é—´æœ‰æ—¶å·®ï¼Œé‚£å°±æ˜¯ç»å…¸æ—¶åŒºé—®é¢˜äº†ï¼Œå¯ä»¥é€šè¿‡å¯åŠ¨jaråŒ…æ—¶è®¾ç½®å‚æ•°æ¥è§£å†³\njava -jar -Duser.timezone=GMT+08 xxx.jar ","date":"2021-03-18T23:01:00+08:00","permalink":"https://ccqstark.github.io/p/log_catch_error/","title":"[SpringBoot]æ—¥å¿—ä¸å¼‚å¸¸æ•è·"},{"content":"ç®€ä»‹ å¼•å…¥ å¯¹äºæœç´¢åŠŸèƒ½ï¼Œå¤§å®¶ä»¥å‰éƒ½æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿæˆ‘ç›¸ä¿¡å¾ˆå¤šäººä¸€å¼€å§‹ä¹Ÿæ˜¯ç”¨SQLçš„LIKEå…³é”®å­—åŠ ä¸Š%æ¥åŒ¹é…å…³é”®å­—çš„å§ï¼Œä¸ºäº†å®ç°æ›´å¥½çš„æ¨¡ç³Šæ•ˆæœå°±å†åŠ ä¸€ä¸ªåˆ†è¯å™¨æ¥æ‹†åˆ†å…³é”®è¯ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦è¢«æœç´¢çš„æ•°æ®é‡ä¸€å¤§ï¼Œè¿™ç§æ–¹å¼å°±æ˜¾å¾—æ•ˆç‡ä½ä¸‹ã€‚ä¸ºäº†å®ç°æ›´å¥½çš„æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å½“å‰æœ€æµè¡Œçš„åˆ†å¸ƒå¼æœç´¢å¼•æ“â€”â€”ElasticSearch ã€‚\nåŸºæœ¬ä»‹ç» Elasticsearch æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„å…è´¹å¼€æºæœç´¢å’Œåˆ†æå¼•æ“ï¼Œé€‚ç”¨äºåŒ…æ‹¬æ–‡æœ¬ã€æ•°å­—ã€åœ°ç†ç©ºé—´ã€ç»“æ„åŒ–å’Œéç»“æ„åŒ–æ•°æ®ç­‰åœ¨å†…çš„æ‰€æœ‰ç±»å‹çš„æ•°æ®ï¼ŒåŸºäºè‘—åçš„Luceneåº“è¿›è¡Œå¼€å‘ï¼Œå¹¶ä»¥ç®€å•çš„RESTfulé£æ ¼çš„APIè¿›è¡Œè°ƒç”¨ï¼Œæ”¯æŒJavaã€JavaScript(Node)ã€Goã€ C#(.NET)ã€PHPã€Pythonã€Rubyç­‰å¤šç§è¯­è¨€ã€‚ElasticSearchå·²ç»æˆä¸ºéå¸¸æµè¡Œçš„æœç´¢å¼•æ“ï¼Œä¸€äº›è‘—åå‚å•†ä¾‹å¦‚äº¬ä¸œã€æ»´æ»´ã€æºç¨‹ã€Stack Overflowã€GitHubç­‰éƒ½åœ¨ä½¿ç”¨ã€‚\nå®˜ç½‘åœ°å€ï¼šhttps://www.elastic.co/cn/elasticsearch/\nåº”ç”¨åœºæ™¯  åº”ç”¨ç¨‹åºæœç´¢ ç½‘ç«™æœç´¢ ä¼ä¸šæœç´¢ æ—¥å¿—å¤„ç†å’Œåˆ†æ åŸºç¡€è®¾æ–½æŒ‡æ ‡å’Œå®¹å™¨ç›‘æµ‹ åº”ç”¨ç¨‹åºæ€§èƒ½ç›‘æµ‹ åœ°ç†ç©ºé—´æ•°æ®åˆ†æå’Œå¯è§†åŒ– å®‰å…¨åˆ†æ ä¸šåŠ¡åˆ†æ  ELK ELKï¼Œå³ElasticSearch + logstash + Kibana ï¼Œæ˜¯ä¸€å¥—å¼€æºçš„æ—¥å¿—æ”¶é›†ä¸åˆ†æè§£å†³æ–¹æ¡ˆã€‚åˆ©ç”¨ElasticSearchå¯¹æ•°æ®è¿›è¡Œå¿«é€Ÿçš„å¤æ‚æ¡ä»¶æ£€ç´¢ï¼Œç”¨logstashåˆ™ä½œä¸ºæ•°æ®ç®¡é“ä»å¤šä¸ªæ¥æºè¿›è¡Œæ•°æ®çš„é‡‡é›†ã€è½¬æ¢å’Œä¼ è¾“ï¼ŒKibanaåˆ™é€šè¿‡ç”Ÿæˆå¤šç§å¯è§†åŒ–æŠ¥è¡¨æ–¹ä¾¿ç”¨æˆ·è¿›è¡Œæ—¥å¿—ç›‘æ§ã€‚\nä¸€èˆ¬å°å‹ç³»ç»Ÿæˆ‘ä»¬åˆ†ææ—¥å¿—å¯ä»¥ç›´æ¥åœ¨ç”¨grepã€awkç­‰å‘½ä»¤è¿›è¡Œè¿‡æ»¤ä¸æ£€ç´¢ï¼Œæˆ–è€…æ‹‰åˆ°æœ¬åœ°ç”¨LogViewerç­‰ä¸“é—¨çš„æ—¥å¿—å·¥å…·æ‰“å¼€æŸ¥çœ‹ã€‚ä½†æ˜¯å½“ç³»ç»Ÿä½“é‡ä¸€å¤§ï¼Œé‡‡ç”¨çš„æ˜¯åˆ†å¸ƒå¼æ¶æ„ï¼Œé›†ç¾¤ä¸­çš„æ—¥å¿—ç®¡ç†å°±æˆä¸ºä¸€ä¸ªéš¾é¢˜ã€‚ELKç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³å¤§å‹ç³»ç»Ÿä¸­çš„æ—¥å¿—æ”¶é›†ã€å­˜å‚¨ä¸åˆ†æé—®é¢˜ï¼Œæ–¹ä¾¿å°†èŠ‚ç‚¹ä¸­çš„æ—¥å¿—ç»Ÿä¸€ç®¡ç†ä»è€Œæé«˜æ•ˆç‡ã€‚\næ¦‚å¿µä»‹ç» åŸºæœ¬æ¦‚å¿µ ElasticSearchï¼ˆç®€ç§°esï¼‰æœç´¢çš„æ—¶å€™ä¸æ˜¯å»æ•°æ®åº“é‡Œæ‹¿æ•°æ®ï¼Œå®ƒæœ‰è‡ªå·±çš„ä¸€å¥—å­˜å‚¨ä¸ç´¢å¼•ä½“ç³»ã€‚æ•°æ®åº“ä¸­çš„æ•°æ®éœ€è¦åŒæ­¥åˆ°esä¸­ï¼Œé€šè¿‡ç´¢å¼•çš„å½¢å¼æ¥å­˜å‚¨æ•°æ®æ‰èƒ½å®ç°é«˜æ•ˆæ£€ç´¢ã€‚\nesç´¢å¼•ä½“ç³»çš„åŸºæœ¬æ¦‚å¿µå’Œå…³ç³»å‹æ•°æ®åº“ä¸­çš„æœ‰äº›ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ç€æ¥çœ‹\n   Index ç´¢å¼• Database æ•°æ®åº“     Type æ–‡æ¡£ç±»å‹ Table è¡¨   Document æ–‡æ¡£ Row è®°å½•   Field å­—æ®µ Column å±æ€§   Mapping æ˜ å°„ Schema æ¨¡å‹   Query DSL SQL    esçš„å±‚æ¬¡ç»„ç»‡ç»“æ„ç±»ä¼¼äºMySQLè¿™æ ·çš„å…³ç³»å‹æ•°æ®åº“ï¼Œindexå°±åƒdatabaseé‚£æ ·å­˜å‚¨ç€ä¸åŒçš„typeï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“ä¸­çš„tableï¼›å†ä¸‹ä¸€çº§å°±æ˜¯documentï¼Œç±»ä¼¼äºæ•°æ®åº“ä¸­çš„ä¸€æ¡æ¡è®°å½•ï¼›æ¯æ¡è®°å½•çš„å­—æ®µfieldå°±å¯¹åº”è¡¨ä¸­çš„columnï¼›mappingå°±å¦‚schemaé‚£æ ·è¡¨ç¤ºç€åº“è¡¨çš„æ¶æ„ï¼›esä¸­çš„æŸ¥è¯¢è¯­è¨€Query DSLåˆ™å¯¹æ ‡æˆ‘ä»¬ç†Ÿæ‚‰çš„SQLã€‚é€šè¿‡ç±»æ¯”å¯ä»¥æ›´å¿«åœ°è®¤è¯†esçš„ç»“æ„ç»„æˆã€‚\nâš ï¸ æ³¨æ„ï¼šä»6.xå¼€å§‹esæ…¢æ…¢æ”¾å¼ƒtypeï¼Œå¹¶ç»Ÿä¸€é»˜è®¤typeä¸º_docï¼Œé¢„è®¡åœ¨8.xæ­£å¼å°†å…¶ç§»é™¤ã€‚\nå…¶å®ƒæ¦‚å¿µ   Node èŠ‚ç‚¹\nå®é™…é¡¹ç›®ä¸­æˆ‘ä»¬å¾€å¾€ä¸ä¼šåªç”¨ä¸€å°æœåŠ¡å™¨æ¥éƒ¨ç½²elasticsearchï¼Œé‚£æ ·çš„è¯èƒ½å¤Ÿæ‰¿è½½çš„ç”¨æˆ·æ•°å°±éå¸¸å°‘ã€‚å› ä¸ºesæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æœç´¢å¼•æ“ï¼Œé‚£æˆ‘ä»¬å®Œå…¨å¯ä»¥éƒ¨ç½²ä¸€ä¸ªesé›†ç¾¤ï¼Œè€Œå…¶ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨å®ä¾‹å°±å«åšnode(èŠ‚ç‚¹)ã€‚\n  Cluster é›†ç¾¤\nä¸€ä¸ªclusteræ˜¯æœ‰å¤šä¸ªnodeç»„æˆçš„ï¼Œesé›†ç¾¤å¯ä»¥æ‰©å¤§å•ä¸ªèŠ‚ç‚¹çš„æ•°æ®å­˜å‚¨é‡ä»¥åŠæ‰¿è½½çš„æœç´¢è¯·æ±‚ã€‚åœ¨å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹æŒ‚æ‰çš„æƒ…å†µä¸‹ä¸å½±å“å…¶ä»–èŠ‚ç‚¹çš„æ­£å¸¸å·¥ä½œã€‚esé›†ç¾¤ä¹Ÿå¯ä»¥è®¾ç½®æˆ–é€‰ä¸¾master nodeæ¥è´Ÿè´£åˆ›å»ºç´¢å¼•ã€åˆ é™¤ç´¢å¼•ã€åˆ†é…åˆ†ç‰‡ã€è¿½è¸ªé›†ç¾¤ä¸­çš„èŠ‚ç‚¹çŠ¶æ€ç­‰ï¼Œå½“ç„¶ä¹Ÿå¯èƒ½å­˜åœ¨è„‘è£‚é—®é¢˜ã€‚å…¶å®ƒæ™®é€šèŠ‚ç‚¹ç§°ä¸ºdata nodeï¼Œç”¨æ¥æ¥å—ç”¨æˆ·çš„æœç´¢è¯·æ±‚è¿”å›æœç´¢ç»“æœã€‚\n  Shard åˆ†ç‰‡\nä¸Šé¢è¯´åˆ°é›†ç¾¤å¯ä»¥æ‰©å¤§å•æœºå­˜å‚¨ç©ºé—´è¿‡å°çš„é—®é¢˜ï¼Œè€Œå…¶ä¸­å®ç°çš„åŸç†å°±æ˜¯é€šè¿‡åˆ†ç‰‡ã€‚esé€šè¿‡å¯¹æ•°æ®è¿›è¡Œæ°´å¹³æ‹†åˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼Œç„¶ååˆ†å‘åˆ°å¤šå°ç‰©ç†æœºä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšç´¢å¼•åˆ†ç‰‡(Sharding)ï¼Œæ¯ä¸ªéƒ¨åˆ†å°±æ˜¯ä¸€ä¸ªåˆ†ç‰‡(Shard)ã€‚åˆ›å»ºç´¢å¼•æ—¶å¯ä»¥æŒ‡å®šåˆ†ç‰‡æ•°é‡ï¼Œä¸€æ—¦æŒ‡å®šå°±ä¸å¯æ›´æ”¹ã€‚shardingçš„è¿‡ç¨‹æ˜¯esè‡ªåŠ¨å®Œæˆçš„ï¼Œæ•°æ®è¢«å†™å…¥æ—¶ä¼šè¢«æŒ‡å®šå†™å…¥çš„åˆ†ç‰‡ã€‚esçš„åˆ†ç‰‡æ˜¯Luceneå®ç°çš„ã€‚\n  Replica ç´¢å¼•å‰¯æœ¬\nç´¢å¼•å‰¯æœ¬å°±æ˜¯å¯¹åˆ†ç‰‡è¿›è¡Œçš„æ‹·è´ã€‚åœ¨æŸä¸€åˆ†ç‰‡è¯·æ±‚è´Ÿè½½å¯¼è‡´é˜»å¡æ—¶ï¼ŒreplicaåŒæ ·å¯ä»¥å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ã€‚è€Œä¸”ä¸ä»…å¯ä»¥æé«˜æµé‡æ‰¿è½½èƒ½åŠ›ï¼ŒåŒæ—¶æ•°æ®ä¹Ÿæœ‰äº†ä¸€ä»½å¤‡ä»½ï¼Œå³ä½¿ä¸»åˆ†ç‰‡æ•°æ®ä¸¢æ‰ä¹Ÿå¯ä»¥ç”¨å‰¯æœ¬æ¢å¤ã€‚\n  å®‰è£…ä¸åŸºæœ¬ä½¿ç”¨ å®¹å™¨éƒ¨ç½² äº‘åŸç”Ÿæ—¶ä»£æ¨èä½¿ç”¨å®¹å™¨ï¼Œè¿™é‡Œä»¥dockerå•æœºéƒ¨ç½²ä¸ºä¾‹ç®€å•è®²ä¸‹ã€‚\n# æ‹‰å–é•œåƒï¼Œè¿™é‡Œæ˜¯7.10.1ï¼Œæ³¨æ„esç‰ˆæœ¬é—´å…¼å®¹æ€§è¾ƒå·® docker pull elasticsearch:7.10.1 # å¯åŠ¨å®¹å™¨ï¼Œé…ç½®æ–‡ä»¶å’Œæ•°æ®æŒ‚è½½å‡ºæ¥ docker run --name elasticsearch -p 9200:9200 -p 9300:9300 \\ -e ES_JAVA_OPTS=\u0026#34;-Xms256m -Xmx256m\u0026#34; -d \\ -v [ä¸»æœºæŒ‚è½½ç›®å½•]/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml \\ -v [ä¸»æœºæŒ‚è½½ç›®å½•]/data:/usr/share/elasticsearch/data elasticsearch:7.10.1 eså®¹å™¨æ˜¯æ¯”è¾ƒå å†…å­˜çš„ï¼Œæ¯•ç«Ÿä¸€å¼€å°±æ˜¯ä¸€ä¸ªJVMï¼Œå•èŠ‚ç‚¹å†…å­˜è¾ƒå°å¯ä»¥é€šè¿‡è®¾ç½®ES_JAVA_OPTS æ¥è°ƒå°JVMçš„å†…å­˜å ç”¨ï¼Œä¾‹å¦‚ä¸Šé¢ä¾‹å­ä¸­éƒ½å‚æ•°å°±æ˜¯è®¾ç½®ä¸º256Mã€‚\nå…¶ä»–å¯èƒ½å‡ºç°çš„é—®é¢˜ä»¥åŠæ›´å¤šç›¸å…³ç»„ä»¶å®‰è£…å¦‚Kibanaæˆ–ikåˆ†è¯å™¨å¯ä»¥å‚çœ‹æˆ‘çš„å¦ä¸€ç¯‡åšå®¢ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚\n[Elastic]ä½¿ç”¨dockerå®‰è£…ElasticSearch + Kibana\nRESTfulé£æ ¼æ“ä½œ esä½¿ç”¨RESTfulé£æ ¼çš„APIè¿›è¡ŒCRUDï¼Œå­˜å‚¨ä¸ä¼ è¾“ä½¿ç”¨çš„æ•°æ®å½¢å¼ä¹Ÿæ˜¯ä½¿ç”¨å¸¸è§çš„JSONï¼Œå¸¸ç”¨çš„methodå’Œå¯¹åº”çš„åŠŸèƒ½å¦‚ä¸‹ï¼š\nå…¶ä¸­æŸ¥è¯¢æ”¯æŒå¤šç§ç±»å‹çš„å¤æ‚æŸ¥è¯¢ï¼Œå¦‚matchè§£ææŸ¥è¯¢ã€æ’åºæŸ¥è¯¢ã€åˆ†é¡µæŸ¥è¯¢ã€boolæŸ¥è¯¢ã€fileteræŸ¥è¯¢ã€å¤šå…³é”®å­—æŸ¥è¯¢ã€termç²¾ç¡®æŸ¥è¯¢ã€é«˜äº®æŸ¥è¯¢ç­‰ç­‰ã€‚è¯¦ç»†å¯ä»¥æŸ¥çœ‹æˆ‘åšå®¢çš„å¦ä¸€ç¯‡æ–‡ç« ã€‚\n[ElasticSearch]RESTé£æ ¼æ“ä½œ\nå®¢æˆ·ç«¯ esæä¾›äº†å¤šç§è¯­è¨€çš„clientï¼Œå„ç§APIæ–‡æ¡£éƒ½åœ¨å®˜ç½‘å¯ä»¥æ‰¾åˆ°ã€‚å¯¹äºJavaæ¨èä½¿ç”¨Java High Level REST Clientï¼Œä¸SpringBootçš„æ•´åˆå¯ä»¥çœ‹æˆ‘å¦ä¸€ç¯‡åšå®¢ã€‚\n[SpringBoot]æ•´åˆElasticSearch\nå®˜æ–¹æ–‡æ¡£åœ°å€ï¼šhttps://www.elastic.co/guide/en/elasticsearch/client/index.html\nMySQLçš„LIKEæ¢ç©¶ ç´¢å¼•ä½¿ç”¨ æˆ‘ä»¬ä¹ æƒ¯ç”¨LIKEè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼Œä½†æ˜¯å½“æ•°æ®é‡å¾ˆå¤§æ—¶è€—æ—¶å°±ä¼šæ¯”è¾ƒä¹…ï¼Œä¹Ÿè®¸ä½ ä¼šæƒ³åˆ°ç”¨ç´¢å¼•æ¥å®ç°ä¼˜åŒ–ï¼Œä½†æ˜¯æ¨¡ç³ŠæŸ¥è¯¢ä½¿ç”¨ç´¢å¼•æ˜¯è¦æ»¡è¶³ä¸€å®šæ¡ä»¶çš„ã€‚\n å•%æ¨¡ç³Šï¼Œä¸”æŸ¥è¯¢å­—æ®µåŠ äº†ç´¢å¼• ä½¿ç”¨åŒ%è¿›è¡Œå…¨æ¨¡ç³ŠæŸ¥è¯¢ï¼Œä¸”æŠŠä¸»é”®ä½œä¸ºç»“æœé›†ï¼Œå› ä¸ºè¦†ç›–ç´¢å¼•æ‰€ä»¥æŸ¥è¯¢ä¼šèµ°ç´¢å¼• ä½¿ç”¨å…¨æ–‡ç´¢å¼•  ä¸ºäº†æ¢ç©¶åœ¨å¤§é‡æ•°æ®æƒ…å†µä¸‹LIKE+%æ–¹æ¡ˆçš„æ•ˆæœï¼Œä¸‹é¢ç”¨ä¸ªä¾‹å­æ¥å®è·µä¸€ä¸‹ã€‚\næ•°æ®å‡†å¤‡ å»ºä¸€å¼ ç®€å•çš„è¡¨ä¾›æŸ¥è¯¢ï¼Œå¼•æ“æ˜¯InnoDB\nCREATE TABLE `test_like` ( `id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT, `name` varchar(20) NOT NULL DEFAULT \u0026#39;\u0026#39;, `student_number` varchar(11) NOT NULL DEFAULT \u0026#39;\u0026#39;, PRIMARY KEY (`id`) ); å‡†å¤‡å¤šç‚¹æ•°æ®ï¼Œè¿™é‡Œæˆ‘å‡†å¤‡äº†10ä¸‡æ¡ã€‚\næ³¨æ„è¿™é‡Œä¸€æ¬¡æ€§æ’å…¥å¤ªå¤šæ•°æ®å¯èƒ½ä¼šå‡ºç°PacketTooBigExceptionï¼Œå¯ä»¥åˆ†æ‰¹æ’å…¥æˆ–è€…è®¾ç½®max_allowed_packet\n\u0026lt;insert id=\u0026#34;insertLikeTestData\u0026#34;\u0026gt; insert into test_like (`name`,`student_number`) VALUES \u0026lt;foreach collection=\u0026#34;list\u0026#34; item=\u0026#34;item\u0026#34; index=\u0026#34;index\u0026#34; separator=\u0026#34;,\u0026#34;\u0026gt; (\u0026#39;ccq\u0026#39;,\u0026#39;50377880000\u0026#39;+#{item}) \u0026lt;/foreach\u0026gt; \u0026lt;/insert\u0026gt; ç„¶åç»™æˆ‘ä»¬ç”¨æ¥æŸ¥è¯¢çš„student_numberåŠ ä¸ªç´¢å¼•\nALTER TABLE `test_like` ADD INDEX `idx_student_number`(`student_number`) USING BTREE; æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ é¦–å…ˆæˆ‘ä»¬æ‰§è¡Œselect * çš„å…¨æ¨¡ç³ŠæŸ¥è¯¢\nexplain select * from test_like where student_number like \u0026#39;%503%\u0026#39;\\G å‘ç°å¹¶æ²¡æœ‰ä½¿ç”¨ç´¢å¼•å¹¶è¿›è¡Œäº†å…¨è¡¨æ‰«æ\nid: 1 select_type: SIMPLE table: test_like partitions: NULL type: ALL possible_keys: NULL key: NULL key_len: NULL ref: NULL rows: 100076 filtered: 11.11 Extra: Using where 1 row in set, 1 warning (0.00 sec) ç„¶åæˆ‘ä»¬æ‰§è¡Œselect id çš„å•%æŸ¥è¯¢ï¼Œä¹Ÿå°±æ˜¯å°†ä¸»é”®ä½œä¸ºç»“æœé›†\nexplain select id from test_like where student_number like \u0026#39;503%\u0026#39;\\G å‘ç°çš„ç¡®ä½¿ç”¨äº†ç´¢å¼•è¿›è¡Œäº†ä¼˜åŒ–ï¼Œæ‰«æè¡Œæ•°åªæœ‰ä¸€åŠ\nid: 1 select_type: SIMPLE table: test_like partitions: NULL type: range possible_keys: idx_student_number key: idx_student_number key_len: 46 ref: NULL rows: 50038 filtered: 100.00 Extra: Using where; Using index 1 row in set, 1 warning (0.00 sec) æœ€åæˆ‘ä»¬select id çš„åŒ%æŸ¥è¯¢\nexplain select id from test_like where student_number like \u0026#39;%503%\u0026#39;\\G è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°ç¡®å®ä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„idx_student_number ï¼Œä½†æ˜¯possible_keyså±…ç„¶æ˜¯NULL\nè€Œä¸”è¿˜å‘ç°ï¼Œä½¿ç”¨ç´¢å¼•ä¸ä¸ä½¿ç”¨ç´¢å¼•ï¼Œæ‰«æè¡Œæ•°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”éƒ½æ˜¯å…¨è¡¨æ‰«æ\nid: 1 select_type: SIMPLE table: test_like partitions: NULL type: index possible_keys: NULL key: idx_student_number key_len: 46 ref: NULL rows: 100076 filtered: 11.11 Extra: Using where; Using index 1 row in set, 1 warning (0.00 sec) ä½¿ç”¨TraceæŸ¥çœ‹ä¼˜åŒ–å™¨ æˆ‘ä»¬è·Ÿè¸ªä¸€ä¸‹MySQLçš„ä¼˜åŒ–å™¨æ˜¯æ€ä¹ˆåšé€‰æ‹©çš„\n-- å¼€å¯ä¼˜åŒ–å™¨è·Ÿè¸ª set session optimizer_trace=\u0026#39;enabled=on\u0026#39;; select * from test_like where student_number like \u0026#39;%503%\u0026#39;; -- æŸ¥çœ‹ä¼˜åŒ–å™¨è¿½è¸ªå†…å®¹ select * from information_schema.optimizer_trace; æ‰¾åˆ°æŸ¥è¯¢è·¯å¾„çš„é€‰æ‹©\n\u0026#34;best_access_path\u0026#34;: { \u0026#34;considered_access_paths\u0026#34;: [ { \u0026#34;rows_to_scan\u0026#34;: 100076, \u0026#34;access_type\u0026#34;: \u0026#34;scan\u0026#34;, \u0026#34;resulting_rows\u0026#34;: 100076, \u0026#34;cost\u0026#34;: 20304, \u0026#34;chosen\u0026#34;: true } ] } ç„¶åå¯¹é€‰æ‹©ä¸»é”®çš„åŒ%æŸ¥è¯¢ä¹Ÿè¿›è¡ŒåŒæ ·çš„è·Ÿè¸ªï¼Œå‘ç°ä¸¤è€…åŒæ ·éƒ½æ˜¯ç”¨äº†é¡ºåºæ‰«æï¼Œè€Œæ²¡æœ‰ç”¨ä¸ŠB+Treeæ¥ä¼˜åŒ–ã€‚\nç»“è®º ä»ä¸Šé¢æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰åšå…¶å®ƒçš„ä¼˜åŒ–è€Œåªç”¨ç´¢å¼•æ¥ä½¿ç”¨MySQLçš„LIKEè¿›è¡Œå…¨æ¨¡ç³ŠæŸ¥è¯¢ï¼Œåœ¨æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œæ€§èƒ½è¿˜æ˜¯ä¸å°½äººæ„çš„ï¼Œè¿™ä¹Ÿè¯´æ˜äº†ä½¿ç”¨ESçš„å¿…è¦æ€§ã€‚\nç´¢å¼•åŸç† è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬æ¥è¯´è¯´ESçš„ä¸€äº›åŸç†ï¼Œçœ‹çœ‹ä¸ºä»€ä¹ˆESåœ¨æŸ¥è¯¢ä¸Šèƒ½æ›´èƒœMySQLä¸€ç­¹ã€‚\nå€’æ’ç´¢å¼• esæ˜¯é€šè¿‡Luceneçš„å€’æ’ç´¢å¼•Inverted IndexæŠ€æœ¯æ¥å®ç°æ¯”æ™®é€šå…³ç³»å‹æ•°æ®åº“æ›´å¿«çš„æŸ¥è¯¢çš„ï¼Œç‰¹åˆ«å¯¹å¤šæ¡ä»¶çš„å¤æ‚æŸ¥è¯¢ï¼Œè¿™ä¸€ç‚¹èƒ½æ›´å¥½åœ°ä½“ç°ã€‚\né‚£ä»€ä¹ˆæ˜¯å€’æ’ç´¢å¼•å‘¢ï¼Ÿå¼•ç”¨ç»´åŸºä¸Šçš„å®šä¹‰ï¼š\nå€’æ’ç´¢å¼•æ˜¯ä¸€ç§ç´¢å¼•æ–¹æ³•ï¼Œè¢«ç”¨æ¥å­˜å‚¨åœ¨å…¨æ–‡æœç´¢ä¸‹æŸä¸ªå•è¯åœ¨ä¸€ä¸ªæ–‡æ¡£æˆ–è€…ä¸€ç»„æ–‡æ¡£ä¸­çš„å­˜å‚¨ä½ç½®çš„æ˜ å°„ã€‚å®ƒæ˜¯æ–‡æ¡£æ£€ç´¢ç³»ç»Ÿä¸­æœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„ã€‚\næœ‰ä¸¤ç§ä¸åŒçš„åå‘ç´¢å¼•å½¢å¼ï¼š\n ä¸€æ¡è®°å½•çš„æ°´å¹³åå‘ç´¢å¼•ï¼ˆæˆ–è€…åå‘æ¡£æ¡ˆç´¢å¼•ï¼‰åŒ…å«æ¯ä¸ªå¼•ç”¨å•è¯çš„æ–‡æ¡£çš„åˆ—è¡¨ã€‚ ä¸€ä¸ªå•è¯çš„æ°´å¹³åå‘ç´¢å¼•ï¼ˆæˆ–è€…å®Œå…¨åå‘ç´¢å¼•ï¼‰åˆåŒ…å«æ¯ä¸ªå•è¯åœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­çš„ä½ç½®ã€‚  å…¶å®å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯æŠŠæˆ‘ä»¬ä»¥å‰è®¾è®¡è¡¨çš„é‚£ç§æŠŠæ–‡ç« å¯¹åº”é‡Œé¢æœ‰å“ªäº›å•è¯çš„ç»“æ„ï¼Œå€’è¿‡æ¥ï¼Œå˜æˆä¸€ä¸ªå•è¯ä¸è¢«åŒ…å«åœ¨å“ªäº›æ–‡ç« ä¸­çš„å¯¹åº”å…³ç³»ï¼Œå½“æˆ‘ä»¬æœç´¢ä¸€ä¸ªå•è¯çš„æ—¶å€™å°±èƒ½å¿«é€Ÿå¾—åˆ°åŒ…å«è¿™ä¸ªå•è¯çš„æ–‡ç« åˆ—è¡¨æ¥ã€‚\nä¸¾ä¸ªä¾‹å­ï¼š\næ¯”æ–¹è¯´ä¸‹é¢è¿™å¼ è¡¨\nå¯¹directå­—æ®µåˆ©ç”¨å€’æ’ç´¢å¼•ï¼Œå˜æˆï¼š\né‚£åªè¦æˆ‘ä»¬æƒ³æŸ¥frontendå¯¹åº”æœ‰å“ªäº›äººï¼Œå°±å¯ä»¥ç›´æ¥è·å¾—ä»–ä»¬çš„idåˆ—è¡¨[21,16,54]ï¼Œå¦‚æœæƒ³æŸ¥bossæœ‰å“ªäº›äººï¼Œå°±å¯ä»¥å¾—åˆ°[67,98]ã€‚è¿™æ ·å°±å¯ä»¥å¾ˆå¿«æ£€ç´¢åˆ°æˆ‘ä»¬æƒ³è¦åˆ°ç»“æœï¼Œè€Œä¸ç”¨è¿›è¡Œå…¨è¡¨çš„æœç´¢ã€‚\nå¯¹äºä¸Šé¢çš„å€’æ’è¡¨ï¼Œæˆ‘ä»¬æŠŠå…¶ä¸­æ¯ä¸€é¡¹ç§°ä¸ºTermï¼Œè¢«ç´¢å¼•çš„é‚£ä¸€åˆ—ä¹Ÿå°±æ˜¯å®ä¾‹çš„directå­—æ®µä¸ºTerm Dictionary ï¼Œå¯¹åº”è¢«æ£€ç´¢å‡ºæ¥çš„id_listå­—æ®µä¸ºPosting Listã€‚\nè¢«æ£€ç´¢çš„directå¦‚æœæŒ‰é¡ºåºæ’åˆ—çš„è¯å°±å¯ä»¥ç”¨äºŒåˆ†æœç´¢å¿«é€Ÿæ‰¾å‡ºï¼Œæˆ–è€…ä¹Ÿå¯ä»¥åœ¨å…¶ä¸Šå†åŠ ä¸€å±‚BTreeæ¥ç´¢å¼•ï¼Œæé«˜å…³é”®è¯æœ¬èº«çš„æœç´¢é€Ÿåº¦ã€‚\nTerm Index å½“æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ï¼ŒTerm Dictionaryä¹Ÿä¼šå˜å¾—å¾ˆå¤§ï¼Œæ— æ³•å®Œå…¨æ”¾å…¥å†…å­˜ï¼ˆesæœ¬èº«è¿è¡Œå·²ç»å ç”¨éå¸¸å¤§çš„å†…å­˜äº†ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å†åŠ ä¸€å±‚ç´¢å¼•å«Term Indexã€‚\nesä½¿ç”¨ Burst-Trie ç»“æ„æ¥å®ç°ï¼Œå®ƒæ˜¯å­—å…¸æ ‘ï¼ˆå‰ç¼€æ ‘ï¼‰Trie çš„ä¸€ç§å˜ç§ï¼Œå®ƒä¸»è¦æ˜¯å°†åç¼€è¿›è¡Œäº†å‹ç¼©ï¼Œé™ä½äº†Trieçš„é«˜åº¦ï¼Œä»è€Œè·å–æ›´å¥½æŸ¥è¯¢æ€§èƒ½ã€‚\nå¯ä»¥çœ‹åˆ°è¿™æ£µæ ‘çš„æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œæ¥ä¸‹æ¥æ¯ä¸€å±‚æ˜¯å•è¯çš„ä»å¤´åˆ°ä½çš„é¡ºåºçš„å­—æ¯ï¼ŒæŸä¸€èŠ‚ç‚¹çš„å­èŠ‚ç‚¹è¿æ¥æ‰€æœ‰å•è¯ä¸­å¯èƒ½å‡ºç°çš„ä¸‹ä¸€ä¸ªå­—æ¯ï¼Œæ ¹æ®ä¸‹ä¸€ä¸ªå­—æ¯çš„å¯èƒ½çš„æƒ…å†µæ¥åˆ†å‰ï¼ŒåŒæ—¶å¤šä½™çš„åç¼€ä¹Ÿè¢«çœç•¥ã€‚æŸ¥è¯¢æ—¶å¯ä»¥å…ˆå°†Term Indexç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œæ®æ­¤æ‰¾åˆ°æˆ‘ä»¬è¦çš„Term Dictionaryå†å»è¯»ç£ç›˜ï¼Œå¯ä»¥å‡å°‘ç£ç›˜I/Oæ¬¡æ•°ã€‚\nè”åˆæŸ¥è¯¢åˆå¹¶ å½“æˆ‘ä»¬ç”¨esè¿›è¡Œè”åˆæŸ¥è¯¢æ—¶ï¼Œæ¯”å¦‚æŸ¥æ‰¾æ–¹å‘ä¸ºbackendä¸”å¹´ä»½ç­‰äº2019çš„äººï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹directå’Œyearå­—æ®µåˆ†åˆ«ç”¨å€’æ’ç´¢å¼•æŸ¥æ‰¾å‡ºç»“æœé›†ï¼Œæœ€åå¯¹ç»“æœé›†è¿›è¡Œåˆå¹¶å°±è¡Œäº†ã€‚\nåœ¨å…³ç³»å‹æ•°æ®åº“ä¸­æˆ‘ä»¬ä¸€èˆ¬ä¼šç”¨joinæ¥åˆå¹¶ä¸¤è¡¨ï¼Œè¿™é‡Œå†æ¬¡é­å°¸ä¸€ä¸‹MySQLï¼Œå®ƒçš„joinå®ç°æ€§èƒ½ä¹Ÿå¾ˆå·®ã€‚æ¯”å¦‚ä¸‹é¢è¿™æ ·çš„SQLï¼š\nselect * from t2 straight_join t1 on (t2.a=t1.a); straight_join ä¿è¯ä¼˜åŒ–å™¨ä¸æ”¹å˜é©±åŠ¨è¡¨ï¼Œç”¨Index Nested-Loop Join ç®—æ³•æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š\n ä» t2 è¡¨ä¸­è¯»å–ä¸€è¡Œæ•°æ® L2 ä½¿ç”¨L2çš„ a å­—æ®µï¼Œå» t1 è¡¨ä¸­ä½œä¸ºæ¡ä»¶è¿›è¡ŒæŸ¥è¯¢ å–å‡º t1 ä¸­æ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œ è·Ÿ L2ç»„æˆç›¸åº”çš„è¡Œï¼Œæˆä¸ºç»“æœé›†çš„ä¸€éƒ¨åˆ† é‡å¤æ‰§è¡Œï¼Œç›´åˆ°æ‰«æå®Œ t2 è¡¨  æ‰€ä»¥é˜¿é‡Œå¼€å‘è€…è§„èŒƒç¦æ­¢ä¸‰å¼ è¡¨ä»¥ä¸Šçš„ join æ“ä½œï¼Œæ˜¯æœ‰åŸå› æ»´ã€‚\nè€ŒElasticsearchä½¿ç”¨è·³è¡¨Skip Listå’Œä½å›¾Bitsetæ¥åˆå¹¶ç»“æœé›†ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹è¿™ä¸¤ç§æ–¹æ³•ã€‚\nSkip Liståˆå¹¶ç­–ç•¥ è¯´åˆ°è·³è¡¨ï¼Œæˆ‘ä»¬é¦–å…ˆè®²ä¸€ä¸‹æ™®é€šçš„é“¾è¡¨ï¼Œå¦‚ä¸‹å›¾ï¼š\nå›¾ä¸­çš„é“¾è¡¨é™¤äº†é¦–ä½èŠ‚ç‚¹ä¹‹å¤–ï¼Œå…¶å®ƒèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä½†æ˜¯ç”±äºä¸æ˜¯é¡ºåºå­˜å‚¨ï¼Œæˆ‘ä»¬æ— æ³•ä»å…¶ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹æ¨ç®—å‡ºå…¶å®ƒä»»æ„ä¸€ä¸ªèŠ‚ç‚¹çš„ä½ç½®ï¼ˆé™¤éæ˜¯å®ƒæŒ‡å‘çš„ä¸‹ä¸€èŠ‚ç‚¹ï¼‰ã€‚å› æ­¤ç”¨è¿™ä¸ªæ•°æ®ç»“æ„æ¥å¯»æ‰¾æŸä¸€èŠ‚ç‚¹æ•ˆç‡åä½ã€‚\nç„¶åè¯´è·³è¡¨Skip Listï¼Œå®é™…ä¸Šæ˜¯åœ¨é“¾è¡¨çš„åŸºç¡€ä¸Šå¤šåŠ äº†å‡ å±‚ç´¢å¼•ï¼Œä½¿å¾—æŸ¥è¯¢æ•ˆç‡åŠ å¿«ï¼Œå¦‚å›¾ï¼š\næˆ‘ä»¬åœ¨åŸæ¥çš„é“¾è¡¨ä¸Šå¤šåŠ äº†ä¸‰å±‚ï¼Œè€Œä¸Šé¢çš„æ¯ä¸€å±‚å„èŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»éƒ½åœ¨é€çº§é€’å¢ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡è·¨åˆ°æœ¬å±‚çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸­é—´è·³è·ƒçš„ç›¸å¯¹ä¸åº•å±‚çš„èŠ‚ç‚¹æ•°è¶Šæ¥è¶Šå¤šï¼Œæ‰€ä»¥å«è·³è¡¨ã€‚åˆ©ç”¨è¿™ç§æ•°æ®ç»“æ„çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬åœ¨éå†åŸé“¾è¡¨çš„æ—¶å€™å°±å¯ä»¥åˆ©ç”¨ä¸Šé¢çš„ç´¢å¼•æ¥æ¯æ¬¡å¤šè·³å‡ ä¸ªèŠ‚ç‚¹ï¼Œä»è€ŒåŠ å¿«é€Ÿåº¦ã€‚\nESåˆ©ç”¨Skip Listè¿›è¡Œåˆå¹¶ç»“æœé›†çš„æ—¶å€™å°±æ˜¯ä»ä¸Šå¾€ä¸‹ï¼Œæ‰¾åˆ°èŠ‚ç‚¹å€¼å¤§äºç­‰äºç›®æ ‡å€¼çš„æœ€å°èŠ‚ç‚¹ï¼Œå¦‚æœè¿˜æ˜¯å¤§äºç›®æ ‡å€¼ï¼Œé‚£å°±å¾€ä¸‹ä¸€å±‚ï¼Œç›¸å½“äºå¢åŠ æŸ¥æ‰¾ç²¾åº¦ã€‚ä¾‹å¦‚æˆ‘ç°åœ¨è¦æ‰¾çš„ç›®æ ‡å€¼ä¸º2ï¼Œä»æœ€ä¸Šä¸€å±‚å¼€å§‹æ‰¾ï¼Œè¿™å±‚æ˜¯0â€”\u0026gt;6ï¼Œ6æ˜æ˜¾å¤§äº2äº†ï¼Œåˆ°ä¸‹ä¸€å±‚ï¼›è¿™ä¸€å±‚æ˜¯0â€”\u0026gt;4â€”\u0026gt;6ï¼Œæ‰¾åˆ°4è¿˜æ˜¯å¤§äº2ï¼Œé‚£ç»§ç»­ä¸‹ä¸€å±‚ï¼›è¿™æ—¶æ˜¯0â€”\u0026gt;2â€”\u0026gt;4â€”\u0026gt;6ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°ç›®æ ‡å€¼2äº†ã€‚\nåˆ©ç”¨è·³è¡¨ï¼ŒESåœ¨æ‰¾ä¸¤ä¸ªç»“æœé›†çš„äº¤é›†çš„æ—¶å€™å°±ä¼šå¿«å¾ˆå¤šã€‚\nRoaring Bitsetåˆå¹¶ç­–ç•¥ é™¤äº†ç”¨Skip Listæ¥åŠ å¿«åˆå¹¶ä¹‹å¤–ï¼ŒESè¿˜ä¼šæŠŠä¸åŒæ¡ä»¶æŸ¥è¯¢çš„ç»“æœé›†Posting Listæ”¾åˆ°å†…å­˜ä¸­ç¼“å­˜ã€‚å¦‚æœç›´æ¥ç”¨æ™®é€šçš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚æ•°ç»„è¿™æ ·çš„ï¼Œå°±å…¶å®å¾ˆæ¶ˆè€—ç©ºé—´ï¼›å¦‚æœç”¨Bitsetï¼Œå¯èƒ½ä¼šæœ‰è¿‡äºç¨€ç–è€Œå¯¼è‡´çš„ç©ºé—´æµªè´¹ã€‚æ‰€ä»¥ESé‡‡ç”¨å‹ç¼©æ•ˆç‡æ›´é«˜çš„Roaring Bitmapæ¥å­˜å‚¨ã€‚\n è¿™é‡Œæ’æ’­ä¸€é“é¢è¯•é¢˜ï¼šç»™å®šå«æœ‰40äº¿ä¸ªä¸é‡å¤çš„ä½äº[0, 2^32 - 1]åŒºé—´å†…çš„æ•´æ•°çš„é›†åˆï¼Œå¦‚ä½•å¿«é€Ÿåˆ¤å®šæŸä¸ªæ•°æ˜¯å¦åœ¨è¯¥é›†åˆå†…ï¼Ÿ\n  å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨ unsigned long æ•°ç»„æ¥å­˜å‚¨å®ƒçš„è¯ï¼Œä¹Ÿå°±éœ€è¦æ¶ˆè€— 40äº¿ * 32 ä½ =160äº¿Byteï¼Œå¤§çº¦æ˜¯ 16000 MBã€‚ å¦‚æœä½¿ç”¨ä½å›¾ Bitset æ¥å­˜å‚¨çš„è¯ï¼Œå³æŸä¸ªæ•°å¦‚æœå­˜åœ¨çš„è¯ï¼Œå°±å°†å®ƒå¯¹åº”çš„ä½å›¾å†…çš„æ¯”ç‰¹ç½®ä¸º1ï¼Œå¦åˆ™ä¿æŒä¸º0ã€‚è¿™æ ·å¤šå°‘ä¸ªæ ‘å°±åªéœ€è¦æ¶ˆè€—å¤šå°‘bitæ¥å­˜ï¼Œè¿™é‡Œæ˜¯ 2 ^ 32 ä½ = 512 MBï¼Œè¿™å¯åªæœ‰åŸæ¥çš„ 3.2 % å·¦å³ã€‚\n Roaring Bitmapåˆæ˜¯å¦‚ä½•æ¥è§£å†³ç¨€ç–çš„é—®é¢˜çš„å‘¢ï¼Ÿç›´æ¥ä¸Šå›¾ï¼š\nå¦‚å›¾ä¸­æ‰€ç¤ºï¼Œæˆ‘ä»¬æŠŠå¾…å­˜æ•°é™¤ä»¥65535ï¼Œå¹¶æ ¹æ®æ‰€å¾—å•†å’Œä½™æ•°åˆ†ç»„ã€‚ç„¶åæŠŠç›¸åŒå•†çš„ç»„åˆ†åˆ°åŒä¸€ä¸ªå­˜å‚¨å•å…ƒï¼Œè¿™ä¸ªå­˜å‚¨å•å…ƒç§°ä¸ºcontainerï¼Œæœ€ååªéœ€è¦å­˜å„containerä¸­çš„ä½™æ•°å³å¯ã€‚\næ‰€ä»¥RoaringBitmapå…¶å®å°±æ˜¯å¾ˆå¤šcontainerçš„é›†åˆï¼Œå¦‚æœæ˜¯ä¸€ä¸ª32ä½unsigned longçš„è¯ï¼Œé‚£æœ€å¤šå°±æœ‰2^32 / 65535 = 65535ä¸ªcontainerã€‚\nå¯¹äºå…¶ä¸­çš„ä½™æ•°çš„å­˜å‚¨ï¼ˆä½16ä½ï¼‰ï¼Œåˆ™æ˜¯ä»¥ä¸‹çš„å­˜å‚¨è§„åˆ™ï¼š\n ä½™æ•°å°äº 2 ^ 12 æ¬¡æ–¹ï¼ˆ4096ï¼‰æ—¶ï¼Œä½¿ç”¨unsigned shortç±»å‹çš„æœ‰åºæ•°ç»„æ¥å­˜å‚¨ï¼Œæœ€å¤§æ¶ˆè€—ç©ºé—´ä¸ºÂ 8 KBã€‚ ä½™æ•°å¤§äº 4096 æ—¶ï¼Œåˆ™ä½¿ç”¨å¤§å°ä¸º 2 ^ 16 æ¬¡æ–¹çš„æ™®é€š bitset æ¥å­˜å‚¨ï¼Œå›ºå®šæ¶ˆè€— 8 KBã€‚æœ‰äº›æ—¶å€™ä¹Ÿä¼šå¯¹ bitset è¿›è¡Œrun-length encodingå‹ç¼©ï¼Œè¿›ä¸€æ­¥ç¼©å°å ç”¨å†…å­˜ã€‚  ESåˆ©ç”¨Roaring Bitsetç¼“å­˜ä¸åŒæ¡ä»¶æŸ¥å‡ºæ¥çš„Posting Listï¼Œæœ€åé€šè¿‡ä¸æ“ä½œåˆå¹¶å‡ºæœ€ç»ˆç»“æœé›†ã€‚\nå°ç»“  ElasticSearchæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å¼€æºæœç´¢å¼•æ“ï¼Œæ”¯æŒå¤šç§è¯­è¨€å®¢æˆ·ç«¯ï¼Œæ‹¥æœ‰ä¸°å¯Œçš„åº”ç”¨åœºæ™¯ï¼Œå—åˆ°è®¸å¤šä¼ä¸šçš„é’çã€‚ ElasticSearchæ–¹ä¾¿éƒ¨ç½²é›†ç¾¤ï¼Œä½¿ç”¨RESTfulé£æ ¼ç­‰APIè¿›è¡Œè°ƒç”¨ã€‚ MySQLçš„LIKEå­—å¥åªåœ¨ç‰¹å®šæƒ…å†µä¸‹æ‰ä½¿ç”¨ç´¢å¼•ï¼Œä¸”æ€§èƒ½ä¸é«˜ï¼Œæ— æ³•åº”å¯¹å¤§æ•°æ®äº®æœç´¢ä»»åŠ¡ã€‚ ElasticSearchä½¿ç”¨å€’æ’ç´¢å¼•ä¸Term Indexæ¥æé«˜æœç´¢æ•ˆç‡ï¼Œå‡å°‘ç£ç›˜I/Oã€‚ ElasticSearchä½¿ç”¨Skip Listå’ŒRoaring Bitsetæ¥åˆå¹¶å¤æ‚æ¡ä»¶æŸ¥è¯¢çš„ç»“æœé›†ã€‚  å‚è€ƒæ–‡ç«   https://mp.weixin.qq.com/s/LU77ToU4b7O8WqjRRf1AqA https://www.cnblogs.com/Howinfun/p/12449975.html?spm=a2c6h.12873639.0.0.7b354fc6zDKM52 https://ccqstark.github.io/p/es_docker/ https://arxiv.org/pdf/1402.6407.pdf  ","date":"2021-03-13T23:01:00+08:00","image":"https://ccqstark.github.io/p/es_principle/es_hu709c9dbb1dd93df65cfe69a9e6744979_88514_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/es_principle/","title":"[ElasticSearch]ElasticSearchå…¥é—¨ä¸åŸç†æµ…æ"},{"content":"ç®€ä»‹ DubboåŸæœ¬æ˜¯é˜¿é‡Œçš„å¼€æºæ¡†æ¶ï¼Œæœ‰å¾ˆå¤šè‘—åå‚å•†éƒ½åœ¨ç”¨ã€‚ä½†åœ¨14å¹´åœæ›´ï¼Œä¹‹åSpring Cloudå¤§çº¢å¤§ç´«ï¼ŒDubboç»ˆäºåœ¨17å¹´å†åº¦æ›´æ–°ï¼Œå¹¶åœ¨18å¹´åˆå¹¶å½“å½“ç½‘çš„åŸºäºå®ƒå¼€å‘å‡ºçš„DubboXæ¨å‡ºäº†2.6ç‰ˆæœ¬ã€‚ä¹‹ååœ¨18å¹´é™¤å¤•å¤œï¼Œé˜¿é‡Œæ­£å¼å°†DubboæçŒ®ç»™äº†è‘—åå¼€æºç»„ç»‡Apacheï¼Œæˆä¸ºApacheä¼—å¤šå¼€æºé¡¹ç›®ä¹‹ä¸€ã€‚\nApache Dubbo\nZooKeeper ä¹Ÿæ˜¯ Apache è½¯ä»¶åŸºé‡‘ä¼šçš„ä¸€ä¸ªè½¯ä»¶é¡¹ç›®ï¼Œå®ƒä¸ºå¤§å‹åˆ†å¸ƒå¼è®¡ç®—æä¾›å¼€æºçš„åˆ†å¸ƒå¼é…ç½®æœåŠ¡ã€åŒæ­¥æœåŠ¡å’Œå‘½åæ³¨å†Œã€‚\nZooKeeper çš„æ¶æ„é€šè¿‡å†—ä½™æœåŠ¡å®ç°é«˜å¯ç”¨æ€§ã€‚\nZookeeper çš„è®¾è®¡ç›®æ ‡æ˜¯å°†é‚£äº›å¤æ‚ä¸”å®¹æ˜“å‡ºé”™çš„åˆ†å¸ƒå¼ä¸€è‡´æ€§æœåŠ¡å°è£…èµ·æ¥ï¼Œæ„æˆä¸€ä¸ªé«˜æ•ˆå¯é çš„åŸè¯­é›†ï¼Œå¹¶ä»¥ä¸€ç³»åˆ—ç®€å•æ˜“ç”¨çš„æ¥å£æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚\nä¸€ä¸ªå…¸å‹çš„åˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºå¯ä»¥åŸºäºå®ƒå®ç°è¯¸å¦‚æ•°æ®å‘å¸ƒ/è®¢é˜…ã€è´Ÿè½½å‡è¡¡ã€å‘½åæœåŠ¡ã€åˆ†å¸ƒå¼åè°ƒ/é€šçŸ¥ã€é›†ç¾¤ç®¡ç†ã€Master é€‰ä¸¾ã€åˆ†å¸ƒå¼é”å’Œåˆ†å¸ƒå¼é˜Ÿåˆ—ç­‰åŠŸèƒ½ã€‚\nApache ZooKeeper\nå®‰è£… ä½¿ç”¨Dubboå¼•å…¥ç›¸å…³ä¾èµ–å³å¯ï¼Œä¸‹é¢å…·ä½“å®è·µä¼šæ¶‰åŠã€‚\nZooKeeperå¯ä»¥å»å®˜ç½‘ä¸‹è½½å®‰è£…ï¼Œè¿™é‡Œæˆ‘è¿˜æ˜¯ç”¨dockeråœ¨LinuxæœåŠ¡å™¨ä¸Šå®‰è£…ã€‚\n# æ‹‰å–é•œåƒ docker pull zookeeper # å¯åŠ¨ docker run -d \\ -p 2181:2181 \\ -v /home/zookeeper/data/:/data/ \\ --name=zookeeper \\ --privileged zookeeper # å¦‚æœæƒ³è¿è¡Œè‡ªå¸¦çš„å®¢æˆ·ç«¯å¯ä»¥ï¼š docker exec -it zookeeper bash cd bin ./zkCli.sh # ä¹‹åå°±å¯ä»¥ä½¿ç”¨ç›¸å…³å‘½ä»¤äº† å®‰è£…ZooInspectoræ¥å¯è§†åŒ–æŸ¥çœ‹zookeeper\n\n# ä¸‹è½½åè¿›å…¥buildç›®å½•è¿è¡ŒjaråŒ…ï¼Œè¾“å…¥zookeeperçš„åœ°å€å³å¯è¿æ¥ java -jar zookeeper-dev-ZooInspector.jar ä½¿ç”¨dubbo-adminå¯è§†åŒ–ç›‘æ§æœåŠ¡ dubbo-adminæ˜¯ä¸€ä¸ªSpringbooté¡¹ç›®ï¼Œå¯ä»¥ç›‘æ§æˆ‘ä»¬æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒåˆ°æœåŠ¡ã€‚\nåˆ°githubä¸Šä¸‹è½½\napache/dubbo-admin\nè§£å‹ååœ¨application.propertiesä¸­ä¿®æ”¹zookeeperåœ°å€\ndubbo.registry.address=zookeeper://[ip]:2181 ä¹‹åç”¨mvnå‘½ä»¤æ‰“åŒ…å†è¿è¡ŒjaråŒ…å³å¯ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ideaé‡Œæ‰“åŒ…\nè¿è¡Œåæµè§ˆå™¨ æ‰“å¼€localhost:7001 ï¼Œè¾“å…¥è´¦å·å¯†ç é»˜è®¤éƒ½ä¸ºrootï¼Œæ¥åˆ°ä¸»é¡µ\nä¸­é—´çš„æœç´¢æ¡†å¯ä»¥æœç´¢æœåŠ¡ã€åº”ç”¨ã€ipï¼Œèœå•æ ä¸Šä¹Ÿæœ‰å„ç§ç›‘æ§æœåŠ¡çš„æ–¹å¼ã€‚\nSpringBoot Demo ç”¨ideaå»ºç«‹ä¸€ä¸ªç©ºé¡¹ç›®ï¼Œç„¶åæ·»åŠ ä¸¤ä¸ªModulesï¼Œéƒ½ä¸ºSpringbooté¡¹ç›®ã€‚\nä¸€ä¸ªä½œä¸ºæœåŠ¡æä¾›è€…providerï¼Œä¸€ä¸ªä½œä¸ºæœåŠ¡æ¶ˆè´¹è€…consumer\nä¸¤è€…éƒ½æ·»åŠ ä»¥ä¸‹mavenä¾èµ–\n\u0026lt;!-- https://mvnrepository.com/artifact/org.apache.dubbo/dubbo-spring-boot-starter --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.dubbo\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;dubbo-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.7.8\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.github.sgroschupf\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zkclient\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.1\u0026lt;/version\u0026gt; \u0026lt;exclusions\u0026gt; \u0026lt;exclusion\u0026gt; \u0026lt;artifactId\u0026gt;zookeeper\u0026lt;/artifactId\u0026gt; \u0026lt;groupId\u0026gt;org.apache.zookeeper\u0026lt;/groupId\u0026gt; \u0026lt;/exclusion\u0026gt; \u0026lt;/exclusions\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- https://mvnrepository.com/artifact/org.apache.curator/curator-framework --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.curator\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;curator-framework\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.12.0\u0026lt;/version\u0026gt; \u0026lt;exclusions\u0026gt; \u0026lt;exclusion\u0026gt; \u0026lt;artifactId\u0026gt;zookeeper\u0026lt;/artifactId\u0026gt; \u0026lt;groupId\u0026gt;org.apache.zookeeper\u0026lt;/groupId\u0026gt; \u0026lt;/exclusion\u0026gt; \u0026lt;/exclusions\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- https://mvnrepository.com/artifact/org.apache.curator/curator-recipes --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.curator\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;curator-recipes\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.12.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- https://mvnrepository.com/artifact/org.apache.zookeeper/zookeeper --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.zookeeper\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zookeeper\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.6.2\u0026lt;/version\u0026gt; \u0026lt;exclusions\u0026gt; \u0026lt;exclusion\u0026gt; \u0026lt;artifactId\u0026gt;log4j\u0026lt;/artifactId\u0026gt; \u0026lt;groupId\u0026gt;log4j\u0026lt;/groupId\u0026gt; \u0026lt;/exclusion\u0026gt; \u0026lt;exclusion\u0026gt; \u0026lt;groupId\u0026gt;org.slf4j\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;slf4j-log4j12\u0026lt;/artifactId\u0026gt; \u0026lt;/exclusion\u0026gt; \u0026lt;/exclusions\u0026gt; \u0026lt;/dependency\u0026gt; å…¶ä¸­Curatoræ˜¯zookeeperåˆ†å¸ƒå¼åè°ƒæœåŠ¡çš„javaå®¢æˆ·ç«¯åº“ï¼Œå®ƒåŒ…è£…äº†ä¸€ç³»åˆ—æ“ä½œzkçš„é«˜çº§APIå’Œå®ç”¨åº“ï¼Œæ˜¯çš„æ“ä½œzkå˜å¾—æ›´åŠ å®¹æ˜“å’Œå¯é ã€‚\nåœ¨provideré¡¹ç›®ä¸­åˆ›å»ºå¹¶æ³¨å†ŒæœåŠ¡ åŒ…ç›®å½•éƒ½æ˜¯å°±ç›´æ¥com.xxxï¼Œä¸è¦å¤šä¸€çº§ï¼Œç„¶ååœ¨provideré¡¹ç›®çš„com.xxxè·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªserviceç›®å½•ï¼Œå†™ä¸€ä¸ªç®€å•çš„æœåŠ¡æ¥å£\npackage com.ccqstark.service; public interface TicketService { String getTicket(); } ç„¶åæ˜¯å…¶å®ç°\nimport com.ccqstark.service.TicketService; import org.apache.dubbo.config.annotation.DubboService; import org.springframework.stereotype.Component; @DubboService // æœåŠ¡æ³¨å†Œæ³¨è§£ @Component public class TicketServiceImpl implements TicketService { @Override public String getTicket(){ return \u0026#34;dubbo+zookeeper!\u0026#34;; } } å…¶ä¸­æ³¨è§£@DubboService ç”¨æ¥æŠŠè¯¥æœåŠ¡æ³¨å†Œåˆ°zookeeperä¸­\nä¿®æ”¹provideré¡¹ç›®çš„application.properties\n# æœåŠ¡åº”ç”¨åç§° dubbo.application.name=provider-server # æ³¨å†Œä¸­å¿ƒåœ°å€ dubbo.registry.address=zookeeper://[ip]:2181 # è¢«æ³¨å†Œçš„æœåŠ¡ dubbo.scan.base-packages=com.ccqstark.service ç„¶åå¯åŠ¨é¡¹ç›®ï¼Œå°±å¯ä»¥åœ¨ä¹‹å‰å®‰è£…çš„dubboä¸­å‘ç°è¯¥æœåŠ¡äº†\nåœ¨consumeré¡¹ç›®ä¸­è°ƒç”¨æœåŠ¡ é…ç½®æ–‡ä»¶ä¸­å¢åŠ é…ç½®\n# æ¶ˆè´¹è€…æš´éœ²çš„æœåŠ¡åº”ç”¨åç§° dubbo.application.name=consumer-server # æ³¨å†Œä¸­å¿ƒåœ°å€ dubbo.registry.address=zookeeper://[ip]:2181 åŒæ ·åˆ›å»ºcom.xxx.serviceåŒ…ï¼ŒæŠŠprovideré‡Œçš„TicketServiceçš„æ¥å£æ–‡ä»¶å¤åˆ¶è¿‡æ¥\nåˆ›å»ºä¸€ä¸ªè°ƒç”¨æ­¤æœåŠ¡çš„ä¾‹å­\nimport org.apache.dubbo.config.annotation.DubboReference; import org.springframework.stereotype.Service; @Service public class UserService { @DubboReference // è·å–æ³¨å†Œä¸­å¿ƒä¸­çš„æœåŠ¡  TicketService ticketService; public void buyTicket() { String ticket = ticketService.getTicket(); System.out.println(\u0026#34;è°ƒç”¨providerçš„æœåŠ¡ï¼š\u0026#34; + ticket); } } æ³¨è§£@DubboReference ç”¨äºè·å–æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡\nå†™ä¸ªå•å…ƒæµ‹è¯•\n@SpringBootTest class ConsumerServerApplicationTests { @Autowired UserService userService; @Test void contextLoads() { userService.buyTicket(); } } è¿è¡Œä¹‹åå°±å¯ä»¥å‘ç°consumeré¡¹ç›®è°ƒç”¨providerçš„æœåŠ¡æˆåŠŸï¼\næœ€åŸºæœ¬çš„æœåŠ¡æ³¨å†Œå‘ç°ä¸rpcè°ƒç”¨å¤§æ¦‚æ˜¯demoè¿™æ ·ã€‚\nå‚è€ƒè‡ªï¼š bilibili\n","date":"2021-02-24T23:01:00+08:00","image":"https://ccqstark.github.io/p/dubbo_zookeeper/dubbo-zookeeper_huceb4a22a384e0271fe532efed4b00fee_48645_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/dubbo_zookeeper/","title":"Dubbo + ZooKeeper åŸºç¡€å…¥é—¨"},{"content":"éšç€äº’è”ç½‘çš„å‘å±•ï¼ŒWebåº”ç”¨ä¸æœåŠ¡çš„è§„æ¨¡ä¸æ–­æ‰©å¤§ï¼Œæ‰èƒ½æ»¡è¶³ä¸æ–­å¢åŠ çš„ç”¨æˆ·å’Œéœ€æ±‚ã€‚è€ŒåŸæ¥åªç”¨ä¸€å°æœåŠ¡å™¨æ¥éƒ¨ç½²çš„å•æœºåº”ç”¨çš„æ–¹å¼å·²ç»æ»¡è¶³ä¸äº†å¦‚æ­¤å¤§çš„éœ€æ±‚ã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå•æœºå‘å±•ä¸ºåˆ†å¸ƒå¼æ¶æ„ï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡å¢åŠ æœåŠ¡å™¨çš„æ•°é‡æ¥å¼¥è¡¥æ€§èƒ½ä¸Šçš„ä¸è¶³ï¼Œå½“ç„¶åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ã€‚\nåˆ†å¸ƒå¼ç³»ç»Ÿ åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆdistributed systemï¼‰æ˜¯ç”±ä¸€ç»„ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œä¸ºäº†å®Œæˆå…±åŒçš„ä»»åŠ¡è€Œåè°ƒå·¥ä½œçš„è®¡ç®—æœºèŠ‚ç‚¹ç»„æˆçš„ç³»ç»Ÿã€‚åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ä¸ºäº†ç”¨å•ä½“æ€§èƒ½æ™®é€šçš„æœºå™¨å®Œæˆå•ä¸ªè®¡ç®—æœºæ— æ³•å®Œæˆçš„è®¡ç®—ã€å­˜å‚¨ä»»åŠ¡ï¼Œé€šè¿‡åˆç†è°ƒåº¦å„å°è®¡ç®—æœºå…±åŒåˆä½œæ¥æé«˜æ€§èƒ½ï¼Œå®Œæˆæ•°é‡æ›´å¤šã€ä½“é‡æ›´å¤§çš„ä»»åŠ¡ã€‚\næ¯”å¦‚ç™¾åº¦æˆ–æ·˜å®è¿™æ ·ä½“é‡è§„æ¨¡éƒ½ååˆ†å¤§çš„åº”ç”¨ï¼Œä¸ºäº†æ»¡è¶³å¦‚æ­¤å¤§çš„ç”¨æˆ·æ•°é‡å’Œè¯·æ±‚å‹åŠ›ï¼ŒèƒŒåè‚¯å®šä¸æ­¢ä¸€å°è®¡ç®—æœºåœ¨æä¾›æœåŠ¡ï¼Œè€Œæ˜¯éƒ¨ç½²äº†è®¡ç®—æœºé›†ç¾¤ï¼Œé€šè¿‡æå‡è®¡ç®—æœºçš„æ•°é‡æ¥æé«˜å¤„ç†æ•°æ®çš„èƒ½åŠ›ã€‚åœ¨æµé‡é«˜å³°æ—¶ï¼Œå¤§é‡çš„è¯·æ±‚å¯ä»¥è¢«å‡åŒ€åœ°åˆ†é…ç»™å„å°æœåŠ¡å™¨å»å¤„ç†ï¼Œä»è€Œé¿å…å…¶ä¸­ä¸€å°æœåŠ¡å™¨ç”±äºå‹åŠ›è¿‡å¤§è€Œå®•æœºï¼Œè¿™å°±æ˜¯è´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå°±æ˜¯nginxå¯ä»¥åšçš„äº‹æƒ…ã€‚\nåŒæ—¶åº”ç”¨çš„å„ä¸ªæ¨¡å—ä¹Ÿå¯ä»¥åˆ†åˆ«éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œæ¯”å¦‚æ·˜å®è¿™æ ·çš„ç”µå•†é¡¹ç›®å¯ä»¥æŠŠæœåŠ¡æ‹†åˆ†æˆå•†å“ã€æ”¯ä»˜ã€è®¢å•ã€ç‰©æµç­‰ä¸åŒçš„æ¨¡å—ï¼Œä¸åŒæ¨¡å—å¯ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚å½“ä¸€ä¸ªæ¨¡å—éƒ¨ç½²åˆ°å¤šå°æœåŠ¡å™¨ä¸Šæ—¶ï¼Œå…¶ä¸­ä¸€å°å´©äº†ï¼Œè¿˜æœ‰å…¶ä»–çš„æœåŠ¡å™¨å¯ä»¥æä¾›æœåŠ¡ï¼Œæé«˜äº†æœåŠ¡çš„ç¨³å®šæ€§ä¸é«˜å¯ç”¨ã€‚\nè€Œå¯¹äºç”¨æˆ·æ¥è¯´ï¼Œä»–ä»¬éƒ½æ˜¯è®¿é—®ä¸€ä¸ªåŸŸåæ¥è·å–æœåŠ¡çš„ï¼Œæ‰€ä»¥å¯¹äºç”¨æˆ·æ¥è¯´æœåŠ¡è¿˜æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œè€Œä¸éœ€è¦çŸ¥é“æ˜¯å“ªå°æœåŠ¡å™¨ä¸ºä»–ä»¬æä¾›äº†æœåŠ¡ã€‚\nRPC ä¸‹å›¾æ˜¯Dubboå®˜æ–¹æ–‡æ¡£ä¸­çš„ä¸€å¼ å›¾ï¼Œè¯´æ˜äº†ç½‘ç«™åº”ç”¨çš„æ¶æ„æ¼”å˜\nåŸæ¥åº”ç”¨æ˜¯å•ä½“åº”ç”¨ï¼Œç¨‹åºå¦‚æœè¦è°ƒç”¨ä¸€ä¸ªå‡½æ•°æˆ–æ–¹æ³•å°±ç›´æ¥è°ƒç”¨å°±è¡Œäº†ï¼Œå› ä¸ºéƒ½æ˜¯åœ¨æœ¬åœ°ã€‚\nç°åœ¨åº”ç”¨é‡‡ç”¨åˆ†å¸ƒå¼æ¶æ„ï¼ŒæœåŠ¡è¢«åˆ†æ•£åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œä¸€å°æœåŠ¡å™¨ä¸Šçš„ç¨‹åºå°±ä¼šé‡åˆ°éœ€è¦è°ƒç”¨å¦ä¸€å°æœåŠ¡å™¨ä¸Šçš„æŸä¸ªæ–¹æ³•çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™å°±å«RPC(è¿œç¨‹è¿‡ç¨‹è°ƒç”¨)(Remote Procedure call)\nRPCçš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š\né€šè¿‡ç½‘ç»œå‘é€è°ƒç”¨æ¶ˆæ¯å°±éœ€è¦å…ˆåºåˆ—åŒ–ï¼Œåˆ°ç›®æ ‡æœåŠ¡å™¨åæˆåŠŸè°ƒç”¨å¯¹åº”çš„æœåŠ¡åè¿”å›ï¼Œååºåˆ—åŒ–å¾—åˆ°ç»“æœã€‚\nDubboå°±æ˜¯ä¸€ä¸ªæµè¡Œçš„RPCæ¡†æ¶ï¼Œæä¾›é¢å‘æ¥å£ä»£ç†çš„é«˜æ€§èƒ½RPCè°ƒç”¨ã€æ™ºèƒ½è´Ÿè½½å‡è¡¡ã€æœåŠ¡è‡ªåŠ¨æ³¨å†Œä¸å‘ç°ã€é«˜åº¦å¯æ‰©å±•èƒ½åŠ›ã€è¿è¡ŒæœŸæµé‡è°ƒåº¦ï¼ˆç°åº¦å‘å¸ƒï¼‰ã€å¯è§†åŒ–å·¥å…·ç­‰åŠŸèƒ½ã€‚\næµåŠ¨è®¡ç®—æ¶æ„ å½“æœåŠ¡å¢å¤šæ—¶ï¼ŒæœåŠ¡çš„ç®¡ç†ä¸èµ„æºçš„åˆ†é…æˆä¸ºäºŸå¾…è§£å†³çš„é—®é¢˜ï¼Œæ­¤æ—¶ï¼Œéœ€è¦å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤çš„åˆ©ç”¨ç‡ã€‚ç”¨äºæé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒ(SOA)(Service Oriented Architecture)å°±ååˆ†é‡è¦ã€‚\næœåŠ¡é€šè¿‡åœ¨æ³¨å†Œä¸­å¿ƒè¿›è¡Œæ³¨å†Œï¼Œè¢«ç»Ÿä¸€çš„ç®¡ç†èµ·æ¥å¹¶å¯è¢«å‘ç°ï¼Œå¹¶å¯¹ç”¨æˆ·å¼€æ”¾ã€‚å½“ç”¨æˆ·éœ€è¦ç”¨åˆ°æŸä¸€æœåŠ¡æ—¶ï¼Œå°±å»æ³¨å†Œä¸­å¿ƒæ‹¿ï¼Œæ³¨å†Œä¸­å¿ƒå°±ä¼šå°†å¯¹åº”çš„æœåŠ¡æä¾›ç»™ä»–ã€‚\næ³¨å†Œä¸­å¿ƒç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯Zookeeper\n","date":"2021-02-24T23:01:00+08:00","image":"https://ccqstark.github.io/p/distributed_rpc/dis-rpc_hueac48662f0ecf63cc9ad2fc947cb2254_27950_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/distributed_rpc/","title":"æµ…è°ˆåˆ†å¸ƒå¼ç³»ç»Ÿä¸RPC"},{"content":"å¯¼å…¥ä¾èµ– æˆ‘ä»¬ä½¿ç”¨springbootæ“ä½œesè¦ç”¨åˆ°å¯¹åº”çš„dataç›¸å…³starter\n\u0026lt;!-- elasticsearchçš„starterä¾èµ– --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-data-elasticsearch\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- å°†å¯¹è±¡è½¬ä¸ºjsonä¼ å…¥sourceæ—¶è¦ç”¨ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.75\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt;  âš ï¸ å„springbootçš„ç‰ˆæœ¬å¯¹åº”ç‰¹å®šçš„elasticsearchç‰ˆæœ¬ï¼Œå¼•å…¥ä¸Šé¢çš„ä¾èµ–æ—¶ä¼šè‡ªåŠ¨ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„rest-high-level-clientï¼Œä½¿ç”¨æ—¶å°½é‡ä½¿å¾—ç‰ˆæœ¬å¯¹åº”ï¼Œé¿å…æ½œåœ¨é—®é¢˜ã€‚\n ç‰ˆæœ¬å¯¹åº”è¡¨å¦‚ä¸‹ï¼š\næˆ‘ä½¿ç”¨çš„è¿™é‡Œç”¨Springboot2.4.1ï¼Œæ‰€ä»¥å¯¹åº”çš„elasticsearchæ˜¯7.9.3ç‰ˆæœ¬\né…ç½®ç±» configç›®å½•ä¸‹æ–°å»ºesçš„é…ç½®ç±»ElasticSearchClientConfig.java\n@Configuration public class ElasticSearchClientConfig { @Bean public RestHighLevelClient restHighLevelClient() { final CredentialsProvider credentialsProvider = new BasicCredentialsProvider(); credentialsProvider.setCredentials(AuthScope.ANY, new UsernamePasswordCredentials(\u0026#34;elastic\u0026#34;, \u0026#34;[å¯†ç ]\u0026#34;)); RestHighLevelClient client = new RestHighLevelClient( RestClient.builder( new HttpHost(\u0026#34;[ip]\u0026#34;, 9200, \u0026#34;http\u0026#34;)) .setHttpClientConfigCallback(httpClientBuilder -\u0026gt; { httpClientBuilder.disableAuthCaching(); return httpClientBuilder.setDefaultCredentialsProvider(credentialsProvider); })); return client; } } è¿™é‡Œæœ‰ç”¨åˆ°x-packåŸºç¡€å®‰å…¨åŠŸèƒ½ï¼Œæ‰€ä»¥é…ç½®äº†ç”¨æˆ·å’Œå¯†ç ã€‚å¦‚æœæ²¡æœ‰ç”¨æˆ·å’Œå¯†ç ï¼Œå‚ç…§å®˜æ–¹æ–‡æ¡£è¿æ¥ä»£ç å¦‚ä¸‹ï¼š\nRestHighLevelClient client = new RestHighLevelClient( RestClient.builder( new HttpHost(\u0026#34;localhost\u0026#34;, 9200, \u0026#34;http\u0026#34;), new HttpHost(\u0026#34;localhost\u0026#34;, 9201, \u0026#34;http\u0026#34;))); ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥ ä½¿ç”¨æ—¶@Autowiredä¸€ä¸‹ï¼Œç”¨è‡ªå®šä¹‰åå­—æ—¶å°±@Qualifierä¸€ä¸‹ï¼Œä¸ç„¶å°±å¾—å¯¹åº”ä¸Šé¢çš„æ–¹æ³•å\n@Autowired @Qualifier(\u0026#34;restHighLevelClient\u0026#34;) private RestHighLevelClient client; ç´¢å¼•ç›¸å…³æ“ä½œ åˆ›å»ºç´¢å¼• void testCreateIndex() throws IOException { // 1. åˆ›å»ºç´¢å¼•è¯·æ±‚  CreateIndexRequest request = new CreateIndexRequest(\u0026#34;test\u0026#34;); // 2. æ‰§è¡Œè¯·æ±‚  CreateIndexResponse createIndexResponse = client.indices().create(request, RequestOptions.DEFAULT); System.out.println(createIndexResponse); } åˆ¤æ–­ç´¢å¼•æ˜¯å¦å­˜åœ¨ void testExistIndex() throws IOException { GetIndexRequest request = new GetIndexRequest(\u0026#34;test2\u0026#34;); boolean exists = client.indices().exists(request, RequestOptions.DEFAULT); System.out.println(exists); } åˆ é™¤ç´¢å¼• void testDeleteIndex() throws IOException { DeleteIndexRequest request = new DeleteIndexRequest(\u0026#34;test\u0026#34;); AcknowledgedResponse delete = client.indices().delete(request, RequestOptions.DEFAULT); System.out.println(delete.isAcknowledged()); } æ–‡æ¡£ç›¸å…³æ“ä½œ æ·»åŠ æ–‡æ¡£ void testAddDocument() throws IOException { // åˆ›å»ºå¯¹è±¡  User user = new User(\u0026#34;ccqstark\u0026#34;, 20); // åˆ›å»ºè¯·æ±‚  IndexRequest request = new IndexRequest(\u0026#34;test\u0026#34;); // è§„åˆ™ put /test/_doc/1  request.id(\u0026#34;1\u0026#34;); // è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥ä¸å†™ï¼Œæœ‰é»˜è®¤å‚æ•°  request.timeout(TimeValue.timeValueSeconds(1)); request.timeout(\u0026#34;1s\u0026#34;); // å°†æ•°æ®æ”¾å…¥è¯·æ±‚  request.source(JSON.toJSONString(user), XContentType.JSON); // å®¢æˆ·ç«¯å‘é€è¯·æ±‚  IndexResponse indexResponse = client.index(request, RequestOptions.DEFAULT); System.out.println(indexResponse.toString()); System.out.println(indexResponse.status()); // å¯¹åº”è¿”å›çš„çŠ¶æ€ } æ‰¹é‡æ’å…¥æ–‡æ¡£ void testBulkRequest() throws IOException { BulkRequest bulkRequest = new BulkRequest(); // æ•°æ®é‡å¤šçš„è¯è¶…æ—¶æ—¶é—´å¯ä»¥è®¾ç½®é•¿ä¸€ç‚¹  bulkRequest.timeout(\u0026#34;10s\u0026#34;); List\u0026lt;User\u0026gt; userList = new ArrayList\u0026lt;\u0026gt;(); userList.add(new User(\u0026#34;ccq1\u0026#34;, 1)); userList.add(new User(\u0026#34;ccq2\u0026#34;, 2)); userList.add(new User(\u0026#34;ccq3\u0026#34;, 3)); userList.add(new User(\u0026#34;ccq4\u0026#34;, 4)); userList.add(new User(\u0026#34;ccq5\u0026#34;, 5)); // æ‰¹å¤„ç†è¯·æ±‚  for (int i = 0; i \u0026lt; userList.size(); i++) { bulkRequest.add( // æ‰¹é‡æ›´æ–°æˆ–æ‰¹é‡åˆ é™¤ï¼Œå°±åœ¨è¿™é‡Œä¿®æ”¹å¯¹åº”çš„è¯·æ±‚å³å¯. ä¸æŒ‡å®šidä¼šè‡ªåŠ¨ç”Ÿæˆéšæœºä¸é‡å¤id  new IndexRequest(\u0026#34;test\u0026#34;) .id(\u0026#34;\u0026#34; + (i + 1)) .source(JSON.toJSONString(userList.get(i)), XContentType.JSON)); } BulkResponse bulkResponse = client.bulk(bulkRequest, RequestOptions.DEFAULT); // æ˜¯å¦å¤±è´¥ï¼Œfalseä»£è¡¨æˆåŠŸ  System.out.println(bulkResponse.hasFailures()); } åˆ¤æ–­æ–‡æ¡£æ˜¯å¦å­˜åœ¨ void testIsExists() throws IOException { GetRequest getRequest = new GetRequest(\u0026#34;test\u0026#34;, \u0026#34;1\u0026#34;); // ä¸è·å–è¿”å›çš„_sourceä¸Šä¸‹æ–‡äº†  getRequest.fetchSourceContext(new FetchSourceContext(false)); // æ’åºçš„å­—æ®µ  getRequest.storedFields(\u0026#34;_none_\u0026#34;); boolean exist = client.exists(getRequest, RequestOptions.DEFAULT); System.out.println(exist); } è·å–æ–‡æ¡£ä¿¡æ¯ void testGetDocument() throws IOException { // index id  GetRequest getRequest = new GetRequest(\u0026#34;test\u0026#34;, \u0026#34;1\u0026#34;); GetResponse getResponse = client.get(getRequest, RequestOptions.DEFAULT); // è¿”å›çš„å…¨éƒ¨å†…å®¹ï¼Œå’Œç”¨å‘½ä»¤è·å–çš„ç»“æœä¸€æ ·  System.out.println(getResponse); // ä»¥mapè·å–ç»“æœçš„source  System.out.println(getResponse.getSourceAsMap()); // ä»¥stringè·å–ç»“æœsource  System.out.println(getResponse.getSourceAsString()); } æ›´æ–°æ–‡æ¡£ void testUpdateDocument() throws IOException { UpdateRequest updateRequest = new UpdateRequest(\u0026#34;test\u0026#34;, \u0026#34;1\u0026#34;); updateRequest.timeout(\u0026#34;1s\u0026#34;); User user = new User(\u0026#34;ccq java\u0026#34;, 18); updateRequest.doc(JSON.toJSONString(user), XContentType.JSON); UpdateResponse updateResponse = client.update(updateRequest, RequestOptions.DEFAULT); System.out.println(updateResponse.status()); } åˆ é™¤æ–‡æ¡£ void deleteDocument() throws IOException { DeleteRequest deleteRequest = new DeleteRequest(\u0026#34;test\u0026#34;, \u0026#34;3\u0026#34;); DeleteResponse deleteResponse = client.delete(deleteRequest, RequestOptions.DEFAULT); System.out.println(deleteResponse.status()); } é«˜çº§æŸ¥è¯¢ void testSearch() throws IOException { // SearchRequest æœç´¢è¯·æ±‚  // SearchSourceBuilder æœç´¢æ¡ä»¶æ„é€   SearchRequest searchRequest = new SearchRequest(\u0026#34;test\u0026#34;); SearchSourceBuilder sourceBuilder = new SearchSourceBuilder(); // ä¸åŒæŸ¥è¯¢æ–¹å¼éƒ½åœ¨è¿™é‡Œè®¾ç½®  // QueryBuilders.termQuery() ç²¾ç¡®æŸ¥è¯¢  // QueryBuilders.matchAllQuery() åŒ¹é…æ‰€æœ‰  TermQueryBuilder termQueryBuilder = QueryBuilders.termQuery(\u0026#34;name\u0026#34;, \u0026#34;ccq\u0026#34;); sourceBuilder.query(termQueryBuilder); sourceBuilder.timeout(new TimeValue(60, TimeUnit.SECONDS)); // åˆ†é¡µ  sourceBuilder.from(0); sourceBuilder.size(10); // é«˜äº®  HighlightBuilder highlightBuilder = new HighlightBuilder(); // è®¾ç½®é«˜äº®çš„å­—æ®µ  highlightBuilder.field(\u0026#34;name\u0026#34;); // å¤šä¸ªåŒ¹é…å­—é«˜äº®  highlightBuilder.requireFieldMatch(true); // è®¾ç½®é«˜äº®æ ‡ç­¾  highlightBuilder.preTags(\u0026#34;\u0026lt;span style=\\\u0026#34;color:#ffd73b\\\u0026#34;\u0026gt;\u0026#34;); highlightBuilder.postTags(\u0026#34;\u0026lt;/span\u0026gt;\u0026#34;); sourceBuilder.highlighter(highlightBuilder); // æ‰§è¡Œæœç´¢  searchRequest.source(sourceBuilder); SearchResponse searchResponse = client.search(searchRequest, RequestOptions.DEFAULT); System.out.println(JSON.toJSONString(searchResponse.getHits())); System.out.println(\u0026#34;=========================================\u0026#34;); for (SearchHit hit : searchResponse.getHits()) { // è·å–é«˜äº®å­—æ®µ  Map\u0026lt;String, HighlightField\u0026gt; highlightFields = hit.getHighlightFields(); HighlightField highlightName = highlightFields.get(\u0026#34;name\u0026#34;); // åŸæ¥çš„ç»“æœ  Map\u0026lt;String, Object\u0026gt; sourceAsMap = hit.getSourceAsMap(); // ç”¨é«˜äº®æ›¿æ¢åŸæ¥çš„ï¼Œè¿™é‡Œè¦åˆ¤æ–­ä¸€ä¸ªæ˜¯å¦ä¸ºç©ºï¼Œå› ä¸ºæœ‰å¯èƒ½æ²¡æœ‰é«˜äº®ç»“æœ  if (highlightName != null) { Text[] fragments = highlightName.fragments(); // åªæœ‰å½“è¦é«˜äº®æœç´¢å½“å­—æ®µæ˜¯æ•°ç»„ç±»å‹fragmentsæ‰ä¼šæœ‰å¤šä¸ªå…ƒç´ ï¼Œå¦‚æœæ˜¯å•å­—æ®µå°±å»ç¬¬0ä¸ªå°±è¡Œ  sourceAsMap.put(\u0026#34;name\u0026#34;, fragments[0]); } System.out.println(sourceAsMap); } } å‚è€ƒè‡ªç‹‚ç¥çš„ElasticSearchæ•™ç¨‹ï¼š ã€ç‹‚ç¥è¯´Javaã€‘ElasticSearch7.6.xæœ€æ–°å®Œæ•´æ•™ç¨‹é€šä¿—æ˜“æ‡‚\n","date":"2021-02-04T23:01:00+08:00","image":"https://ccqstark.github.io/p/springboot_es/springboot-es_hu5dbd9828aef42d61c56fd952a73b2be9_64126_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/springboot_es/","title":"[SpringBoot]æ•´åˆElasticSearch"},{"content":"åŸºæœ¬çš„restå‘½ä»¤    method url åŠŸèƒ½     PUT localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id åˆ›å»ºæ–‡æ¡£ï¼ˆæŒ‡å®šæ–‡æ¡£id)   POST localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§° åˆ›å»ºæ–‡æ¡£ï¼ˆéšæœºæ–‡æ¡£idï¼‰   POST localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id/_update ä¿®æ”¹æ–‡æ¡£   DELETE localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id åˆ é™¤æ–‡æ¡£   GET localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id æŸ¥è¯¢æ–‡æ¡£ï¼Œé€šè¿‡æ–‡æ¡£id   POST localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/_search æŸ¥è¯¢æ‰€æœ‰æ•°æ®     âš ï¸ è‡ªå®šä¹‰ç±»å‹å°†åœ¨ä»¥åçš„ç‰ˆæœ¬ä¸­å¼ƒç”¨ï¼Œè§„èŒƒèµ·è§ä¸€å¾‹ä½¿ç”¨_doc ç±»å‹\n æ–‡æ¡£å­—æ®µçš„æ•°æ®ç±»å‹   å­—ç¬¦ä¸²ç±»å‹\ntext keyword\n  æ•°å€¼ç±»å‹\nlong integer short byte double float half float scaled float\n  æ—¥æœŸç±»å‹\ndate\n  å¸ƒå°”ç±»å‹\nboolean\n  äºŒè¿›åˆ¶ç±»å‹\nbinary\nç­‰ç­‰\u0026hellip;..\n  åŸºæœ¬æ“ä½œ  åˆ›å»ºä¸€ä¸ªæ–‡æ¡£ï¼Œå¦‚æœç´¢å¼•ä¸å­˜åœ¨ä¹Ÿä¼šä¸€èµ·åˆ›å»º  PUT /test/_doc/1 { \u0026#34;name\u0026#34;:\u0026#34;ccqstark\u0026#34;, \u0026#34;age\u0026#34;:3 } æ²¡æœ‰æŒ‡å®šå­—æ®µçš„æ•°æ®ç±»å‹ï¼Œesä¼šé»˜è®¤é…ç½®\n æŒ‡å®šå­—æ®µæ•°æ®ç±»å‹åˆ›å»ºç´¢å¼•  PUT /test2 { \u0026#34;mappings\u0026#34;: { \u0026#34;properties\u0026#34;: { \u0026#34;name\u0026#34;:{ \u0026#34;type\u0026#34;: \u0026#34;text\u0026#34; }, \u0026#34;age\u0026#34;:{ \u0026#34;type\u0026#34;: \u0026#34;long\u0026#34; }, \u0026#34;birthday\u0026#34;:{ \u0026#34;type\u0026#34;: \u0026#34;date\u0026#34; } } } }  åŸºæœ¬æŸ¥è¯¢  # æŸ¥è¯¢ç´¢å¼•åº“ä¿¡æ¯ GET /{index} # æŸ¥è¯¢å…·ä½“æŸä¸€æ–‡æ¡£ GET /{index}/_doc/{id}  æŸ¥è¯¢eså‚æ•°  GET _cat/[å‚æ•°é¡¹]  PUTæ›´æ–°  PUT /{index}/_doc/{id} { \u0026#34;name\u0026#34;:\u0026#34;ccqstark666\u0026#34;, \u0026#34;age\u0026#34;:3 } ç›´æ¥åœ¨å¯¹åº”å­—æ®µå†™ä¸Šæ›´æ–°åçš„ä¿¡æ¯ï¼Œä¼šè¦†ç›–æ—§çš„å€¼\nå¦‚æœæ¼äº†åŸæ¥æœ‰çš„å­—æ®µï¼Œé‚£ä¹ˆè¿™äº›å­—æ®µä¼šè¢«åˆ é™¤ï¼Œæ‰€ä»¥ä¸æ¨èä½¿ç”¨\n POSTæ›´æ–°**ï¼ˆæ¨èï¼‰**  POST **/{index}/_update/{id}** { \u0026#34;doc\u0026#34;:{ \u0026#34;name\u0026#34;:\u0026#34;ccqstark555\u0026#34; } } è¢«ä¿®æ”¹çš„æ–‡æ¡£çš„\u0026quot;_version\u0026quot;ä¼šé€’å¢1\n åˆ é™¤  # åˆ é™¤ç´¢å¼•åº“ DELETE /{index} # åˆ é™¤æ–‡æ¡£ DELETE /{index}/_doc/{id}  ç®€å•æ¡ä»¶æŸ¥è¯¢  GET /test/_doc/_search?q=name:ccqstark  âš ï¸ å¦‚æœå­—æ®µç±»å‹æ˜¯keyword ï¼Œè¯´æ˜ä¸å¯åˆ†å‰²ï¼ŒæŸ¥è¯¢çš„æ—¶å€™åˆ†è¯å™¨ä¸ä¼šåˆ†å‰²è¿™ä¸ªè¯æ¥æœç´¢ï¼Œè€Œæ˜¯å½“æˆä¸€ä¸ªæ•´ä½“ï¼Œè€Œtext ç±»å‹å¯ä»¥è¢«åˆ†è¯å™¨è§£æ\n  ğŸ˜® æŸ¥è¯¢å‡ºæ¥çš„\u0026quot;hits\u0026quot;é‡Œæœ‰\u0026quot;_score\u0026quot;æ˜¯è¯´æ˜åŒ¹é…åº¦çš„åˆ†æ•°å€¼ï¼ŒåŒ¹é…åº¦è¶Šé«˜ï¼Œåˆ†æ•°è¶Šé«˜\n å¤æ‚(èŠ±å¼)æœç´¢  match æŸ¥è¯¢  GET /test/_doc/_search { \u0026#34;query\u0026#34;:{ \u0026#34;match\u0026#34;:{ \u0026#34;name\u0026#34;:\u0026#34;ccqstark\u0026#34; } } } matchä¸æ˜¯ç²¾ç¡®æœç´¢ï¼Œä¼šä½¿ç”¨åˆ†è¯å™¨è§£æå†æœç´¢ï¼ˆé»˜è®¤è‡ªå¸¦åˆ†è¯å™¨æŠŠè‹±æ–‡æŒ‰ç©ºæ ¼åˆ†è¯ï¼Œä¸­æ–‡æ˜¯æ¯ä¸€ä¸ªå­—éƒ½åˆ†å¼€ï¼‰\nä½¿ç”¨jsonæ„å»ºæŸ¥è¯¢å‚æ•°ä½“\n\u0026#34;hits\u0026#34; : { \u0026#34;total\u0026#34; : { \u0026#34;value\u0026#34; : 3, \u0026#34;relation\u0026#34; : \u0026#34;eq\u0026#34; } æŸ¥è¯¢ç»“æœä¸­çš„ hitsé‡Œæœ‰ä¸ªtotalçš„valueï¼Œä¸ºæŸ¥è¯¢ç»“æœçš„æ€»æ•°é‡\n è¿‡æ»¤æŸ¥è¯¢ç»“æœçš„å­—æ®µ  GET /test/_doc/_search { \u0026#34;query\u0026#34;:{ \u0026#34;match\u0026#34;:{ \u0026#34;name\u0026#34;:\u0026#34;ccqstark\u0026#34; } }, \u0026#34;_source\u0026#34;:[\u0026#34;name\u0026#34;,\u0026#34;age\u0026#34;] } \u0026quot;_source\u0026quot; å¯ä»¥ç”¨æ¥æŒ‡å®šæŸ¥è¯¢ç»“æœä¸­çš„å­—æ®µï¼Œç›¸å½“äºselect xxx,xxx\n ç»“æœæ’åº  GET /test/_doc/_search { \u0026#34;query\u0026#34;:{ \u0026#34;match\u0026#34;:{ \u0026#34;name\u0026#34;:\u0026#34;ccqstark\u0026#34; } }, \u0026#34;sort\u0026#34;:{ \u0026#34;age\u0026#34;:{ \u0026#34;order\u0026#34;:\u0026#34;desc\u0026#34; } } } è¿™é‡Œ \u0026quot;sort\u0026quot; æŒ‡å®šageä¸ºç”¨æ¥æ’åºçš„å­—æ®µï¼Œ\u0026quot;order\u0026quot; ä¸ºæ’åºæ–¹å¼\nå‡åºï¼šasc\né™åºï¼šdesc\n åˆ†é¡µæŸ¥è¯¢  GET /test/_doc/_search { \u0026#34;query\u0026#34;:{ \u0026#34;match\u0026#34;:{ \u0026#34;name\u0026#34;:\u0026#34;ccqstark\u0026#34; } }, \u0026#34;from\u0026#34;:0, \u0026#34;size\u0026#34;:2 } â€œfromâ€æ˜¯ä»ç¬¬å‡ é¡µå¼€å§‹ï¼Œç¬¬ä¸€é¡µä¸º0\nâ€œsizeâ€æ˜¯æ¯é¡µå¤šå°‘æ¡æ•°æ®\n boolæŸ¥è¯¢  GET /test/_doc/_search { \u0026#34;query\u0026#34;: { \u0026#34;bool\u0026#34;: { \u0026#34;must\u0026#34;: [ { \u0026#34;match\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;ccqstark\u0026#34; } }, { \u0026#34;match\u0026#34;: { \u0026#34;age\u0026#34;: 100 } } ] } } } ç”¨boolå¯ä»¥å®ç°å¤šæ¡ä»¶æŸ¥è¯¢\nè¿™é‡Œçš„mustç›¸å½“äºandï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰æ¡ä»¶éƒ½è¦ç¬¦åˆ\nä¹Ÿå¯ä»¥ç”¨should ï¼Œç›¸å½“äºor\nè¿˜æœ‰must_not ï¼Œç›¸å½“äºnot\n boolåµŒå¥—  GET /my_store/products/_search { \u0026#34;query\u0026#34; : { \u0026#34;filtered\u0026#34; : { \u0026#34;filter\u0026#34; : { \u0026#34;bool\u0026#34; : { \u0026#34;should\u0026#34; : [ { \u0026#34;term\u0026#34; : {\u0026#34;productID\u0026#34; : \u0026#34;KDKE-B-9947-#kL5\u0026#34;}}, { \u0026#34;bool\u0026#34; : { \u0026#34;must\u0026#34; : [ { \u0026#34;term\u0026#34; : {\u0026#34;productID\u0026#34; : \u0026#34;JODL-X-1937-#pV7\u0026#34;}}, { \u0026#34;term\u0026#34; : {\u0026#34;price\u0026#34; : 30}} ] }} ] } } } } } boolæŸ¥è¯¢é‡Œå†å¥—ä¸€ä¸ªboolï¼Œå°±ç›¸å½“äºåŠ äº†ä¸ªæ‹¬å·ï¼š( A or ( B and C ))\n filter æŸ¥è¯¢  GET /test/_doc/_search { \u0026#34;query\u0026#34;: { \u0026#34;bool\u0026#34;: { \u0026#34;must_not\u0026#34;: [ { \u0026#34;match\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;é™ˆæ¥šæƒ\u0026#34; } } ], \u0026#34;filter\u0026#34;: { \u0026#34;range\u0026#34;: { \u0026#34;age\u0026#34;: { \u0026#34;gte\u0026#34;: 66, \u0026#34;lte\u0026#34;: 100 } } } } } } range è¡¨ç¤ºèŒƒå›´æŸ¥è¯¢ï¼Œage æŒ‡å®šäº†å­—æ®µ\nèŒƒå›´æŸ¥è¯¢è¡¨è¾¾å¼\n   è¡¨è¾¾å¼ è¡¨ç¤º     gt \u0026gt;   gte \u0026gt;=   lt \u0026lt;   lte \u0026lt;=     å¤šå…³é”®è¯æŸ¥è¯¢  GET /test/_doc/_search { \u0026#34;query\u0026#34;: { \u0026#34;bool\u0026#34;: { \u0026#34;must\u0026#34;: [ { \u0026#34;match\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;ccq java\u0026#34; } } ] } } } ç”¨ç©ºæ ¼éš”å¼€å…³é”®è¯å°±è¡Œ\n termç²¾ç¡®æŸ¥è¯¢  GET /test3/_doc/_search { \u0026#34;query\u0026#34;: { \u0026#34;bool\u0026#34;: { \u0026#34;should\u0026#34;: [ { \u0026#34;term\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;ccqè¯´java\u0026#34; } } ] } } }  âš ï¸ ä½¿ç”¨termæŸ¥è¯¢è¦æ±‚å­—æ®µä¸ºkeywordç±»å‹æ‰èƒ½åŒ¹é…å‡ºæ¥\n termæ˜¯ç²¾ç¡®æŸ¥è¯¢ï¼Œäºmatchä¼šç”¨åˆ†è¯å™¨è§£æä¸åŒï¼Œtermæ˜¯ç›´æ¥é€šè¿‡å€’æ’ç´¢å¼•æŒ‡å®šçš„è¯æ¡è¿›è¡Œç²¾ç¡®æŸ¥æ‰¾\n é«˜äº®æŸ¥è¯¢  GET /test/_doc/_search { \u0026#34;query\u0026#34;: { \u0026#34;match\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;java\u0026#34; } }, \u0026#34;highlight\u0026#34;: { \u0026#34;fields\u0026#34;: { \u0026#34;name\u0026#34;: {} } } } è¿”å›å€¼ä¸­çš„highlightå­—æ®µé‡Œä¼šæœ‰å¸¦é«˜äº®æ ‡ç­¾çš„æœç´¢ç»“æœï¼Œé»˜è®¤æ ‡ç­¾ä¸º\u0026lt;em\u0026gt;ï¼Œæ•ˆæœå¦‚ä¸‹\n{ \u0026#34;_index\u0026#34; : \u0026#34;test\u0026#34;, \u0026#34;_type\u0026#34; : \u0026#34;_doc\u0026#34;, \u0026#34;_id\u0026#34; : \u0026#34;6\u0026#34;, \u0026#34;_score\u0026#34; : 1.1631508, \u0026#34;_source\u0026#34; : { \u0026#34;name\u0026#34; : \u0026#34;ccqè¯´java\u0026#34;, \u0026#34;age\u0026#34; : 100 }, \u0026#34;highlight\u0026#34; : { \u0026#34;name\u0026#34; : [ \u0026#34;ccqè¯´\u0026lt;em\u0026gt;java\u0026lt;/em\u0026gt;\u0026#34; ] } } é«˜äº®æ ‡ç­¾å¯ä»¥è‡ªå®šä¹‰ï¼Œç”¨å‰æ ‡ç­¾pre_tagså’Œåæ ‡ç­¾post_tags æ¥æŒ‡å®š\nGET /test/_doc/_search { \u0026#34;query\u0026#34;: { \u0026#34;match\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;java\u0026#34; } }, \u0026#34;highlight\u0026#34;: { \u0026#34;pre_tags\u0026#34;: \u0026#34;\u0026lt;p class=\u0026#39;key\u0026#39; style=\u0026#39;color:red\u0026#39;\u0026gt;\u0026#34;, \u0026#34;post_tags\u0026#34;: \u0026#34;\u0026lt;/p\u0026gt;\u0026#34;, \u0026#34;fields\u0026#34;: { \u0026#34;name\u0026#34;: {} } } } å‚è€ƒè‡ªç‹‚ç¥çš„ElasticSearchæ•™ç¨‹ï¼š ã€ç‹‚ç¥è¯´Javaã€‘ElasticSearch7.6.xæœ€æ–°å®Œæ•´æ•™ç¨‹é€šä¿—æ˜“æ‡‚\n","date":"2021-02-03T23:01:00+08:00","image":"https://ccqstark.github.io/p/es_rest/restful_hud0b30a641456616a14ef2ef618957a76_22844_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/es_rest/","title":"[ElasticSearch]RESTé£æ ¼æ“ä½œ"},{"content":"ç”±äºè¿™å‡ å¤©å¼€å§‹çœ‹ã€ŠCS:APPã€‹ï¼Œæˆ‘å°±å¼€å§‹å¯»æ±‚ä¸€æ¬¾Macä¸Šçš„è½»é‡çš„Cè¯­è¨€ç¼–è¾‘å™¨ã€‚æ‰¾æ¥æ‰¾å»ï¼Œæ— éæ˜¯VSCodeã€CLionå’Œå¤§åé¼é¼çš„Vimã€‚\nä¸ºäº†å‡å°‘ç£ç›˜å ç”¨åŒæ—¶è®©è‡ªå·±æ›´æ¥è¿‘äºåº•å±‚ï¼Œæˆ‘è¿˜æ˜¯ç¡¬ç€å¤´çš®æŠ˜è…¾èµ·äº†Vimï¼Œè¿™ä¸ªä¸Šå¤ç¥å™¨ä¹‹å‰å°±ä¸€ç›´è®©æˆ‘æœ›è€Œå´æ­¥ï¼Œæˆ‘å¯¹å®ƒçš„æŒæ¡ç¨‹åº¦ä¹Ÿå·®ä¸å¤šæ˜¯ä¼šé€€å‡ºçš„ç¨‹åº¦ï¼Œè¿™ä¸€æ¬¡å°±æ‰“ç®—å¥½å¥½æ¥æŠ˜è…¾ä¸‹ã€‚\nå®‰è£…NeoVim Vimå…¶å®åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸åŒçš„åˆ†æ”¯ç‰ˆæœ¬è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œæ¯”è¾ƒæµè¡Œçš„ç°ä»£ç‰ˆæœ¬å°±è¦å±NeoVimäº†ï¼Œæ‰€ä»¥æˆ‘åœ¨ç»ˆç«¯å®‰è£…äº†å®ƒï¼Œç”¨iTerm2è¿è¡Œç€ã€‚\nbrew install neovim å®‰è£…å®Œæˆåç”¨nvimå‘½ä»¤å°±å¯ä»¥æ‰“å¼€\nnvim é…ç½®æ–‡ä»¶è·¯å¾„\nä¼ ç»Ÿçš„vimçš„é…ç½®é…ç½®æ–‡ä»¶ä¸º~/.vimrc\nè€Œnvimçš„é…ç½®æ–‡ä»¶ä¸º/.config/nvim/init.vim ï¼Œä¹‹åä¿®æ”¹nvimé…ç½®æ–‡ä»¶å°±ç”¨è¿™ä¸ªï¼Œä»¥ä¸‹ç®€ç§°ä¸ºinit.vim\nå®‰è£…SpaceVim ä½œä¸ºå°ç™½ï¼Œå¿«é€Ÿæ­å»ºä¸€ä¸ªå¥½çœ‹å®ç”¨çš„Vimå¼€å‘ç¯å¢ƒé‚£æœ€å¥½çš„é€‰æ‹©å°±æ˜¯SpaceVim äº†ï¼Œä¸‹é¢æ˜¯å®˜æ–¹çš„ä»‹ç»ï¼š\n SpaceVim æ˜¯ä¸€ä¸ªç¤¾åŒºé©±åŠ¨çš„æ¨¡å—åŒ–çš„ Vim IDEï¼Œä»¥æ¨¡å—çš„æ–¹å¼ç»„ç»‡ç®¡ç†æ’ä»¶ä»¥åŠç›¸å…³é…ç½®ï¼Œ ä¸ºä¸åŒçš„è¯­è¨€å¼€å‘é‡èº«å®šåˆ¶äº†ç›¸å…³çš„å¼€å‘æ¨¡å—ï¼Œè¯¥æ¨¡å—æä¾›ä»£ç è‡ªåŠ¨è¡¥å…¨ï¼Œ è¯­æ³•æ£€æŸ¥ã€æ ¼å¼åŒ–ã€è°ƒè¯•ã€REPL ç­‰ç‰¹æ€§ã€‚ç”¨æˆ·ä»…éœ€è½½å…¥ç›¸å…³è¯­è¨€çš„æ¨¡å—å³å¯å¾—åˆ°ä¸€ä¸ªå¼€ç®±å³ç”¨çš„ Vim IDEã€‚\n å®˜ç½‘åœ°å€ï¼š\nä¸»é¡µ | SpaceVim\nå®˜ç½‘çš„æ–‡æ¡£è¿˜æ˜¯å¾ˆå…¨çš„ï¼ŒæŒ‰å®˜æ–¹æ–‡æ¡£å°±å¯ä»¥å¿«é€Ÿæ­å»ºå‡ºæ¥äº†ã€‚ä»¥MacOSä¸ºä¾‹ï¼š\nå®‰è£…spacevim\ncurl -sLf https://spacevim.org/cn/install.sh | bash å®Œæˆåé‡æ–°æ‰“å¼€nvimå°±ä¼šè‡ªåŠ¨ä¸‹è½½ç›¸å…³æ’ä»¶ã€‚\nç„¶åå°±æ˜¯ä¸»ç•Œé¢ï¼š\nä¸»é¢˜çš„ä¿®æ”¹å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£\nSpaceVim colorscheme æ¨¡å— | SpaceVim\nå¿«æ·é”®ç¬¦å·è¯´æ˜\nSPC ä»£è¡¨ç©ºæ ¼\n\u0026lt;Leader\u0026gt; é»˜è®¤ä¸º\\\nä»¥ä¸‹ä¸€äº›åŠŸèƒ½éœ€è¦å¯¹macè¿›è¡Œä¸€å®šçš„è®¾ç½®æ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚\næ‰“å¼€ç³»ç»Ÿåå¥½è®¾ç½® â†’ é”®ç›˜\nå‹¾é€‰å°†F1ã€F2ç­‰é”®ç”¨ä½œæ ‡å‡†åŠŸèƒ½é”®\nè¿™åŒæ—¶ä¹Ÿè§£å†³äº†Chromeçš„F12 ä¸èƒ½æ‰“å¼€æ§åˆ¶å°çš„é—®é¢˜\næ–‡ä»¶ç›®å½•æ ‘\næŒ‰F3 å¯ä»¥æ‰“å¼€æˆ–å…³é—­\nè¯­æ³•å‡½æ•°æ ‘\næŒ‰F2å¯ä»¥æ‰“å¼€æˆ–å…³é—­\nmacä¸‹å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼Œè§£å†³æ–¹æ¡ˆï¼š\nbrew install ctags-exuberant ç„¶åinit.vimé‡Œæ·»åŠ ä¸‹é¢è¿™è¡Œå³å¯\nlet g:Tlist_Ctags_Cmd=\u0026#39;/usr/local/Cellar/ctags/5.8_1/bin/ctags\u0026#39; shellç»ˆç«¯\nSPC ' å³å¯æ‰“å¼€ç³»ç»Ÿshellï¼Œå¦‚æœç”¨äº†oh-my-zshä¸»é¢˜ä»€ä¹ˆçš„ä¹Ÿä¼šä¿ç•™çš„\né…ç½®C/C++ç¯å¢ƒ spacevimå¯¹å¤§éƒ¨åˆ†è¯­è¨€éƒ½æœ‰ç›¸å…³æ”¯æŒï¼Œæ–‡æ¡£ä¹Ÿé½å…¨ï¼Œæ¯”å¦‚æˆ‘éœ€è¦çš„Cè¯­è¨€ç¯å¢ƒï¼š\nä½¿ç”¨ Vim æ­å»º C/C++ å¼€å‘ç¯å¢ƒ | SpaceVim\næŒ‰ç…§å®˜æ–¹æ–‡æ¡£ä¿®æ”¹spacevimçš„é…ç½®æ–‡ä»¶~/.SpaceVim.d/init.toml å³å¯ï¼Œä»¥ä¸‹ç®€ç§°init.toml\nå¯¹äºè‡ªå¸¦çš„æ¨¡å—åŸºæœ¬åªéœ€è¦æ·»åŠ [[layers]]\n# è¯­æ³•é«˜äº® [[layers]] name = \u0026#39;lang#c\u0026#39; enable_clang_syntax_highlight = true # ä»£ç æ ¼å¼åŒ– [[layers]] name = \u0026#34;format\u0026#34; # è¯­æ³•æ£€æŸ¥ [[layers]] name = \u0026#34;checkers\u0026#34; spacevimå†…ç½®çš„æ¨¡å—è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œä½†æ˜¯å¾ˆå¤šåŠŸèƒ½ç›¸å¯¹ç®€é™‹ï¼Œä¸ºäº†å®ç°æ›´å¥½çš„æ•ˆæœï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£…å…¶ä»–çš„æ’ä»¶ã€‚\nå®‰è£…æ’ä»¶ç®¡ç†å™¨vim-plug è™½ç„¶SpaceVimå·²ç»è‡ªå¸¦æ’ä»¶ç®¡ç†å·¥å…·ï¼Œåœ¨init.toml é‡Œæ·»åŠ \n[[custom_plugins]] repo = \u0026#34;æ’ä»¶çš„githubåœ°å€\u0026#34; é‡å¯åå³å¯è‡ªåŠ¨ä¸‹è½½\nç”¨spacevimç®¡ç†çš„è¿™äº›ä»githubä¸Šä¸‹è½½çš„æ’ä»¶å­˜å‚¨åœ¨~/.cache/vimfiles/repos/github.com/\nè¿™ä¸ªè‡ªå¸¦çš„æ’ä»¶ç®¡ç†å™¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿˜å¯ä»¥ï¼Œä½†æ˜¯æœ‰æ—¶ä¸å¤ªå¥½ä½¿ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©å¤šä¸‹è½½ä¸€ä¸ªvimçš„ä¸»æµæ’ä»¶ç®¡ç†å™¨vim-plug\nä½¿ç”¨curlå®‰è£…ï¼Œä¸‹é¢ä¸€æ¡å‘½ä»¤å°±å¤Ÿ\ncurl -fLo ~/.vim/autoload/plug.vim --create-dirs \\  https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim å¦‚æœé‡åˆ°äº†Connection refusedçš„é”™è¯¯ï¼Œä½¿ç”¨SwitchHosts! ï¼Œæ·»åŠ ä»¥ä¸‹çš„hostï¼š\n199.232.68.133 raw.githubusercontent.com 199.232.68.133 user-images.githubusercontent.com 199.232.68.133 avatars2.githubusercontent.com 199.232.68.133 avatars1.githubusercontent.com ä½¿ç”¨æ’ä»¶ç®¡ç†å™¨å®‰è£…æ–°çš„æ’ä»¶çš„æ–¹æ³•æ˜¯ï¼Œåœ¨init.vim é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ï¼š\ncall plug#begin() call plug#end() ç„¶åæŠŠè¦å®‰è£…çš„æ’ä»¶æ·»åŠ åˆ°è¿™ä¸¤è¡Œä»£ç ä¸­é—´ï¼Œä»¥Plug 'xxx/xxx' çš„æ ¼å¼ï¼Œå¦‚ï¼š\ncall plug#begin() Plug \u0026#39;junegunn/vim-easy-align\u0026#39; call plug#end() ä¹‹åé‡å¯nvimï¼Œä½¿ç”¨å‘½ä»¤:PlugInstall å°±å¯ä»¥å®‰è£…äº†ã€‚\nè‹¥è¦å¸è½½æ’ä»¶ï¼Œå°±ä»é…ç½®æ–‡ä»¶ä¸­å»é™¤ç›¸åº”çš„é‚£ä¸€è¡Œï¼Œç„¶åä½¿ç”¨å‘½ä»¤:PlugClean å°±å¯ä»¥å¸è½½äº†ã€‚\nå®‰è£…Coc.nvim SpaceVimè‡ªå¸¦çš„è¡¥å…¨è¿˜è¡Œï¼Œä½†æ˜¯ä¸ºäº†è¾¾åˆ°æ•ˆæœæ›´å¥½çš„è¡¥å…¨å’Œè¯­æ³•æ£€æŸ¥ï¼Œæˆ‘é€‰æ‹©å®‰è£…æ’ä»¶coc.nvim\nneoclide/coc.nvim\nè¿™å¯ä»¥è¯´æ˜¯ç¥å™¨äº†ï¼Œé™¤äº†åŸºæœ¬çš„è¡¥å…¨ä¹‹å¤–ï¼Œè¿˜æä¾›äº†ä¼—å¤šæ‰©å±•æ¥æ”¯æŒä¸åŒçš„è¯­è¨€å’Œä¸åŒçš„ç‰¹æ€§ã€‚\nç”¨ä¹‹å‰ä¸‹çš„vim-plug æ¥å®‰è£…\nPlug \u0026#39;neoclide/coc.nvim\u0026#39;, {\u0026#39;branch\u0026#39;: \u0026#39;release\u0026#39;} å®‰è£…å®Œåå¯ä»¥å…ˆç›´æ¥æŠŠå®˜æ–¹çš„ç¤ºä¾‹é…ç½®æ–‡ä»¶ç²˜è´´è¿›init.vimï¼Œç¤ºä¾‹é…ç½®æ–‡ä»¶åœ¨githubçš„readmeé‡Œæœ‰ã€‚\nä¸ºäº†Cè¯­è¨€æ›´å¥½çš„è¡¥å…¨æ”¯æŒï¼Œæˆ‘ä¸‹è½½ç›¸å…³çš„cocæ‰©å±•â€”â€”coc-clangd\nneoclide/coc.nvim\né¦–å…ˆä¿è¯æœ‰nodeç¯å¢ƒï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…coc-clangd\n:CocInstall coc-clangd å®Œæˆåæ‰“å¼€ä¸€ä¸ªcè¯­è¨€æ–‡ä»¶ï¼Œè‹¥æç¤ºæ‰¾ä¸åˆ°clangdï¼Œåˆ™è‡ªå·±æ‰‹åŠ¨ä¸‹è½½ã€‚\nè¿›å…¥github releaseé¡µé¢ä¸‹è½½clangd-mac-11.0.0.zip\nRelease 11.0.0 Â· clangd/clangd\nè§£å‹åç›®å½•ä¸‹æœ‰ä¸€ä¸ªbinæ–‡ä»¶å¤¹å’Œä¸€ä¸ªlibæ–‡ä»¶å¤¹\nå°†binä¸‹çš„clangdæ–‡ä»¶ç§»åŠ¨è‡³/usr/local/bin/ç›®å½•ä¸‹\nå°†libç›®å½•ä¸‹çš„clangæ–‡ä»¶å¤¹ç§»åŠ¨è‡³~/Library/ç›®å½•ä¸‹\nå†æ¬¡æ‰“å¼€å³å¯æ­£å¸¸ä½¿ç”¨ï¼Œæ³¨æ„æŠŠspacevimè‡ªå¸¦çš„è¡¥å…¨ç»™ç¦ç”¨\n[[layers]] name = \u0026#39;autocomplete\u0026#39; enable = false æ•ˆæœå¦‚ä¸‹ï¼š\nå¯ä»¥çœ‹åˆ°ä»£ç æç¤ºæ•ˆæœæ˜¯éå¸¸å¥½çš„\nå½“ç„¶ï¼Œé‡Œé¢è¿˜æœ‰å¾ˆå¤šå¾ˆå®ç”¨çš„æ‰©å±•ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦ä¸‹\næ‹¬å·å¼•å·è‡ªåŠ¨è¡¥å…¨ coc.nvimæ’ä»¶å¯¹äºæ‹¬å·å’Œå¼•å·è¿˜æ˜¯æ²¡æœ‰è‡ªåŠ¨è¡¥æˆä¸€å¯¹çš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨init.vimé‡Œæ·»åŠ \ninoremap ( ()\u0026lt;Esc\u0026gt;i inoremap [ []\u0026lt;Esc\u0026gt;i inoremap { {\u0026lt;CR\u0026gt;}\u0026lt;Esc\u0026gt;O autocmd Syntax html,vim inoremap \u0026lt; \u0026lt;lt\u0026gt;\u0026gt;\u0026lt;Esc\u0026gt;i| inoremap \u0026gt; \u0026lt;c-r\u0026gt;=ClosePair(\u0026#39;\u0026gt;\u0026#39;)\u0026lt;CR\u0026gt; inoremap ) \u0026lt;c-r\u0026gt;=ClosePair(\u0026#39;)\u0026#39;)\u0026lt;CR\u0026gt; inoremap ] \u0026lt;c-r\u0026gt;=ClosePair(\u0026#39;]\u0026#39;)\u0026lt;CR\u0026gt; inoremap } \u0026lt;c-r\u0026gt;=CloseBracket()\u0026lt;CR\u0026gt; inoremap \u0026#34; \u0026lt;c-r\u0026gt;=QuoteDelim(\u0026#39;\u0026#34;\u0026#39;)\u0026lt;CR\u0026gt; inoremap \u0026#39; \u0026lt;c-r\u0026gt;=QuoteDelim(\u0026#34;\u0026#39;\u0026#34;)\u0026lt;CR\u0026gt; function ClosePair(char) if getline(\u0026#39;.\u0026#39;)[col(\u0026#39;.\u0026#39;) - 1] == a:char return \u0026#34;\\\u0026lt;Right\u0026gt;\u0026#34; else return a:char endif endf function CloseBracket() if match(getline(line(\u0026#39;.\u0026#39;) + 1), \u0026#39;\\s*}\u0026#39;) \u0026lt; 0 return \u0026#34;\\\u0026lt;CR\u0026gt;}\u0026#34; else return \u0026#34;\\\u0026lt;Esc\u0026gt;j0f}a\u0026#34; endif endf function QuoteDelim(char) let line = getline(\u0026#39;.\u0026#39;) let col = col(\u0026#39;.\u0026#39;) if line[col - 2] == \u0026#34;\\\\\u0026#34; return a:char elseif line[col - 1] == a:char return \u0026#34;\\\u0026lt;Right\u0026gt;\u0026#34; else return a:char.a:char.\u0026#34;\\\u0026lt;Esc\u0026gt;i\u0026#34; endif endf å½©è™¹æ‹¬å· vimé‡Œä¹Ÿæœ‰ç±»ä¼¼vscodeæˆ–IDEAé‚£æ ·çš„å½©è™¹æ‹¬å·æ’ä»¶\nPlug \u0026#39;luochen1990/rainbow\u0026#39; #æˆ– repo = \u0026#39;luochen1990/rainbow\u0026#39; init.vim æ·»åŠ \nlet g:rainbow_active = 1 let g:rainbow_conf = { \\  \u0026#39;guifgs\u0026#39;: [\u0026#39;darkorange3\u0026#39;, \u0026#39;seagreen3\u0026#39;, \u0026#39;royalblue3\u0026#39;, \u0026#39;firebrick\u0026#39;], \\  \u0026#39;ctermfgs\u0026#39;: [\u0026#39;lightyellow\u0026#39;, \u0026#39;lightcyan\u0026#39;,\u0026#39;lightblue\u0026#39;, \u0026#39;lightmagenta\u0026#39;], \\  \u0026#39;operators\u0026#39;: \u0026#39;_,_\u0026#39;, \\  \u0026#39;parentheses\u0026#39;: [\u0026#39;start=/(/ end=/)/ fold\u0026#39;, \u0026#39;start=/\\[/ end=/\\]/ fold\u0026#39;, \u0026#39;start=/{/ end=/}/ fold\u0026#39;], \\  \u0026#39;separately\u0026#39;: { \\  \u0026#39;*\u0026#39;: {}, \\  \u0026#39;tex\u0026#39;: { \\  \u0026#39;parentheses\u0026#39;: [\u0026#39;start=/(/ end=/)/\u0026#39;, \u0026#39;start=/\\[/ end=/\\]/\u0026#39;], \\  }, \\  \u0026#39;lisp\u0026#39;: { \\  \u0026#39;guifgs\u0026#39;: [\u0026#39;darkorange3\u0026#39;, \u0026#39;seagreen3\u0026#39;, \u0026#39;royalblue3\u0026#39;, \u0026#39;firebrick\u0026#39;], \\  }, \\  \u0026#39;vim\u0026#39;: { \\  \u0026#39;parentheses\u0026#39;: [\u0026#39;start=/(/ end=/)/\u0026#39;, \u0026#39;start=/\\[/ end=/\\]/\u0026#39;, \u0026#39;start=/{/ end=/}/ fold\u0026#39;, \u0026#39;start=/(/ end=/)/ containedin=vimFuncBody\u0026#39;, \u0026#39;start=/\\[/ end=/\\]/ containedin=vimFuncBody\u0026#39;, \u0026#39;start=/{/ end=/}/ fold containedin=vimFuncBody\u0026#39;], \\  }, \\  \u0026#39;html\u0026#39;: { \\  \u0026#39;parentheses\u0026#39;: [\u0026#39;start=/\\v\\\u0026lt;((area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)[ \u0026gt;])@!\\z([-_:a-zA-Z0-9]+)(\\s+[-_:a-zA-Z0-9]+(\\=(\u0026#34;[^\u0026#34;]*\u0026#34;|\u0026#39;.\u0026#34;\u0026#39;\u0026#34;.\u0026#39;[^\u0026#39;.\u0026#34;\u0026#39;\u0026#34;.\u0026#39;]*\u0026#39;.\u0026#34;\u0026#39;\u0026#34;.\u0026#39;|[^ \u0026#39;.\u0026#34;\u0026#39;\u0026#34;.\u0026#39;\u0026#34;\u0026gt;\u0026lt;=`]*))?)*\\\u0026gt;/ end=#\u0026lt;/\\z1\u0026gt;# fold\u0026#39;], \\  }, \\  \u0026#39;css\u0026#39;: 0, \\  } \\} å®‰è£…CtrlP CtrlPæ˜¯vimä¸‹ä¸€æ¬¾å¾ˆå¥½çš„æ–‡ä»¶æ¨¡ç³Šæœç´¢è·³è½¬æ’ä»¶\nkien/ctrlp.vim\nå®‰è£…\nrepo = \u0026#39;kien/ctrlp.vim\u0026#39; ä½¿ç”¨\n:CtrlP [è¦æœç´¢çš„ç›®å½•] å¦‚æœç›®å½•ä¸‹çš„æ–‡ä»¶è¿‡å¤šï¼Œæ¯”å¦‚ç³»ç»Ÿæ ¹ç›®å½•ï¼Œå°±ä¼šèŠ±æ¯”è¾ƒå¤šçš„æ—¶é—´å»ç´¢å¼•ã€‚æ‰€ä»¥å»ºè®®å°½é‡ç¼©å°èŒƒå›´ã€‚\nä¹‹åä¾¿å¯ä»¥è¾“å…¥å…³é”®å­—è¿›è¡Œæœç´¢äº†\nå…¶ä»–æ’ä»¶ æ¯”å¦‚æ›´å¥½çš„ä»£ç æ ¼å¼åŒ–vim-clang-formatå’Œä»£ç æ—¶é—´è®°å½•wakatime\nrhysd/vim-clang-format\nwakatime/vim-wakatime\nåŸºæœ¬ä¸Šæƒ³è¦çš„æ’ä»¶éƒ½å¯ä»¥åœ¨githubä¸Šæ‰¾åˆ°ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£ä½¿ç”¨å³å¯\nå¸¸ç”¨å¿«æ·é”® SPC 1/2/3 åˆ‡æ¢ä¸åŒçª—å£ï¼Œæ•°å­—ä¸ºçª—å£ç¼–å·\nSPC l r è¿è¡Œä»£ç \nSPC b f ä»£ç æ ¼å¼åŒ–\ng d å‡½æ•°è·³è½¬\n\u0026lt;c-o\u0026gt; å›è°ƒåˆ°ä¸Šæ¬¡çš„ä½ç½®ï¼ˆè¿™ä¸ªå†™æ³•è¡¨ç¤ºctrl+oï¼‰\næ›´å¤šåŠŸèƒ½å¯ä»¥SPCç©ºæ ¼é”®å”¤å‡ºèœå•æŸ¥çœ‹\nå°¾å£° åˆ°æ­¤ä¸€ä¸ªåŸºæœ¬çš„vimç¼–ç¨‹ç¯å¢ƒå·²ç»æ­å¥½äº†ï¼Œç”¨æ¥å†™ç‚¹å°ä¸œè¥¿è¿˜æ˜¯å¤Ÿç”¨çš„ã€‚\nè¿™ä¸€å¥—æŠ˜è…¾ä¸‹æ¥æœ€å¤§çš„æ„Ÿå—æ˜¯æ›¾ç»è§‰å¾—vimå¥½éš¾å­¦å¥½éš¾ç”¨ï¼Œä½†æ˜¯é€šè¿‡è¿™å‡ å¤©æ£é¼“ä¹‹åå‘ç°åªè¦ç†Ÿç»ƒäº†å…¶å®æ•ˆç‡è¿˜æ˜¯å¾ˆé«˜çš„ã€‚éš¾æ€ªè‡³ä»Šè¿˜æœ‰å¾ˆå¤švimçš„ä½¿ç”¨è€…å’Œçˆ±å¥½è€…ã€‚åŒæ—¶è‡ªå·±å®‰è£…å„ç§æ’ä»¶ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡è‡ªå®šä¹‰æ¥è·å¾—ä¸€æ¬¾å®Œå…¨å±äºè‡ªå·±çš„ç¼–è¾‘å™¨çš„è¿‡ç¨‹ä¹Ÿæ˜¯å……æ»¡ä¹è¶£çš„ï¼Œæˆ‘å¾ˆäº«å—è¿™ä¸ªè¿‡ç¨‹ã€‚\n","date":"2021-01-31T21:26:00+08:00","image":"https://ccqstark.github.io/p/vim/vim_hu721b1231aff42422e86b1dd0b5ea6e91_94583_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/vim/","title":"æˆ‘çš„vimå…¥é—¨é…ç½®æŠ˜è…¾"},{"content":"ElacticSearchç´¢å¼•ä¸­æœ‰å¤§é‡çš„æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰ä¸€äº›å®‰å…¨æªæ–½çš„è¯ä¼šè®©ç³»ç»Ÿå¤„äºä¸€ä¸ªååˆ†å±é™©çš„å¤„å¢ƒï¼Œå¼•å‘çš„ç›¸å…³å®‰å…¨äº‹ä»¶å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ã€‚\nä½ çš„Elasticsearchåœ¨\u0026quot;è£¸å¥”\u0026quot;å—ï¼Ÿ\nè€ŒElaticSearchå®˜æ–¹çš„é«˜çº§å®‰å…¨æœåŠ¡æ˜¯æ”¶è´¹çš„ï¼Œä¸»è¦ç»™ä¼ä¸šæä¾›ã€‚ä½†æ˜¯ä»6.8å’Œ7.1ç‰ˆæœ¬å¼€å§‹ï¼ŒåŸºç¡€å®‰å…¨åŠŸèƒ½å°±å…è´¹äº†ï¼Œè€Œä¸”å·²ç»é›†æˆåœ¨é‡Œé¢ä¸ç”¨é¢å¤–å®‰è£…ã€‚\né™¤æ­¤ä¹‹å¤–è¯¸å¦‚Search Guardã€ReadonlyRESTã€Nginx ç­‰å¼€æºå…è´¹ç­‰æ–¹æ³•æ¥è¾¾åˆ°å®‰å…¨çš„ç›®çš„ï¼Œè¿™é‡Œä»‹ç»çš„æ˜¯ä½¿ç”¨å®˜æ–¹çš„x-packçš„åŸºç¡€å®‰å…¨åŠŸèƒ½ï¼Œå¯¹äºå°é¡¹ç›®æ¥è¯´å¤Ÿç”¨äº†ã€‚\næœ¬æ–‡ç‰ˆæœ¬ä¸º7.10.1\nä¿®æ”¹é…ç½®æ–‡ä»¶ åœ¨elasticsearch.ymlé‡Œæ–°å¢\nxpack.security.enabled:truexpack.security.transport.ssl.enabled:trueä¹‹åé‡å¯ es\nåœ¨esç›®å½•ä¸‹æ‰§è¡Œ elasticsearch-setup-passwords interactive ç„¶åè¾“å…¥å¤šä¸ªç”¨æˆ·çš„å¯†ç \nInitiating the setup of passwords for reserved users elastic,apm_system,kibana,logstash_system,beats_system,remote_monitoring_user. You will be prompted to enter passwords as the process progresses. Please confirm that you would like to continue [y/N]y Enter password for [elastic]: Reenter password for [elastic]: Passwords do not match. Try again. Enter password for [elastic]: Reenter password for [elastic]: Enter password for [apm_system]: Reenter password for [apm_system]: Enter password for [kibana]: Reenter password for [kibana]: Enter password for [logstash_system]: Reenter password for [logstash_system]: Enter password for [beats_system]: Reenter password for [beats_system]: Enter password for [remote_monitoring_user]: Reenter password for [remote_monitoring_user]: Changed password for user [apm_system] Changed password for user [kibana] Changed password for user [logstash_system] Changed password for user [beats_system] Changed password for user [remote_monitoring_user] Changed password for user [elastic] å…¶ä¸­elasticç”¨æˆ·ç›¸å½“ä¸esçš„rootç”¨æˆ·ï¼Œä¹‹åä½¿ç”¨eså’Œkibanaéœ€è¦è¿™ä¸ªç”¨æˆ·çš„å¯†ç \nè®¾ç½®å®Œé‡å¯ä¸€ä¸‹es\næµ‹è¯• curl -GET -u elastic http://[ip]:9200/ å‘ç°æç¤ºè¾“å…¥elasticç”¨æˆ·çš„å¯†ç \nEnter host password for user \u0026#39;elastic\u0026#39;: åŸºæœ¬çš„å®‰å…¨å°±å®ç°äº†ï¼Œä¹‹åè¿›ä¸€æ­¥é˜²æ­¢æš´åŠ›ç ´è§£å¯†ç å¯ä»¥å†ä½¿ç”¨iptables\nKibanaè®¾ç½® ä¿®æ”¹kibana.yml\nelasticsearch.username:\u0026#34;elastic\u0026#34;elasticsearch.password:\u0026#34;[å¯†ç ]\u0026#34;xpack:apm.ui.enabled:falsegraph.enabled:falseml.enabled:falsemonitoring.enabled:falsereporting.enabled:falsesecurity.enabled:true# è¿™é‡Œè¦æ‰“å¼€grokdebugger.enabled:falsesearchprofiler.enabled:falseä¹‹åè¿›å…¥kibanaè¿›å…¥ç™»é™†ç•Œé¢\nç”¨elasticç”¨æˆ·å’Œå¯†ç ç™»é™†å³å¯\nä»£ç ä¸­é…ç½® Java High Level REST Clientä¸­é…ç½®è´¦æˆ·å’Œå¯†ç \nfinal CredentialsProvider credentialsProvider = new BasicCredentialsProvider(); credentialsProvider.setCredentials(AuthScope.ANY, new UsernamePasswordCredentials(\u0026#34;elastic\u0026#34;, \u0026#34;123456\u0026#34;)); //esè´¦å·å¯†ç ï¼ˆé»˜è®¤ç”¨æˆ·åä¸ºelasticï¼‰  RestHighLevelClient client = new RestHighLevelClient( RestClient.builder( new HttpHost(\u0026#34;localhost\u0026#34;, 9200, \u0026#34;http\u0026#34;)) .setHttpClientConfigCallback(new RestClientBuilder.HttpClientConfigCallback() { public HttpAsyncClientBuilder customizeHttpClient(HttpAsyncClientBuilder httpClientBuilder) { httpClientBuilder.disableAuthCaching(); return httpClientBuilder.setDefaultCredentialsProvider(credentialsProvider); } })); SpringBootçš„é…ç½®æ–‡ä»¶\nspring.elasticsearch.rest.username=elasticspring.elasticsearch.rest.password=123456ä¿®æ”¹å¯†ç  curl -H \u0026#34;Content-Type:application/json\u0026#34; -XPOST -u elastic \u0026#39;http://127.0.0.1:9200/_xpack/security/user/elastic/_password\u0026#39; -d \u0026#39;{ \u0026#34;password\u0026#34; : \u0026#34;123456\u0026#34; }\u0026#39; ç»“å°¾ è¿™é‡Œåªæ˜¯å•èŠ‚ç‚¹ç¤ºä¾‹ï¼Œé›†ç¾¤ä»¥åŠè¯ä¹¦ç›¸å…³å¯ä»¥å‚çœ‹å®˜æ–¹æ–‡æ¡£\né€šè¿‡ TLS åŠ å¯†å’ŒåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ç¡®ä¿ Elasticsearch çš„å®‰å…¨\n","date":"2021-01-29T21:26:00+08:00","image":"https://ccqstark.github.io/p/x_pack/x-pack_huc4207ebc9b333ece948f0ec8e981e0d7_15854_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/x_pack/","title":"[Elastic]ElasticSearch å®‰å…¨"},{"content":"å®‰è£…logstash åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨esè¿›è¡Œæœç´¢ï¼Œæˆ‘ä»¬å°±è¦æŠŠmysqlæ•°æ®åº“ä¸­çš„æ•°æ®åŒæ­¥åˆ°esç´¢å¼•åº“ä¸­ã€‚è¿›è¡Œè¿™é¡¹è¿‡ç¨‹çš„å·¥å…·å¾ˆå¤šï¼Œæ¯”å¦‚go-mysql-elasticsearchï¼Œcanalç­‰ç­‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ELKç»„åˆä¸­çš„logsatsh æ¥å®Œæˆã€‚è¿™é‡ŒåŒæ ·ç”¨dockeræ¥éƒ¨ç½²logstashå®¹å™¨ã€‚\næ‹‰å–é•œåƒ docker pull logstash:7.10.1 å¯åŠ¨å®¹å™¨ å¯åŠ¨åè¿›å…¥å®¹å™¨å†…ï¼Œä¿®æ”¹jvmå¯åŠ¨çš„å†…å­˜è®¾ç½®ï¼Œåœ°å€ä¸º/usr/share/logstash/config/jvm.options\n# ä¿®æ”¹jvmå†…å­˜åˆ†é… vi jvm.options # ä¿®æ”¹ä¸‹é¢çš„å‚æ•°ï¼Œå•ä½å¯ä»¥ä¸ºgå’Œm -Xms256m -Xmx256m ä¿®æ”¹åé‡å¯å®¹å™¨å³å¯\nä¸‹è½½æ’ä»¶ä¸ä¾èµ–åŒ… docker exec -it logstash bash å®‰è£…logstash-input-jdbcæ’ä»¶\nbin/logstash-plugin install logstash-input-jdbc å¦‚æœå‡ºç°ä»¥ä¸‹ERRORï¼Œè¯´æ˜logstashé‡Œæœ¬èº«å·²ç»åŒ…å«æœ‰è¿™ä¸ªæ’ä»¶äº†ï¼Œå°±æ— éœ€å®‰è£…ã€‚7.10.1çš„ç‰ˆæœ¬æ˜¯å·²ç»è‡ªå¸¦äº†ã€‚\nERROR: Installation aborted, plugin \u0026#39;logstash-input-jdbc\u0026#39; is already provided by \u0026#39;logstash-integration-jdbc\u0026#39; ä¸‹è½½mysql-connector-javaï¼Œä¹Ÿå°±æ˜¯jdbcé©±åŠ¨\nMySQLå®˜æ–¹ä¸‹è½½åœ°å€ï¼šhttps://downloads.mysql.com/archives/c-j/\nä¸‹è½½å¯¹åº”ç‰ˆæœ¬åæœ¬åœ°è§£å‹ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åç”¨docker cpå‘½ä»¤å¤åˆ¶åˆ°logstashå®¹å™¨ä¸­\nåªéœ€è¦å…¶ä¸­çš„jaråŒ…å³å¯\n# æŠŠæ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨å†… docker cp [jaråŒ…è·¯å¾„] logstash:[å®¹å™¨å†…è·¯å¾„] åœ¨/usr/share/logstashç›®å½•ä¸‹æ–°å»ºmysql/ç›®å½•ï¼ŒæŠŠjaråŒ…å¤åˆ¶åˆ°è¿™é‡Œ\nåŒæ­¥é…ç½®æ–‡ä»¶ åœ¨åˆšåˆšçš„mysqlç›®å½•ä¸‹æ–°å»ºjdbc.conf æ–‡ä»¶ï¼Œæ¥é…ç½®åŒæ­¥æ“ä½œ\n å•è¡¨åŒæ­¥  input { jdbc { # jaråŒ…çš„ç»å¯¹è·¯å¾„ jdbc_driver_library =\u0026gt; \u0026#34;/usr/share/logstash/mysql/mysql-connector-java-5.1.48.jar\u0026#34; jdbc_driver_class =\u0026gt; \u0026#34;com.mysql.jdbc.Driver\u0026#34; # æ•°æ®åº“è¿æ¥ä¿¡æ¯ jdbc_connection_string =\u0026gt; \u0026#34;jdbc:mysql://[ip]:3306/[åº“å]?characterEncoding=UTF-8\u0026amp;autoReconnect=true\u0026#34; jdbc_user =\u0026gt; \u0026#34;[mysqlç”¨æˆ·]\u0026#34; jdbc_password =\u0026gt; \u0026#34;[å¯†ç ]\u0026#34; # cronçš„å®šæ—¶æ‰§è¡Œè¯­æ³•ä¸€æ ·ï¼Œé»˜è®¤æ¯åˆ†é’ŸåŒæ­¥ä¸€æ¬¡ schedule =\u0026gt; \u0026#34;* * * * *\u0026#34; # æ‰§è¡Œçš„sqlè¯­å¥è¯­æ³•ï¼Œè¿™é‡Œæ˜¯é€šè¿‡å°†ä¸»é”®å¤§äºæœ€åä¸€æ¬¡åŒæ­¥æ‰€è®°å½•çš„å€¼æ¥å®ç°å¢é‡åŒæ­¥çš„ statement =\u0026gt; \u0026#34;SELECT * FROM activity WHERE activity_id \u0026gt; :sql_last_value order by activity_id asc\u0026#34; use_column_value =\u0026gt; true # ç”¨æ¥ä½œä¸ºå¢é‡åŒæ­¥çš„åˆ¤æ–­å­—æ®µï¼Œæœ€å¥½ä¸ºè¡¨çš„ä¸»é”® tracking_column =\u0026gt; \u0026#34;activity_id\u0026#34; # æ˜¯å¦è®°å½•ä¸Šæ¬¡æ‰§è¡Œç»“æœï¼Œtrueè¡¨ç¤ºä¼šå°†ä¸Šæ¬¡æ‰§è¡Œç»“æœçš„tracking_columnå­—æ®µçš„å€¼ä¿å­˜åˆ°last_run_metadata_pathæŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼› record_last_run =\u0026gt; true # record_last_runä¸Šæ¬¡æ•°æ®å­˜æ”¾ä½ç½® last_run_metadata_path =\u0026gt; \u0026#34;/usr/share/logstash/mysql/last_id.txt\u0026#34; # æ˜¯å¦æ¸…é™¤last_run_metadata_pathçš„è®°å½•ï¼Œéœ€è¦å¢é‡åŒæ­¥æ—¶æ­¤å­—æ®µå¿…é¡»ä¸ºfalse clean_run =\u0026gt; false } } output{ elasticsearch{ hosts =\u0026gt; [\u0026#34;[ip]:9200\u0026#34;] index =\u0026gt; \u0026#34;[ç´¢å¼•å]\u0026#34; # æ•°æ®å”¯ä¸€ç´¢å¼•ï¼ˆå»ºè®®ä½¿ç”¨æ•°æ®åº“KeyIDï¼‰ document_id =\u0026gt; \u0026#34;%{activity_id}\u0026#34; } stdout { codec =\u0026gt; rubydebug } }  å¤šè¡¨åŒæ­¥  å¤šè¡¨é…ç½®å’Œå•è¡¨é…ç½®çš„åŒºåˆ«åœ¨äºinputæ¨¡å—çš„jdbcæ¨¡å—æœ‰å‡ ä¸ªtypeï¼Œoutputæ¨¡å—å°±éœ€å¯¹åº”æœ‰å‡ ä¸ªtype\ninput { stdin {} jdbc { # å¤šè¡¨åŒæ­¥æ—¶ï¼Œè¡¨ç±»å‹åŒºåˆ†ï¼Œå»ºè®®å‘½åä¸ºâ€œåº“å_è¡¨åâ€ï¼Œæ¯ä¸ªjdbcæ¨¡å—éœ€å¯¹åº”ä¸€ä¸ªtypeï¼› type =\u0026gt; \u0026#34;TestDB_DetailTab\u0026#34; # å…¶ä»–é…ç½®æ­¤å¤„çœç•¥ï¼Œå‚è€ƒå•è¡¨é…ç½® # ... # ... # record_last_runä¸Šæ¬¡æ•°æ®å­˜æ”¾ä½ç½®ï¼› last_run_metadata_path =\u0026gt; \u0026#34;mysql\\last_id.txt\u0026#34; # æ˜¯å¦æ¸…é™¤last_run_metadata_pathçš„è®°å½•ï¼Œéœ€è¦å¢é‡åŒæ­¥æ—¶æ­¤å­—æ®µå¿…é¡»ä¸ºfalseï¼› clean_run =\u0026gt; false # # åŒæ­¥é¢‘ç‡(åˆ† æ—¶ å¤© æœˆ å¹´)ï¼Œé»˜è®¤æ¯åˆ†é’ŸåŒæ­¥ä¸€æ¬¡ï¼› schedule =\u0026gt; \u0026#34;* * * * *\u0026#34; } jdbc { # å¤šè¡¨åŒæ­¥æ—¶ï¼Œè¡¨ç±»å‹åŒºåˆ†ï¼Œå»ºè®®å‘½åä¸ºâ€œåº“å_è¡¨åâ€ï¼Œæ¯ä¸ªjdbcæ¨¡å—éœ€å¯¹åº”ä¸€ä¸ªtypeï¼› type =\u0026gt; \u0026#34;TestDB_Tab2\u0026#34; # å¤šè¡¨åŒæ­¥æ—¶ï¼Œlast_run_metadata_pathé…ç½®çš„è·¯å¾„åº”ä¸ä¸€è‡´ï¼Œé¿å…æœ‰å½±å“ï¼› # å…¶ä»–é…ç½®æ­¤å¤„çœç•¥ # ... # ... } } filter { json { source =\u0026gt; \u0026#34;message\u0026#34; remove_field =\u0026gt; [\u0026#34;message\u0026#34;] } } output { # outputæ¨¡å—çš„typeéœ€å’Œjdbcæ¨¡å—çš„typeä¸€è‡´ if [type] == \u0026#34;TestDB_DetailTab\u0026#34; { elasticsearch { # host =\u0026gt; \u0026#34;192.168.1.1\u0026#34; # port =\u0026gt; \u0026#34;9200\u0026#34; # é…ç½®ESé›†ç¾¤åœ°å€ hosts =\u0026gt; [\u0026#34;192.168.1.1:9200\u0026#34;, \u0026#34;192.168.1.2:9200\u0026#34;, \u0026#34;192.168.1.3:9200\u0026#34;] # ç´¢å¼•åå­—ï¼Œå¿…é¡»å°å†™ index =\u0026gt; \u0026#34;detailtab1\u0026#34; # æ•°æ®å”¯ä¸€ç´¢å¼•ï¼ˆå»ºè®®ä½¿ç”¨æ•°æ®åº“KeyIDï¼‰ document_id =\u0026gt; \u0026#34;%{KeyId}\u0026#34; } } if [type] == \u0026#34;TestDB_Tab2\u0026#34; { elasticsearch { # host =\u0026gt; \u0026#34;192.168.1.1\u0026#34; # port =\u0026gt; \u0026#34;9200\u0026#34; # é…ç½®ESé›†ç¾¤åœ°å€ hosts =\u0026gt; [\u0026#34;192.168.1.1:9200\u0026#34;, \u0026#34;192.168.1.2:9200\u0026#34;, \u0026#34;192.168.1.3:9200\u0026#34;] # ç´¢å¼•åå­—ï¼Œå¿…é¡»å°å†™ index =\u0026gt; \u0026#34;detailtab2\u0026#34; # æ•°æ®å”¯ä¸€ç´¢å¼•ï¼ˆå»ºè®®ä½¿ç”¨æ•°æ®åº“KeyIDï¼‰ document_id =\u0026gt; \u0026#34;%{KeyId}\u0026#34; } } stdout { codec =\u0026gt; json_lines } } ä¸ºäº†ç»Ÿä¸€ï¼ŒæŠŠæ•°æ®ä¹Ÿæ”¾è¿™ä¸ªç›®å½•ä¸‹ï¼Œåœ¨mysqlç›®å½•ä¸‹å†æ–°å»ºç›®å½•data\nmkdir data å¯åŠ¨logstashåŒæ­¥ cdå›åˆ°/usr/share/logstashç›®å½•ï¼Œå¯åŠ¨åŒæ­¥\n./bin/logstash -f mysql/jdbc.conf --path.data=/usr/share/logstash/mysql/data/ æ³¨æ„ï¼Œè¦ä¿è¯ç»™elasticsearchçš„åˆ†é…çš„å†…å­˜è¶³å¤Ÿå¤§æ‰è¡Œï¼Œæµ‹è¯•ç”¨çš„256mæ˜¯ä¸å¤Ÿçš„ï¼Œä¼šå¯¼è‡´eså®¹å™¨é€€å‡ºï¼Œè‡³å°‘ç»™ä¸ª1g\nâ€”-path.dataå‚æ•°ç”¨æ¥è®¾ç½®åŒæ­¥æ•°æ®å­˜æ”¾çš„ä½ç½®\nå¯åŠ¨ä¹‹åæ§åˆ¶å°ä¼šæ‰“å°å‡ºå¤§æ¦‚ä»¥ä¸‹ä¿¡æ¯\nUsing bundled JDK: /usr/share/logstash/jdk OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release. WARNING: An illegal reflective access operation has occurred WARNING: Illegal reflective access by org.jruby.ext.openssl.SecurityHelper (file:/tmp/jruby-423/jruby7667758569951782495jopenssl.jar) to field java.security.MessageDigest.provider WARNING: Please consider reporting this to the maintainers of org.jruby.ext.openssl.SecurityHelper WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations WARNING: All illegal access operations will be denied in a future release å¼€å§‹åŒæ­¥ä¼šæ‰“å°å‡ºä»æ•°æ®åº“è¯»å–çš„ï¼Œæ’å…¥åˆ°elasticsearchçš„ä¿¡æ¯\nå®é™…ä½¿ç”¨ä¸­ç”¨nohup æ¥ä¿æŒåå°è¿è¡Œ\nç¼ºç‚¹ logstashçš„ç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯åªèƒ½åŒæ­¥mysqlä¸­æ–°å¢çš„æ•°æ®ï¼Œå¯¹äºæ›´æ”¹çš„ã€åˆ é™¤çš„å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚è¿™å…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼ŒELKå…¶å®æœ¬æ¥å°±æ˜¯ç”¨æ¥æ”¶é›†ä¸åˆ†ææ—¥å¿—çš„ï¼Œè€ŒåŒæ­¥å¢åŠ çš„æ•°æ®å·²ç»è¶³å¤Ÿäº†ã€‚\næˆ‘è§‰å¾—esä¸mysqlæœ€å¥½çš„åŒæ­¥å·¥å…·å…¶å®æ˜¯é˜¿é‡Œçš„å¼€æºçš„canal\nalibaba/canal\n","date":"2021-01-28T21:26:00+08:00","image":"https://ccqstark.github.io/p/logstash_mysql/logstash-mysql_hubd922da79b2e986df34a25cd755e9ffb_77309_120x120_fill_q75_box_smart1.jpg","permalink":"https://ccqstark.github.io/p/logstash_mysql/","title":"[Elastic]ä½¿ç”¨logstashåŒæ­¥MySQLæ•°æ®"},{"content":"å®‰è£…ElasticSearch æ‹‰å–é•œåƒ docker pull elasticsearch:7.10.1 å¯åŠ¨å®¹å™¨ åŒæ—¶æŒ‚è½½ç›®å½•ï¼ˆåŒ…æ‹¬é…ç½®æ–‡ä»¶å’Œdataï¼‰ï¼ˆæŒ‚è½½å‡ºæ¥çš„ä½ç½®è‡ªå·±å®šä¹‰ï¼‰\ndocker run --name elasticsearch -p 9200:9200 -p 9300:9300 -e ES_JAVA_OPTS=\u0026#34;-Xms256m -Xmx256m\u0026#34; -d \\ -v /home/es/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml \\ -v /home/es/data:/usr/share/elasticsearch/data elasticsearch:7.10.1 æ³¨æ„è¿™é‡Œè¿˜è®¾ç½®äº†JVMçš„å†…å­˜å¤§å°ï¼Œé»˜è®¤ä¸º2Gï¼Œæœ‰ç‚¹å¤§ï¼Œå¾ˆå¯èƒ½ä¼šå› ä¸ºå†…å­˜ä¸å¤Ÿè€Œæ— æ³•æ­£å¸¸å¯åŠ¨ã€‚å¯ä»¥åƒæˆ‘è¿™é‡Œæ”¹ä¸º256mæˆ–è€…å…¶ä»–å€¼ã€‚\nå¯èƒ½å‡ºç°çš„é”™è¯¯ æŸ¥çœ‹å®¹å™¨æ—¥å¿—\ndocker logs elasticsearch å¦‚æœå‡ºç°ä»¥ä¸‹é”™è¯¯\nmax virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144] åˆ™è¦ä¿®æ”¹æœåŠ¡å™¨é…ç½®\nvim /etc/sysctl.conf æ·»åŠ è¿™è¡Œ\nvm.max_map_count=262144 ç«‹å³ç”Ÿæ•ˆ, æ‰§è¡Œï¼š\n/sbin/sysctl -p å¯¹æŒ‚è½½çš„å®¿ä¸»æœºdataç›®å½•å¯èƒ½å‡ºç°æƒé™ä¸è¶³é—®é¢˜\nchmod 777 [å®¿ä¸»æœºdataç›®å½•] é…ç½®è·¨åŸŸ åˆ°æŒ‚è½½å‡ºæ¥åˆ°ä½ç½®ç¼–è¾‘é…ç½®æ–‡ä»¶\nvim elasticsearch.yml æ·»åŠ ä»¥ä¸‹å‡ è¡Œ\nnetwork.host:0.0.0.0discovery.type:single-nodehttp.cors.enabled:truehttp.cors.allow-origin:\u0026#34;*\u0026#34;åŒæ—¶å®‰å…¨ç»„å’Œé˜²ç«å¢™è®°å¾—æ‰“å¼€å¯¹åº”ç«¯å£\nè®°å¾—æ¯æ¬¡ä¿®æ”¹å®Œé…ç½®éƒ½è¦é‡å¯ docker restart elasticsearch æµè§ˆå™¨è®¿é—®æµ‹è¯• http://[IP]:9200 çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„jsonå°±æˆåŠŸäº†\n{ \u0026#34;name\u0026#34;: \u0026#34;8c819d377714\u0026#34;, \u0026#34;cluster_name\u0026#34;: \u0026#34;elasticsearch\u0026#34;, \u0026#34;cluster_uuid\u0026#34;: \u0026#34;-AkgwTlbS1SsjvzNtG45nw\u0026#34;, \u0026#34;version\u0026#34;: { \u0026#34;number\u0026#34;: \u0026#34;7.10.1\u0026#34;, \u0026#34;build_flavor\u0026#34;: \u0026#34;default\u0026#34;, \u0026#34;build_type\u0026#34;: \u0026#34;docker\u0026#34;, \u0026#34;build_hash\u0026#34;: \u0026#34;1c34507e66d7db1211f66f3513706fdf548736aa\u0026#34;, \u0026#34;build_date\u0026#34;: \u0026#34;2020-12-05T01:00:33.671820Z\u0026#34;, \u0026#34;build_snapshot\u0026#34;: false, \u0026#34;lucene_version\u0026#34;: \u0026#34;8.7.0\u0026#34;, \u0026#34;minimum_wire_compatibility_version\u0026#34;: \u0026#34;6.8.0\u0026#34;, \u0026#34;minimum_index_compatibility_version\u0026#34;: \u0026#34;6.0.0-beta1\u0026#34; }, \u0026#34;tagline\u0026#34;: \u0026#34;You Know, for Search\u0026#34; } å®‰è£…elasticsearch-head æ‹‰å–é•œåƒ docker pull mobz/elasticsearch-head:5 å¯åŠ¨å®¹å™¨ docker run -it -d --name head -p 9100:9100 mobz/elasticsearch-head:5 æµè§ˆå™¨æ‰“å¼€\nhttp://[ip]:9100/ åœ¨ä¸Šé¢é›†ç¾¤è¿æ¥å¤„çš„è¾“å…¥æ¡†è¾“å…¥elasticsearchçš„åœ°å€\nhttp://[IP]:9200 ä¹‹åç‚¹å‡»è¿æ¥ï¼Œå³è¾¹çš„é›†ç¾¤å¥åº·å€¼å­—æ ·å‡ºç°ç»¿è‰²èƒŒæ™¯ä»£è¡¨æˆåŠŸè¿æ¥\nå®‰è£…Kibana æ‹‰å–é•œåƒ docker pull kibana:7.10.1 æ³¨æ„ç‰ˆæœ¬å’ŒESçš„è¦å¯¹åº”\né…ç½®æ–‡ä»¶kibana.yml ä¸ºäº†æŒ‚è½½é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å…ˆåœ¨æœ¬æœºåˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œä»¥/home/kibana/config/kibana.yml ä¸ºä¾‹\né…ç½®æ–‡ä»¶ä¸­å†™å…¥\nserver.host:\u0026#39;0.0.0.0\u0026#39;elasticsearch.hosts:[\u0026#34;http://[ipåœ°å€]:9200/\u0026#34;]xpack:apm.ui.enabled:falsegraph.enabled:falseml.enabled:falsemonitoring.enabled:falsereporting.enabled:falsesecurity.enabled:falsegrokdebugger.enabled:falsesearchprofiler.enabled:falseå¯åŠ¨å®¹å™¨ docker run -d -it \\ --name kibana -p 5601:5601 \\ -v /home/kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml kibana:7.10.1 æµè§ˆå™¨æ‰“å¼€\nhttp://[ip]:5601/ å®‰è£…ikåˆ†è¯å™¨ é¦–å…ˆè¿›å…¥esçš„å®¹å™¨å†…\ndocker exec -it elasticsearch /bin/bash ä½¿ç”¨binç›®å½•ä¸‹çš„elasticsearch-plugin installå®‰è£…ikåˆ†è¯å™¨æ’ä»¶ï¼ˆæ³¨æ„ç‰ˆæœ¬è¦å¯¹åº”ï¼‰\n# githubå®˜æ–¹ bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.10.1/elasticsearch-analysis-ik-7.10.1.zip è¿™é‡Œå¯èƒ½ä¼šå¾ˆæ…¢ï¼Œå¯ä»¥ç”¨é•œåƒåŠ é€Ÿ\n# é•œåƒåŠ é€Ÿ bin/elasticsearch-plugin install https://github.91chifun.workers.dev//https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.10.1/elasticsearch-analysis-ik-7.10.1.zip ä¹Ÿå¯ä»¥é€‰æ‹©æœ¬åœ°ä¸‹è½½è§£å‹å®Œå†ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå†æŠŠå®ƒç§»åŠ¨åˆ°å®¹å™¨å†…çš„pluginsæ–‡ä»¶å¤¹é‡Œ\nç„¶åé‡å¯å®¹å™¨\ndocker restart elasticsearch åœ¨kibanaä¸­æµ‹è¯• GET _analyze { \u0026#34;analyzer\u0026#34;: \u0026#34;ik_max_word\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;å„åœ°æ ¡è½¦å°†äº«æœ€é«˜è·¯æƒ\u0026#34; } æœ‰ik_smart å’Œ ik_max_word ä¸¤ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯æœ€ç²—ç²’åº¦çš„æ‹†åˆ†å’Œæœ€ç»†ç²’åº¦çš„æ‹†åˆ†\n","date":"2021-01-27T21:26:00+08:00","image":"https://ccqstark.github.io/p/es_docker/elastic-docker_hu1fc05f09d19ffda9f7576c23f66afe5c_19136_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/es_docker/","title":"[Elastic]ä½¿ç”¨dockerå®‰è£…ElasticSearch + Kibana"},{"content":"éšç€ç§»åŠ¨äº’è”ç½‘å‘å±•ï¼Œç”¨æˆ·å’Œæ•°æ®é‡è¶Šæ¥è¶Šå¤šï¼Œå¯¹åº”ç”¨ç³»ç»Ÿæå‡ºäº†æ›´é«˜çš„è¦æ±‚ï¼Œç³»ç»Ÿå¿…é¡»æ”¯æŒé«˜å¹¶å‘è®¿é—®å’Œæµ·é‡æ•°æ®å¤„ç†ã€‚\nåˆ†å¸ƒå¼ç³»ç»ŸæŠ€æœ¯å°±æ˜¯ç”¨æ¥è§£å†³é›†ä¸­å¼æ¶æ„çš„æ€§èƒ½ç“¶é¢ˆé—®é¢˜ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯å»ºç«‹åœ¨ç½‘ç»œä¹‹ä¸Šçš„ç¡¬ä»¶æˆ–è€…è½¯ä»¶ç³»ç»Ÿï¼Œå½¼æ­¤ä¹‹é—´é€šè¿‡æ¶ˆæ¯ç­‰æ–¹å¼è¿›è¡Œé€šä¿¡å’Œåè°ƒã€‚\nåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒæ˜¯å¯æ‰©å±•æ€§ï¼Œé€šè¿‡å¯¹æœåŠ¡ã€å­˜å‚¨çš„æ‰©å±•ï¼Œæ¥æé«˜ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ï¼Œé€šè¿‡å¯¹å¤šå°æœåŠ¡å™¨ååŒå·¥ä½œï¼Œæ¥å®Œæˆå•å°æœåŠ¡å™¨æ— æ³•å¤„ç†çš„ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯é«˜å¹¶å‘æˆ–è€…å¤§æ•°æ®é‡çš„ä»»åŠ¡ã€‚\nå•ç‚¹æ•…éšœï¼ˆSingle Point Failureï¼‰æ˜¯æŒ‡åœ¨ç³»ç»Ÿä¸­æŸä¸ªç»„ä»¶ä¸€æ—¦å¤±æ•ˆï¼Œè¿™ä¼šè®©æ•´ä¸ªç³»ç»Ÿæ— æ³•å·¥ä½œã€‚è€Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„è®¾è®¡å°±æ˜¯ä¸ºäº†é¿å…å‡ºç°å•ç‚¹æ•…éšœé—®é¢˜ï¼Œä¸ºäº†å®ç°ä¸€ä¸ªèŠ‚ç‚¹çš„å¤±æ•ˆä¸å½±å“æ•´ä¸ªç³»ç»Ÿçš„è¿è¡Œã€‚\næ— çŠ¶æ€ï¼Œæ˜¯å› ä¸ºæ— çŠ¶æ€çš„æœåŠ¡æ‰èƒ½æ»¡è¶³éƒ¨åˆ†æœºå™¨å®•æœºä¸å½±å“å…¨éƒ¨ï¼Œå¯ä»¥éšæ—¶è¿›è¡Œæ‰©å±•çš„éœ€æ±‚ã€‚\nç”±äºåˆ†å¸ƒå¼ç³»ç»Ÿçš„ç‰¹ç‚¹ï¼Œåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­æ›´å®¹æ˜“å‡ºç°é—®é¢˜ï¼Œæ¯”å¦‚èŠ‚ç‚¹ä¹‹é—´é€šä¿¡å¤±è´¥ã€ç½‘ç»œåˆ†åŒºæ•…éšœã€å¤šä¸ªå‰¯æœ¬çš„æ•°æ®ä¸ä¸€è‡´ç­‰ï¼Œä¸ºäº†æ›´å¥½åœ°åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸‹è¿›è¡Œå¼€å‘ï¼Œå­¦è€…ä»¬æå‡ºäº†ä¸€ç³»åˆ—çš„ç†è®ºï¼Œå…¶ä¸­å…·æœ‰ä»£è¡¨æ€§çš„å°±æ˜¯ CAP ç†è®ºã€‚\nä¸€è‡´æ€§æ˜¯æŒ‡â€œæ‰€æœ‰èŠ‚ç‚¹åŒæ—¶çœ‹åˆ°ç›¸åŒçš„æ•°æ®â€ï¼Œå³æ›´æ–°æ“ä½œæˆåŠŸå¹¶è¿”å›å®¢æˆ·ç«¯å®Œæˆåï¼Œæ‰€æœ‰èŠ‚ç‚¹åœ¨åŒä¸€æ—¶é—´çš„æ•°æ®å®Œå…¨ä¸€è‡´ï¼Œç­‰åŒäºæ‰€æœ‰èŠ‚ç‚¹æ‹¥æœ‰æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ã€‚\nå¯ç”¨æ€§æ˜¯æŒ‡â€œä»»ä½•æ—¶å€™ï¼Œè¯»å†™éƒ½æ˜¯æˆåŠŸçš„â€ï¼Œå³æœåŠ¡ä¸€ç›´å¯ç”¨ï¼Œè€Œä¸”æ˜¯æ­£å¸¸å“åº”æ—¶é—´ã€‚å¹³æ—¶ä¼šçœ‹åˆ°ä¸€äº› IT å…¬å¸è¯´ç³»ç»Ÿç¨³å®šæ€§å·²ç»åšåˆ° 3 ä¸ª 9ã€4 ä¸ª 9ï¼Œå³ 99.9%ã€99.99%ï¼Œè¿™é‡Œçš„ n ä¸ª 9 å°±æ˜¯å¯¹å¯ç”¨æ€§çš„ä¸€ä¸ªæè¿°ï¼Œå«åš SLAï¼Œå³æœåŠ¡æ°´å¹³åè®®ã€‚æ¯”å¦‚æˆ‘ä»¬è¯´æœˆåº¦ 99.95% çš„ SLAï¼Œåˆ™æ„å‘³ç€æ¯ä¸ªæœˆæœåŠ¡å‡ºç°æ•…éšœçš„æ—¶é—´åªèƒ½å æ€»æ—¶é—´çš„ 0.05%ï¼Œå¦‚æœè¿™ä¸ªæœˆæ˜¯ 30 å¤©ï¼Œé‚£ä¹ˆå°±æ˜¯ 21.6 åˆ†é’Ÿã€‚\nåˆ†åŒºå®¹å¿æ€§å…·ä½“æ˜¯æŒ‡â€œå½“éƒ¨åˆ†èŠ‚ç‚¹å‡ºç°æ¶ˆæ¯ä¸¢å¤±æˆ–è€…åˆ†åŒºæ•…éšœçš„æ—¶å€™ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä»ç„¶èƒ½å¤Ÿç»§ç»­è¿è¡Œâ€ï¼Œå³ç³»ç»Ÿå®¹å¿ç½‘ç»œå‡ºç°åˆ†åŒºï¼Œå¹¶ä¸”åœ¨é‡åˆ°æŸèŠ‚ç‚¹æˆ–ç½‘ç»œåˆ†åŒºä¹‹é—´ç½‘ç»œä¸å¯è¾¾çš„æƒ…å†µä¸‹ï¼Œä»ç„¶èƒ½å¤Ÿå¯¹å¤–æä¾›æ»¡è¶³ä¸€è‡´æ€§å’Œå¯ç”¨æ€§çš„æœåŠ¡ã€‚\nåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”±äºç³»ç»Ÿçš„å„å±‚æ‹†åˆ†ï¼ŒP æ˜¯ç¡®å®šçš„ï¼ŒCAP çš„åº”ç”¨æ¨¡å‹å°±æ˜¯ CP æ¶æ„å’Œ AP æ¶æ„ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿæ‰€å…³æ³¨çš„ï¼Œå°±æ˜¯åœ¨ Partition Tolerance çš„å‰æä¸‹ï¼Œå¦‚ä½•å®ç°æ›´å¥½çš„ A å’Œæ›´ç¨³å®šçš„ Cã€‚\nCAP ç†è®ºè¯´æ˜åœ¨æ¶æ„è®¾è®¡ä¸­ï¼Œä¸è¦æŠŠç²¾åŠ›æµªè´¹åœ¨å¦‚ä½•è®¾è®¡èƒ½æ»¡è¶³ä¸‰è€…çš„å®Œç¾åˆ†å¸ƒå¼ç³»ç»Ÿä¸Šï¼Œè€Œè¦åˆç†è¿›è¡Œå–èˆï¼Œå› ä¸ºä¸‰è€…æ— æ³•å®Œå…¨å…¼å¾—ã€‚\nä¸åŒä¸šåŠ¡å¯¹äºä¸€è‡´æ€§çš„è¦æ±‚æ˜¯ä¸åŒçš„ã€‚ä¾‹å¦‚ï¼Œåœ¨å¾®åšä¸Šå‘è¡¨è¯„è®ºå’Œç‚¹èµï¼Œç”¨æˆ·å¯¹ä¸ä¸€è‡´æ˜¯ä¸æ•æ„Ÿçš„ï¼Œå¯ä»¥å®¹å¿ç›¸å¯¹è¾ƒé•¿æ—¶é—´çš„ä¸ä¸€è‡´ï¼Œåªè¦åšå¥½æœ¬åœ°çš„äº¤äº’ï¼Œå¹¶ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒï¼›è€Œæˆ‘ä»¬åœ¨ç”µå•†è´­ç‰©æ—¶ï¼Œäº§å“ä»·æ ¼æ•°æ®åˆ™æ˜¯è¦æ±‚å¼ºä¸€è‡´æ€§çš„ï¼Œå¦‚æœå•†å®¶æ›´æ”¹ä»·æ ¼ä¸èƒ½å®æ—¶ç”Ÿæ•ˆï¼Œåˆ™ä¼šå¯¹äº¤æ˜“æˆåŠŸç‡æœ‰éå¸¸å¤§çš„å½±å“ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCAP ç†è®ºä¸­æ˜¯å¿½ç•¥ç½‘ç»œå»¶è¿Ÿçš„ï¼Œä¹Ÿå°±æ˜¯å½“äº‹åŠ¡æäº¤æ—¶ï¼ŒèŠ‚ç‚¹é—´çš„æ•°æ®å¤åˆ¶ä¸€å®šæ˜¯éœ€è¦èŠ±è´¹æ—¶é—´çš„ã€‚å³ä½¿æ˜¯åŒä¸€ä¸ªæœºæˆ¿ï¼Œä»èŠ‚ç‚¹ A å¤åˆ¶åˆ°èŠ‚ç‚¹ Bï¼Œç”±äºç°å®ä¸­ç½‘ç»œè¯·æ±‚æ€»æ˜¯éœ€è¦ä¸€å®šæ—¶é—´çš„ï¼Œæ‰€ä»¥æ€»ä¼šæœ‰ä¸€æ®µæ—¶é—´ä¸ä¸€è‡´ã€‚\n CP æ¶æ„ï¼šå¯¹äº CP æ¥è¯´ï¼Œæ”¾å¼ƒå¯ç”¨æ€§ï¼Œè¿½æ±‚ä¸€è‡´æ€§å’Œåˆ†åŒºå®¹é”™æ€§ã€‚\nğŸ”§ ZooKeeperå°±æ˜¯é‡‡ç”¨äº† CP ä¸€è‡´æ€§ï¼ŒZooKeeper æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æœåŠ¡æ¡†æ¶ï¼Œä¸»è¦ç”¨æ¥è§£å†³åˆ†å¸ƒå¼é›†ç¾¤ä¸­åº”ç”¨ç³»ç»Ÿçš„åè°ƒå’Œä¸€è‡´æ€§é—®é¢˜ã€‚å…¶æ ¸å¿ƒç®—æ³•æ˜¯ Zabï¼Œæ‰€æœ‰è®¾è®¡éƒ½æ˜¯ä¸ºäº†ä¸€è‡´æ€§ã€‚åœ¨ CAP æ¨¡å‹ä¸­ï¼ŒZooKeeper æ˜¯ CPï¼Œè¿™æ„å‘³ç€é¢å¯¹ç½‘ç»œåˆ†åŒºæ—¶ï¼Œä¸ºäº†ä¿æŒä¸€è‡´æ€§ï¼Œå®ƒæ˜¯ä¸å¯ç”¨çš„ã€‚\n AP æ¶æ„ï¼šå¯¹äº AP æ¥è¯´ï¼Œæ”¾å¼ƒå¼ºä¸€è‡´æ€§ï¼Œè¿½æ±‚åˆ†åŒºå®¹é”™æ€§å’Œå¯ç”¨æ€§ï¼Œè¿™æ˜¯å¾ˆå¤šåˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡æ—¶çš„é€‰æ‹©ï¼Œåé¢çš„ Base ä¹Ÿæ˜¯æ ¹æ® AP æ¥æ‰©å±•çš„ã€‚\nğŸ“¦ å’Œ ZooKeeper ç›¸å¯¹çš„æ˜¯ Eurekaï¼ŒEureka æ˜¯ Spring Cloud å¾®æœåŠ¡æŠ€æœ¯æ ˆä¸­çš„æœåŠ¡å‘ç°ç»„ä»¶ï¼ŒEureka çš„å„ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„ï¼Œå‡ ä¸ªèŠ‚ç‚¹æŒ‚æ‰ä¸å½±å“æ­£å¸¸èŠ‚ç‚¹çš„å·¥ä½œï¼Œå‰©ä½™çš„èŠ‚ç‚¹ä¾ç„¶å¯ä»¥æä¾›æ³¨å†Œå’ŒæŸ¥è¯¢æœåŠ¡ï¼Œåªè¦æœ‰ä¸€å° Eureka è¿˜åœ¨ï¼Œå°±èƒ½ä¿è¯æ³¨å†ŒæœåŠ¡å¯ç”¨ï¼Œåªä¸è¿‡æŸ¥åˆ°çš„ä¿¡æ¯å¯èƒ½ä¸æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼Œä¸ä¿è¯ä¸€è‡´æ€§ã€‚\n","date":"2021-01-21T23:01:00+08:00","permalink":"https://ccqstark.github.io/p/cap/","title":"ä»€ä¹ˆæ˜¯CAPç†è®ºï¼Ÿ"},{"content":"ä¸ºäº†æé«˜åœ¨macä¸‹è¿æ¥sshçš„æ•ˆç‡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨alfredå’ŒiTermé…åˆï¼Œè¾¾åˆ°åªè¦åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ssh [ä¸»æœºå] å°±å¯ä»¥å¿«é€Ÿè¿ä¸Šäº†ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š\nä½¿ç”¨ssh config åœ¨~/.ssh/configæ–‡ä»¶é‡Œæ·»åŠ æœåŠ¡å™¨ä¿¡æ¯ï¼Œæ²¡æœ‰çš„è¯å°±æ–°å»ºä¸€ä¸ª\nvim ~/.ssh/configç„¶ååœ¨æ–‡ä»¶ä¸­è¾“å…¥ä¸»æœºçš„ä¿¡æ¯ï¼Œæœ‰å¤šä¸ªä¸»æœºå°±è¿½åŠ åœ¨åé¢å°±è¡Œ\nHost [ä¸»æœºå] HostName [ip] User root Port [ç«¯å£]ä½¿ç”¨å¯†é’¥ç™»é™† å¦‚æœæœ¬åœ°çš„~/.ssh ç›®å½•ä¸‹æ²¡æœ‰id_rsa ç§é’¥æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯ä½¿ç”¨ä¸‹é¢è¿™ä¸ªç›®å½•ç”Ÿæˆï¼Œä¸€è·¯å›è½¦å³å¯ï¼Œå¦‚æœå·²ç»æœ‰äº†å°±å¯ä»¥è·³è¿‡è¿™æ­¥\nssh-keygenç„¶åå°†ç§é’¥å¤åˆ¶åˆ°è¿œç¨‹æœåŠ¡å™¨\nssh-copy-id -i -p[ç«¯å£å·] root@ipæŒ‰æç¤ºè¾“å…¥ä¸€æ¬¡å¯†ç ï¼Œå°±ä¼šè‡ªåŠ¨å°†åˆšæ‰ç”Ÿæˆçš„å…¬é’¥id_rsa.pubè¿½åŠ åˆ°è¿œç¨‹ä¸»æœºçš„~/.ssh/authorized_keysåé¢äº†ï¼Œè¿™æ ·ä»¥åçš„ ssh è¿æ¥éƒ½ä¸ç”¨è¾“å…¥å¯†ç äº†\nå®‰è£…alfred-sshæ’ä»¶ https://github.com/deanishe/alfred-ssh\nåˆ°ä¸Šé¢githubé“¾æ¥ä¸‹è½½æœ€æ–°ç‰ˆï¼šSecure-SHellçš„alfredworkflowï¼ŒåŒå‡»è‡ªåŠ¨æ·»åŠ åˆ°alfredçš„workflow\næ·»åŠ åæ‰“å¼€alfredçš„åå¥½è®¾ç½®å¯ä»¥çœ‹åˆ°æ•ˆæœå¦‚ä¸‹ï¼š\næµ‹è¯•ç”¨alfredè¾“å…¥ssh+ä¸»æœºåå°±å¯ä»¥è¿ä¸ŠæœåŠ¡å™¨äº†ï¼Œä½†æ˜¯é»˜è®¤æ˜¯ç”¨macè‡ªå¸¦ä½†ç»ˆç«¯ï¼Œæƒ³ç”¨å¥½çœ‹çš„iTrem2è¿˜éœ€è¦è¿›ä¸€æ­¥æ“ä½œ\nå®‰è£…alfredé›†æˆiTerm2é…ç½® å¦‚ä¸‹å›¾ï¼Œæ‰“å¼€iTrem2çš„åå¥½è®¾ç½®ï¼Œå¦‚ä¸‹å›¾è®¾ç½®é»˜è®¤æ–¹å¼ä¸ºssh\nè¿›å…¥ä¸‹é¢githubé“¾æ¥ï¼ŒæŒ‰è¯´æ˜æ“ä½œ\nhttps://github.com/vitorgalvao/custom-alfred-iterm-scripts\næŒ‰ä¸Šé¢è¦æ±‚è¿è¡Œå‘½ä»¤å¹¶ç²˜è´´åˆ°å¯¹åº”åœ°æ–¹å°±å®Œæˆäº†ï¼\nå‚è€ƒæ–‡ç« ï¼š å¼€å‘æ•ˆç‡ç¥å™¨ä¹‹alfredé›†æˆssh+iTerm2å®ç°ä¸€æ­¥ç™»å½•æœåŠ¡å™¨\n","date":"2021-01-10T16:35:00+08:00","image":"https://ccqstark.github.io/p/alfred_iterm/ssh_hu16ae618dcf0f79ca9c769a7fb0762a5e_66847_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/alfred_iterm/","title":"Alfred + iTerm2 å¿«é€Ÿsshè¿æ¥æœåŠ¡å™¨"},{"content":"DevOpsç°åœ¨éå¸¸æµè¡Œï¼ŒCI/CDæŒç»­é›†æˆã€æŒç»­éƒ¨ç½²ä¹Ÿå¤§ç«ï¼Œè€ŒJenkinså°±æ˜¯è‡ªåŠ¨åŒ–éƒ¨ç½²ä¸»è¦çš„å·¥å…·ä¹‹ä¸€ã€‚\nè¿™ç¯‡åšå®¢å°±æ¥è¯¦ç»†ä»‹ç»ç”¨jenkinsæ¥å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²springbooté¡¹ç›®çš„dockerå®¹å™¨ï¼Œå ªç§°ä¿å§†çº§æ•™å­¦äº†ã€‚\nç”¨dockeræ‹‰å–jenkinsé•œåƒï¼Œå¯åŠ¨Jenkinså®¹å™¨ è¿™é‡Œé‡‡ç”¨çš„jenkinsæœ¬èº«ä¹Ÿæ˜¯ç”¨dockerå®¹å™¨éƒ¨ç½²çš„ï¼Œä¸å¾—ä¸è¯´dockerç¡®å®å¥½ç”¨ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è¿è¡Œåœ¨ä¸»æœºä¸Š\né¦–å…ˆæ‹‰å–Jenkinsé•œåƒ docker pull jenkins/jenkins âš ï¸æ³¨æ„ï¼šåˆ‡å‹¿docker pull jenkinsï¼Œå·²ç»åºŸå¼ƒ\nå¯åŠ¨Jenkinså®¹å™¨ docker run -u root -itd --name jenkins \\ -p 6001:8080 \\ -v $(which docker):/usr/bin/docker \\ -v /var/run/docker.sock:/var/run/docker.sock -e TZ=\u0026#34;Asia/Shanghai\u0026#34; \\ -v /etc/localtime:/etc/localtime:ro \\ -v /volume1/docker/jenkins:/var/jenkins_home \\ jenkins/jenkins  -p 6001:8080Jenkinsé»˜è®¤ç½‘é¡µè®¿é—®ç«¯å£ä¸º8080ï¼Œå°†ç«¯å£æ˜ å°„åˆ°å¤–éƒ¨ä¸»æœº6001ç«¯å£ -v $(which docker):/usr/bin/docker -v /var/run/docker.sock:/var/run/docker.sockä½¿Jenkinså†…éƒ¨å¯ä»¥ä½¿ç”¨dockerå‘½ä»¤ -e TZ=\u0026quot;Asia/Shanghai\u0026quot; -v /etc/localtime:/etc/localtime:roé…ç½®Jenkinså®¹å™¨çš„æ—¶åŒº -v /volume1/docker/jenkins:/var/jenkins_home å°†Jenkinsçš„é…ç½®æ˜ å°„åˆ°å¤–éƒ¨ä¸»æœºå·ï¼Œå®¹å™¨åˆ é™¤ä»å¯ä¿ç•™é…ç½®  æµ‹è¯•Jenkinså®¹å™¨å†…éƒ¨ # è¿›å…¥Jenkinsçš„å®¹å™¨å†…éƒ¨ docker exec -it jenkins bash # åˆ¤æ–­dockerå‘½ä»¤æ˜¯å¦æ­£å¸¸æ‰§è¡Œ docker info è®¿é—®Jenkinsç½‘é¡µç«¯ ç”¨http://ä¸»æœºIP:6001 å°±å¯ä»¥è®¿é—®Jenkinsçš„ç½‘é¡µç«¯äº†\nJenkinsåˆå§‹åŒ– è®¿é—®é¡µé¢åéœ€è¦è¾“å…¥åˆå§‹å¯†ç ï¼Œç”¨cat å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹é¡µé¢ä¸Šç»™å‡ºçš„è·¯å¾„å°±å¯ä»¥è·å¾—åˆå§‹å¯†ç ï¼Œå¤åˆ¶è¿›å»åå°±å¯ä»¥æˆåŠŸè¿›å…¥\nåˆ°æ’ä»¶è¿™é‡Œå°±é€‰æ‹©å®‰è£…æ¨èæ’ä»¶å³å¯ï¼Œç­‰å¾…å®‰è£…å®Œæ¯•ï¼Œé€Ÿåº¦ç¨æ…¢ã€‚å¦‚æœå¾ˆå¤šæ’ä»¶ä¸€ç›´å®‰è£…å¤±è´¥å¯ä»¥ç­‰ä¸‹ä¸€æ­¥é…ç½®å›½å†…æºä¹‹åå†å®‰è£…\nç„¶åæŒ‰æç¤ºåˆ›å»ºä¸€ä¸ªè‡ªå·±çš„ç®¡ç†å‘˜è´¦æˆ·\nå¦‚æœæƒ³é‡å¯Jenkinsï¼š\nåœ¨jenkinsä¸»é¡µç½‘å€ååŠ ä¸Š/restart åå›è½¦ï¼Œç‚¹å‡»ç¡®å®šå³å¯\nå®‰è£…æ’ä»¶å’Œå¿…è¦é…ç½® ä¿®æ”¹æ’ä»¶å›½å†…æºå¹¶å®‰è£…å…¶å®ƒæ’ä»¶ ç‚¹å‡»ä¾§è¾¹æ ç³»ç»Ÿç®¡ç†â†’æ’ä»¶ç®¡ç†â†’é«˜çº§\nå°†å›¾ä¸­æ‰€ç¤ºURLçš„è¾“å…¥ä¸­çš„é“¾æ¥æ”¹ä¸ºé˜¿é‡Œçš„ï¼š\nhttps://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json å®‰è£…ä¸€äº›æ’ä»¶ åœ¨æ’ä»¶ç®¡ç†ä¸­é€‰æ‹©å¯é€‰æ’ä»¶\nå®‰è£…Maven Integrationå’ŒDockerçš„æ’ä»¶ï¼Œå®‰è£…å®Œé‡å¯\nå…¨å±€å·¥å…·é…ç½® ç‚¹å‡»ç³»ç»Ÿç®¡ç†â†’å…¨å±€å·¥å…·é…ç½®\nJDK\nç”¨docker inspect jenkins æŸ¥çœ‹JAVA_HOME è·¯å¾„åå¡«å…¥å³å¯ï¼Œè¿™æ˜¯ä¸ªopenjdk1.8ï¼Œåˆšå¥½ç”¨äºé¡¹ç›®ï¼Œå› ä¸ºjenkinså°±æ˜¯Javaå¼€å‘çš„\nGit\nç”¨é»˜è®¤å³å¯\nMaven\nå¯ä»¥ç”¨å¤–éƒ¨å®‰è£…çš„ï¼Œè¿™é‡Œå› ä¸ºä¸‹äº†æ’ä»¶å°±ç”¨Jenkinsé‡Œçš„æ’ä»¶å°±è¡Œï¼Œç‚¹å‡»è‡ªåŠ¨å®‰è£…\nDocker\néƒ½å¥½äº†ä¹‹åç‚¹åº”ç”¨åœ¨ç‚¹ä¿å­˜\nJenkinså®¹å™¨å†…ä½¿ç”¨vim è¿›å…¥Jenkinså®¹å™¨å†…éƒ¨åæƒ³ä½¿ç”¨vimçš„è¯è¿˜éœ€è¦é¢å¤–å®‰è£…ï¼Œåé¢éœ€è¦ç”¨åˆ°vim\n# æ›´æ–°ä¸€ä¸‹è½¯ä»¶æº apt-get update # å®‰è£…vim apt-get install vim è¿™é‡Œå¯èƒ½æ¯”è¾ƒæ…¢ï¼Œå°±ç­‰ä¸€ä¸‹ï¼Œä½†åªéœ€ç”¨ä¸€æ¬¡å°±ä¸é¢å¤–æ¢æºäº†\nä¿®æ”¹mavenæ’ä»¶çš„é•œåƒæº å› ä¸ºjenkinsåœ¨å®¹å™¨å†…ï¼Œæ‰€ä»¥è¦è¿›å…¥å®¹å™¨å†…\ncdåˆ°ç›®å½•~/.m2 ä¸‹ï¼Œls ä¸€ä¸‹å‘ç°åªæœ‰ä¸€ä¸ªrepository ç›®å½•ï¼Œè¿™ä¸ªå°±æ˜¯é»˜è®¤çš„mavenä»“åº“ç›®å½•ï¼Œç„¶åå°±vim settings.xml æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶\nåœ¨å‘½ä»¤æ¨¡å¼ä¸‹ç”¨:set paste å¼€å¯ç²˜è´´æ¨¡å¼ï¼Œç„¶åæŠŠä¸‹é¢å†…å®¹ç²˜è´´è¿›å»ï¼Œè®°å¾—æ£€æŸ¥ä¸€ä¸‹å†…å®¹å’Œç¼–ç æ˜¯ä¸æ˜¯utf-8\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;settings xmlns=\u0026#34;http://maven.apache.org/SETTINGS/1.0.0\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd\u0026#34;\u0026gt; \u0026lt;localRepository\u0026gt;~/.m2/repository\u0026lt;/localRepository\u0026gt; \u0026lt;pluginGroups\u0026gt; \u0026lt;/pluginGroups\u0026gt; \u0026lt;proxies\u0026gt; \u0026lt;/proxies\u0026gt; \u0026lt;servers\u0026gt; \u0026lt;/servers\u0026gt; \u0026lt;mirrors\u0026gt; \u0026lt;mirror\u0026gt; \u0026lt;id\u0026gt;nexus-aliyun\u0026lt;/id\u0026gt; \u0026lt;mirrorOf\u0026gt;*\u0026lt;/mirrorOf\u0026gt; \u0026lt;name\u0026gt;Nexus aliyun\u0026lt;/name\u0026gt; \u0026lt;url\u0026gt;http://maven.aliyun.com/nexus/content/groups/public\u0026lt;/url\u0026gt; \u0026lt;/mirror\u0026gt; \u0026lt;/mirrors\u0026gt; \u0026lt;profiles\u0026gt; \u0026lt;/profiles\u0026gt; \u0026lt;/settings\u0026gt; é‡å¯jenkinsï¼Œä¹‹åä¸‹è½½åŒ…æ—¶å‘ç°å·²ç»æ›´æ”¹ä¸ºé˜¿é‡Œæºäº†\nåˆ›å»ºé¡¹ç›®å‡†å¤‡è‡ªåŠ¨åŒ–éƒ¨ç½² å·¦ä¾§è¾¹æ æ–°å»ºä¸€ä¸ªä»»åŠ¡ï¼Œé€‰æ‹©mavené¡¹ç›®\næ·»åŠ GitHubä»“åº“æºç  è¿™é‡Œç”¨GitHubåšä»£ç ä»“åº“ï¼Œä¹Ÿå¯ä»¥gitlab\næœ‰2ç§æ–¹å¼ï¼šhttpså’Œssh\nå¦‚æœæ˜¯httpsçš„è¯æ·»åŠ Credentials çš„æ—¶å€™å°±ç›´æ¥é…ç½®è‡ªå·±çš„GitHubç”¨æˆ·åå’Œå¯†ç ï¼Œä»“åº“çš„URLå¡«å†™githubä»“åº“çš„urlå°±è¡Œ\nå¦‚æœæ˜¯sshçš„è¯è¦é…ç½®å¯†é’¥ï¼Œç‚¹å‡»ç³»ç»Ÿç®¡ç†â†’Manage Credentials â†’å…¨å±€ ,ç‚¹å‡»å·¦ä¾§è¾¹æ æ·»åŠ å‡­æ®\nå¦‚æœä¹‹å‰ç”Ÿæˆè¿‡ï¼Œåœ¨è‡ªå·±æœºå™¨ä¸Šçš„~/.ssh ä¸‹catä¸€ä¸‹å°±è¡Œï¼Œæ²¡æœ‰çš„è¯å°±ssh-keygen ç”Ÿæˆ\næ³¨æ„æ­¤æ—¶urlå°±è¦ç”¨ssh://git@github.com/[ç”¨æˆ·å]/[é¡¹ç›®å].git çš„æ ¼å¼\nåŠ å¿«ä»£ç æ‹‰å–é€Ÿåº¦ ä¸ºäº†åŠ å¿«æ„å»ºé€Ÿåº¦ï¼Œå‹¾é€‰æ­¤é€‰é¡¹å¯ä»¥ä½¿jenkinsä¸æ‹‰å–ä»£ç çš„å†å²ç‰ˆæœ¬ï¼Œä»è€ŒåŠ å¿«æ„å»ºé€Ÿåº¦\nå‹¾é€‰æµ…å…‹éš†\nåˆæ¬¡ä¹‹å¤–ï¼Œä¸è¦åœ¨æœ¬åœ°æ‰“å‡ºjaråŒ…ï¼Œä¸ç„¶è¿™ä¹ˆå¤§ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°ä»“åº“å†è¢«æ‹‰å–å¾ˆè´¹æ—¶é—´\næ„å»ºè§¦å‘å™¨ æ·»åŠ mavenæ„å»ºæ­¥éª¤ æ„å»ºè„šæœ¬ è¿™é‡Œæ˜¯è¿è¡Œä¸€äº›shellè„šæœ¬æ¥æ„å»ºdockeré•œåƒå’Œè¿è¡Œå®¹å™¨çš„\nè„šæœ¬å¦‚ä¸‹ï¼Œè®°å¾—åœ¨é¡¹ç›®ç›®å½•ä¸‹å†™å¥½ä¸€ä¸ªDockerfile\n# è¿›å…¥é¡¹ç›®ç›®å½• cd /var/jenkins_home/workspace/[é¡¹ç›®å] # æ‰§è¡Œæ„å»ºDockerfileå‘½ä»¤ docker build -f Dockerfile -t [é•œåƒå]:[tag] . # åœæ­¢ä¹‹å‰çš„å®¹å™¨è¿è¡Œ docker stop [å®¹å™¨å] # åˆ é™¤ä¹‹å‰çš„å®¹å™¨ docker rm [å®¹å™¨å] #è¿è¡Œåˆšåˆšåˆ›å»ºçš„å®¹å™¨ docker run -d --name [å®¹å™¨å] -p [æ˜ å°„ç«¯å£]:8080 [é•œåƒå]:[tag] echo \u0026#34;æ„å»ºå®Œæˆ\u0026#34; Dockerfileå‚è€ƒï¼š\nFROMopenjdk:8MAINTAINER[ä½œè€…]ADD /target/[é¡¹ç›®å]-0.0.1-SNAPSHOT.jar [é¡¹ç›®å].jarEXPOSE8080ENTRYPOINT [\u0026#34;java\u0026#34;,\u0026#34;-jar\u0026#34;,\u0026#34;/[é¡¹ç›®å].jar\u0026#34;]pushè§¦å‘æ„å»º ä¸ºäº†å®ç°åªè¦æˆ‘ä»¬ä¸€å‘ä»£ç ä»“åº“pushå°±å¯ä»¥è‡ªåŠ¨è¿›è¡Œæ„å»ºï¼Œæˆ‘ä»¬éœ€è¦é…ç½®webhook\nç‚¹å‡»ç³»ç»Ÿç®¡ç†â†’ç³»ç»Ÿé…ç½® ï¼Œæ‰¾åˆ°GitHubé€‰é¡¹ï¼Œç‚¹å‡»é«˜çº§\næŒ‰ä¸‹å›¾æ“ä½œï¼š\næ‰“å¼€è‡ªå·±GitHubé¡¹ç›®é¡µé¢\nç²˜è´´åˆšåˆšå¤åˆ¶çš„åœ°å€\nä¸‹é¢å‹¾é€‰Pusheså’ŒActive ï¼Œæœ€åç‚¹å‡»æ·»åŠ å³å¯\nç‚¹å‡»é¡¹ç›®å†…å·¦ä¾§æ çš„ç«‹å³æ„å»º å¯ä»¥æ‰‹åŠ¨å¼€å§‹æ„å»º\nåœ¨è¿›ç¨‹ä¸­ç‚¹å‡»æ§åˆ¶å°è¾“å‡º çœ‹åˆ°æ„å»ºè¿‡ç¨‹ä¸­çš„æ—¥å¿—ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¾ˆé‡è¦æˆ‘ä»¬ç»å¸¸è¦çœ‹ï¼Œç”¨æ¥å‘ç°æ„å»ºè¿‡ç¨‹ä¸­çš„é”™è¯¯\næ¸…é™¤æ— ç”¨çš„é•œåƒ docker image prune åœ¨å¤šæ¬¡æ„å»ºä¹‹åå¯èƒ½ä¼šå‘ç°ä¸€äº›ä¸ºnoneçš„é•œåƒï¼Œç”¨æ­¤å‘½ä»¤æ¸…é™¤\né…ç½®é‚®ç®±é€šçŸ¥ åœ¨è¿™ä¹‹å‰ä¿è¯å®‰è£…äº†ç›¸å…³æ’ä»¶ï¼Œå¦‚æœä¸€å¼€å§‹æ˜¯é€‰å®‰è£…æ¨èæ’ä»¶é‚£åº”è¯¥éƒ½å®‰è£…äº†\nç‚¹å‡»ç³»ç»Ÿç®¡ç†â†’ç³»ç»Ÿé…ç½®\nå…ˆé…ä¸€ä¸‹ç®¡ç†å‘˜é‚®ç®±\nç„¶åæ‹‰åˆ°ä¸‹é¢ï¼ŒæŒ‰å›¾ä¸­é…ç½®ï¼Œè¿™ä¸ªé‚®ç®±è¦å¡«åˆšåˆšä¸Šé¢çš„ç®¡ç†å‘˜é‚®ç®±\næ³¨æ„é‡Œé¢çš„å¯†ç æ˜¯å¼€å¯SMTPçš„å¯†ç ï¼Œä¸æ˜¯é‚®ç®±çš„å¯†ç \nç„¶åå¯ä»¥ç‚¹å‡»å‘é€æµ‹è¯•é‚®ä»¶è¯•è¯•\nä¸Šé¢è¿˜æœ‰ä¸€ä¸ªExtended E-mail Notification ä¹Ÿé…ä¸€ä¸‹ï¼Œä¹ŸæŒ‰è¿™äº›ä¿¡æ¯å¡«å†™\nDefault Recipients æ˜¯é»˜è®¤æ¥æ”¶é€šçŸ¥çš„é‚®ç®±ï¼Œå¯ä»¥å¡«å†™å¤šä¸ªï¼Œç”¨è‹±æ–‡åŠè§’é€—å·éš”å¼€\nDefault Triggers ä¹Ÿå¯ä»¥é…ç½®ä¸€ä¸‹ï¼Œæ˜¯è§¦å‘é‚®ä»¶çš„äº‹ä»¶\nè¿™é‡Œæœ‰ä¸ªå‘ï¼Œåœ¨ç³»ç»Ÿè®¾ç½®é…ç½®å®Œä¹‹åï¼Œåœ¨é¡¹ç›®é‡Œé¢çš„è®¾ç½®è®°å¾—ä¹Ÿè¦é…ç½®å®Œæ•´\nè¿›å…¥è¦å‘é€é‚®ç®±åŠŸèƒ½çš„é¡¹ç›®çš„é…ç½®\nå†ç‚¹å‡»å¢åŠ æ„å»ºåæ“ä½œæ­¥éª¤\nç‚¹å‡»é«˜çº§è®¾ç½®åè®¾ç½®è§¦å‘æ¡ä»¶\nå…¶ä»–çš„è¯¸å¦‚Content Typeå’ŒDefault Content ä¹‹ç±»çš„å°±æŒ‰éœ€æ±‚é…å°±è¡Œ\nä¹‹ååœ¨æ§åˆ¶å°è¾“å‡ºå°±å¯ä»¥çœ‹åˆ°æ„å»ºé¡¹ç›®åˆ°æœ€åæœ‰å‘é‚®ä»¶çš„æ­¥éª¤æ—¥å¿—\nä¸»é¢˜ç¾åŒ– å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼Œä¸ªäººè§‰å¾—è¿˜æ˜¯ä¹ æƒ¯äºåŸç‰ˆ\nJenkinsè‡ªå®šä¹‰ä¸»é¢˜æ•™ç¨‹_FlyWineçš„åšå®¢-CSDNåšå®¢_jenkinsè‡ªå®šä¹‰ç•Œé¢\nå‚è€ƒæ–‡ç« ï¼š\næœ€ä¼˜é›…çš„Docker+Jenkins pipelineéƒ¨ç½²Spring booté¡¹ç›®\nJenkins+Docker+github+Spring Bootè‡ªåŠ¨åŒ–éƒ¨ç½²_linfen1520çš„åšå®¢-CSDNåšå®¢\njenkins+git+maven+dockeræŒç»­é›†æˆéƒ¨ç½²_è‡ªåŠ¨åŒ–_è¿ç»´å¼€å‘ç½‘_è¿ç»´å¼€å‘æŠ€æœ¯ç»éªŒåˆ†äº«\nJenkins - SSHè®¤è¯æ–¹å¼æ‹‰å–Gitä»£ç \ncentos7çš„Jenkinsçš„mavenæ’ä»¶çš„settings.xmlé…ç½®æ–‡ä»¶è·¯å¾„åœ¨å“ªé‡Œ_festone000çš„ä¸“æ -CSDNåšå®¢\n","date":"2021-01-09T23:01:00+08:00","image":"https://ccqstark.github.io/p/jenkins_docker_springboot/jenkins-cicd_huac9b8bcc40d9704ef8edb1ad38827231_44206_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/jenkins_docker_springboot/","title":"Jenkins + docker + springboot å®Œç¾é…åˆå…¨æµç¨‹æ•™ç¨‹"},{"content":"å¦‚æœæ˜¯å•ä½“åº”ç”¨çš„è¯nginxç”¨dockeréƒ¨ç½²å…¶å®æ˜¯æ›´éº»çƒ¦çš„ï¼Œä¸è¿‡æ—¢ç„¶æ“ä½œè¿‡å°±è®°å½•ä¸€ä¸‹ã€‚\næ‹‰å–nginxé•œåƒ docker pull nginx è¿˜æ˜¯ä¸€æ ·ï¼Œé»˜è®¤æ˜¯æ‹‰å–latestç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æƒ³è¦çš„ç‰¹å®šç‰ˆæœ¬\nå¯åŠ¨å¹¶æŒ‚è½½htmlç›®å½• docker container run \\  -d \\  -p 80:80 \\  --name mynginx \\  --v [æœ¬æœºæŒ‚è½½ç›®å½•]:/usr/share/nginx/html \\  nginx å¤åˆ¶å‡ºé…ç½®æ–‡ä»¶ docker container cp mynginx:/etc/nginx . å°†å¤åˆ¶å‡ºæ¥çš„æ–‡ä»¶å¤¹æ”¹åå¹¶ç§»åŠ¨åˆ°ä½ æƒ³è¦çš„ç›®å½•ä¸‹ï¼Œç„¶åæŠŠå®¹å™¨åœæ­¢å¹¶åˆ é™¤\næŒ‚è½½é…ç½®æ–‡ä»¶ç›®å½• æœ€åä¸€æ­¥å°±æ˜¯é‡æ–°å¯åŠ¨ä¸€ä¸ªå®¹å™¨å¹¶æŠŠhtmlå’Œé…ç½®æ–‡ä»¶ç›®å½•éƒ½æŒ‚è½½äº†\ndocker run \\  --name test-nginx \\  -v [æœ¬æœºæŒ‚è½½htmlç›®å½•]:/usr/share/nginx/html \\  -v [æœ¬æœºæŒ‚è½½nginxç›®å½•]:/etc/nginx \\  -p 80:80 \\  -d \\  nginx è®¿é—®ä¸€ä¸‹è¯•è¯•å°±å¯ä»¥äº†ï¼\nå‚è€ƒï¼š\nNginx å®¹å™¨æ•™ç¨‹\n","date":"2021-01-08T15:46:00+08:00","image":"https://ccqstark.github.io/p/docker_nginx/nginx-docker_hu2ff739cd1ceaefb705a9e30c4218e66c_86441_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/docker_nginx/","title":"[docker]ç”¨dockeréƒ¨ç½²nginx"},{"content":"è¿™ç¯‡æ–‡ç« ä»‹ç»çš„æ˜¯æŠŠæ•´ä¸ªSpringbootåç«¯é¡¹ç›®éƒ¨ç½²åˆ°dockerå®¹å™¨ä¸­ï¼Œå½“ç„¶åŒ…æ‹¬mysqlå’Œredis\næŒ‰ä¸‹é¢æ­¥éª¤ä¸€æ­¥æ­¥æ¥\næœ¬åœ°æ‰“å‡ºjaråŒ… ä»¥Mavençš„è¯ç›´æ¥å°±IDEAé‡Œæ‰“å‡ºjaråŒ…åˆ°targetç›®å½•ä¸‹ï¼Œè¿™ä¸€æ­¥å’Œä»¥å‰ä¸€æ ·\nç¼–å†™Dockerfile å¯ä»¥ç”¨IDEAé‡Œçš„æ’ä»¶æ¥å†™ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å†™dockerfile\nåœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶Dockerfile\nFROMopenjdk:8MAINTAINERccqstarkADD /target/[é¡¹ç›®jaråŒ…å].jar app.jarEXPOSE8080ENTRYPOINT [\u0026#34;java\u0026#34;,\u0026#34;-jar\u0026#34;,\u0026#34;/app.jar\u0026#34;]âš ï¸æ³¨æ„ï¼šADDåä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯é¡¹ç›®jaråŒ…çš„ç›¸å¯¹è·¯å¾„ï¼Œç¬¬äºŒæ˜¯æŠŠjaråŒ…åœ¨å®¹å™¨å†…é‡æ–°å‘½çš„å\næ„å»ºé•œåƒ åœ¨Dockerfileæ‰€åœ¨æ–‡ä»¶å¤¹ä¸‹è¿è¡Œbuild å‘½ä»¤ï¼Œæ³¨æ„æœ€åæœ‰ä¸€ä¸ª.\ndocker build -f Dockerfile -t [é•œåƒå]:[ç‰ˆæœ¬tag] .æ„å»ºä¹‹åç”¨docker images æŸ¥çœ‹ä¸€ä¸‹è‡ªå·±æ„æ¶çš„é•œåƒ\næ„å»ºå®Œä¹‹åæœ¬åœ°runä¸€ä¸‹å®¹å™¨æµ‹è¯•ä¸‹\npushä¸Šä¼ åˆ°é•œåƒä»“åº“ å…¶å®ä¹Ÿå¯ä»¥æŠŠjaråŒ…ä¸Šä¼ æœåŠ¡å™¨åç”¨æœåŠ¡å™¨çš„dockeræ¥æ„å»ºå’Œè¿è¡Œ\nä½†è¿™é‡Œé‡‡ç”¨çš„æ˜¯æŠŠæœ¬åœ°æ„å»ºçš„é•œåƒä¸Šä¼ åˆ°repositoryï¼Œç›¸å½“äºé•œåƒä»“åº“ï¼Œå…¶ä»–äººæƒ³ç”¨è¿™ä¸ªé•œåƒå°±å¯ä»¥ä»é‚£æ‹‰å–ä¸‹æ¥ä½¿ç”¨ã€‚\nrepositoryå¯ä»¥æ˜¯å®˜æ–¹çš„Docker Hubï¼Œä½†æ˜¯æ¯”è¾ƒæ…¢ï¼Œä¹Ÿå¯ä»¥èŠ±é’±ä¸Šä¼ åˆ°é˜¿é‡Œäº‘çš„å®¹å™¨é•œåƒæœåŠ¡å°±ä¼šå¿«å¾ˆå¤š\nè¿™é‡Œæ˜¯ä¸Šä¼ åˆ°docker hubï¼Œé¦–å…ˆè¦ç™»é™†è‡ªå·±åˆ°dockerè´¦å·ï¼Œæ²¡æœ‰çš„è¯å¯ä»¥å»å®˜ç½‘æ³¨å†Œä¸€ä¸ª\ndocker login -u [è´¦æˆ·å] è¾“å…¥å¯†ç æˆåŠŸåç™»é™†\nåœ¨pushä¹‹å‰è¦ç»™é•œåƒæ‰“ä¸ªtagï¼Œè¿™æ ·æ‰èƒ½ä¸Šä¼ åˆ°è‡ªå·±è´¦å·å¯¹åº”çš„ä»“åº“ä¸‹\ndocker tag [é•œåƒå] [è´¦æˆ·å]/[é•œåƒä»“åº“å]:latest ä¹‹åå°±å¯ä»¥ä¸Šä¼ äº†\ndocker push [è´¦æˆ·å]/[é•œåƒä»“åº“å]:latest pullæ‹‰å–é•œåƒ docker pull [è´¦æˆ·å]/[é•œåƒä»“åº“å]:[tag] åœ¨æœåŠ¡å™¨ä¸Šæ‹‰å–åˆ°é•œåƒåå°±å¯ä»¥å¯åŠ¨å®¹å™¨äº†\ndocker run -it -d -p [å¯¹å¤–æš´éœ²ç«¯å£]:8080 app:[tag] éƒ¨ç½²MySQLå®¹å™¨ # æ‹‰å–mysqlé•œåƒ docker pull mysql:5.7 # è·‘èµ·æ¥ docker run \\ -d \\ -p 3306:3306 \\ -v /home/mysql/conf:/etc/mysql/conf.d \\ -v /home/mysql/data:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=[è®¾ç½®mysqlåˆ°rootå¯†ç ] \\  --name [å®¹å™¨å] \\ mysql:5.7 mysqlå®¹å™¨åˆ°æš´éœ²ç«¯å£è¦å’Œä»£ç ä¸­é…åˆ°ä¸€æ ·å°±è¡Œ\nè¿™é‡Œè¿˜æŠŠé…ç½®ç›®å½•å’Œæ•°æ®ç›®å½•æŒ‚è½½äº†å‡ºæ¥ï¼Œé¿å…å®¹å™¨åœæ­¢åæ•°æ®ä¸¢å¤±\néƒ¨ç½²rediså®¹å™¨ # æ‹‰å–redisé•œåƒ docker pull redis # è¿è¡Œï¼Œè¿™ä¸ªæ—¶å€™æŒ‡å®šå¯†ç ï¼Œä¸æŒ‡å®šé»˜è®¤ä¸ºç©º docker run -d --name myredis -p 6379:6379 redis --requirepass \u0026#34;mypassword\u0026#34; âš ï¸æ³¨æ„ï¼šå»ºè®®å…ˆæŠŠmysqlå’Œrediséƒ½éƒ¨ç½²å¥½åå†å»å¯åŠ¨jaråŒ…éƒ½é•œåƒï¼Œé˜²æ­¢åº”ç”¨å¯åŠ¨æ—¶è¿ä¸åˆ°å®ƒä»¬è€ŒæŠ¥é”™\næ‰€æœ‰å®¹å™¨éƒ½æˆåŠŸå¯åŠ¨èµ·æ¥ä¹‹åå°±æŠŠæ•´ä¸ªåç«¯éƒ¨ç½²åˆ°dockerå®Œæ¯•äº†\n","date":"2021-01-07T21:39:00+08:00","image":"https://ccqstark.github.io/p/docker_springboot/docker-springboot_hu705e70abdc72815dabd2267940e19d94_40186_120x120_fill_q75_box_smart1.jpg","permalink":"https://ccqstark.github.io/p/docker_springboot/","title":"[docker]ç”¨dockeréƒ¨ç½²SpringBooté¡¹ç›®"},{"content":"Dockerfileä»‹ç» dockfileæ˜¯ç”¨æ¥æ„å»ºdockeré•œåƒçš„æ–‡ä»¶ï¼Œå‘½ä»¤å‚æ•°è„šæœ¬\nğŸ’¡æ„å»ºæ­¥éª¤ï¼š\n ç¼–å†™dockerfileè„šæœ¬ ç”¨docker buildå‘½ä»¤æ„å»ºä¸€ä¸ªé•œåƒ ç”¨docker runè¿è¡Œé•œåƒ ç”¨docker pushå‘å¸ƒé•œåƒï¼ˆDockerHubã€é˜¿é‡Œäº‘ä»“åº“ï¼‰  åœ¨å®˜ç½‘ç‚¹å‡»é•œåƒä¼šè·³è½¬åˆ°githubå¯¹åº”çš„dockerfile\nå¯ä»¥å‘ç°è¿™äº›é•œåƒä¹Ÿæ˜¯é€šè¿‡dockerfileæ¥æ„å»ºçš„\nä¸Šå›¾æ˜¯centosçš„dockerfileï¼Œå…¶ä¸­scratchæ˜¯æœ€åŸºæœ¬çš„ï¼Œ90%éƒ½æ˜¯åŸºäºè¿™ä¸ªé•œåƒã€‚\nç„¶åADD å°±æ˜¯æ·»åŠ æ¥ä¸€å±‚centosç›¸å…³çš„é•œåƒæ–‡ä»¶\nå®˜æ–¹å¾ˆå¤šé•œåƒéƒ½æ˜¯åŸºç¡€åŒ…ï¼ŒåŠŸèƒ½å¾ˆå°‘ï¼Œå¾ˆå¤šæˆ‘ä»¬éœ€è¦çš„éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸éƒ½ä¼šæ„å»ºè‡ªå·±çš„é•œåƒã€‚\næ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç›´æ¥æ„å»ºä¸€ä¸ªcentos+jdk+tomcat+mysqlçš„é•œåƒï¼Œä¸å°±ç›´æ¥æœ‰æ¥ä¸€ä¸ªå¯ä»¥è¿è¡Œjavawebé¡¹ç›®çš„ç¯å¢ƒé•œåƒäº†å—ï¼Ÿ\nDockerfileæ„å»ºè¿‡ç¨‹ åŸºæœ¬è§„åˆ™  æ¯ä¸ªå…³é”®å­—ï¼ˆä¿ç•™å­—ï¼‰éƒ½æ˜¯å¤§å†™çš„ æ‰§è¡Œé¡ºåºæ˜¯ä»ä¸Šåˆ°ä¸‹çš„ \u0026ldquo;#\u0026rdquo; è¡¨ç¤ºæ³¨é‡Š æ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒå±‚ï¼Œå¹¶æäº¤  ä»¥å‰å¼€å‘äº¤ä»˜éƒ½æ˜¯ç”¨jaråŒ…æˆ–waråŒ…ï¼Œç°åœ¨äº‘åŸç”Ÿæ—¶ä»£äº¤ä»˜çš„å°±æ˜¯dockeré•œåƒï¼Œdockeré•œåƒä¹Ÿé€æ¸æˆä¸ºä¼ä¸šäº¤ä»˜æ ‡å‡†ï¼Œè€Œæ„å»ºdockeré•œåƒå°±éœ€è¦å­¦ä¼šç¼–å†™dockerfile\nä»€ä¹ˆæ˜¯äº‘åŸç”Ÿï¼ŸèŠèŠäº‘åŸç”Ÿçš„ä»Šç”Ÿ_é˜¿é‡Œäº‘å¼€å‘è€…-CSDNåšå®¢\nDockerfileå¸¸ç”¨æŒ‡ä»¤    æŒ‡ä»¤å…³é”®å­— ä½œç”¨     FROM æ„å»ºé•œåƒæ‰€ç”¨çš„åŸºç¡€é•œåƒ   MAINTAINER é•œåƒä½œè€…ï¼Œä¸€èˆ¬æ˜¯å§“å+é‚®ç®±   RUN é•œåƒæ„å»ºæ—¶è¿è¡Œçš„å‘½ä»¤   ADD ä¸ºé•œåƒæ·»åŠ å†…å®¹   WORKDIR é•œåƒçš„å·¥ä½œç›®å½•   VOLUME æŒ‚è½½ç›®å½•   EXPOSE æš´éœ²çš„ç«¯å£   CMD å®¹å™¨å¯åŠ¨æ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤ï¼Œåªæœ‰æœ€åä¸€ä¸ªä¼šç”Ÿæ•ˆï¼Œå¯è¢«æ›¿ä»£   ENTRYPOINT ä¹Ÿæ˜¯æŒ‡å®šå¯åŠ¨æ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤ï¼Œä½†æ˜¯å¯ä»¥è¿½åŠ    ONBUILD æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„dockerfileæ—¶ä¼šè¿è¡ŒONBUILDçš„æŒ‡ä»¤ã€‚è§¦å‘æŒ‡ä»¤   COPY ç±»ä¼¼ADDï¼Œå°†æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­   ENV æ„å»ºæ—¶è®¾ç½®çš„ç¯å¢ƒå˜é‡    å®è·µï¼šæ„å»ºè‡ªå·±çš„centos ä¸¾ä¸ªä¾‹å­ï¼š\nFROMcentos # centosä¸ºåŸºç¡€é•œåƒMAINTAINERccqstark\u0026lt;xxxxxx@qq.com\u0026gt; # ä½œè€…åå’Œé‚®ç®±ENV MYPATH /usr/local # ç¯å¢ƒå˜é‡WORKDIR$MYPATH # å·¥ä½œç›®å½•# å®‰è£…vimå’Œifconfigå‘½ä»¤RUN yum -y install vim RUN yum -y install net-toolsEXPOSE80CMD echo $MYPATHCMD echo \u0026#34;---end---\u0026#34;CMD /bin/bashdocker build ä¹‹å run èµ·æ¥å°±å¯ä»¥ä½¿ç”¨äº†ï¼\nè¿˜å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹é•œåƒæ„å»ºçš„è¿‡ç¨‹\ndocker history [é•œåƒid] å‚è€ƒè‡ªç‹‚ç¥çš„dockeræ•™ç¨‹\n","date":"2021-01-06T21:13:00+08:00","image":"https://ccqstark.github.io/p/dockerfile/dockerfile_hua2299a9fb0d8a75d7ada60f608a774d6_160236_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/dockerfile/","title":"[docker]åˆè¯†Dockerfile"},{"content":"æŠŠå®¹å™¨å†…çš„ç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºçš„æŸä¸€ä¸ªç›®å½•ä¸‹ï¼Œå®ç°åŒå‘åŒæ­¥ã€‚\nä¹Ÿå°±æ˜¯è¯´ä¸¤è€…éƒ½æŒ‡å‘äº†åŒä¸€æ–‡ä»¶ç›®å½•ä¸‹ï¼Œåœ¨å…¶ä¸­ä¸€ç«¯æ‰€åšçš„ä¿®æ”¹éƒ½ä¼šåŒæ­¥ã€‚\nå¥½å¤„ï¼š\n MySQLæ•°æ®æŒä¹…åŒ–ï¼Œä¸ä¼šå› ä¸ºåˆ äº†å®¹å™¨å°±æ²¡äº† æ–¹ä¾¿ä¿®æ”¹æ–‡ä»¶ï¼Œæ¯”å¦‚nginxçš„é…ç½®æ–‡ä»¶  åŸºæœ¬ä½¿ç”¨ bind mounts ä»¥å¯åŠ¨ä¸€ä¸ªcentoså®¹å™¨ä¸ºä¾‹\ndocker run -it -v [å®¿ä¸»æœºç›®å½•]:[å®¹å™¨å†…ç›®å½•] centos /bin/bash -it ï¼š-té€‰é¡¹è®©Dockeråˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ï¼ˆpseudo-ttyï¼‰å¹¶ç»‘å®šåˆ°å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¸Šï¼Œ -i åˆ™è®©å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¿æŒæ‰“å¼€ï¼Œé€šå¸¸å†™æˆ-it\n-v ï¼šæŒ‚è½½å·æ‰€éœ€å‚æ•°ï¼Œåé¢çš„æ˜ å°„æ˜¯[å®¿ä¸»æœºç›®å½•]:[å®¹å™¨å†…ç›®å½•]\nç”¨æ­¤å‘½ä»¤æŸ¥çœ‹å®¹å™¨å‚æ•°\ndocker inspect [å®¹å™¨id] å¦‚ä¸Šå›¾ï¼Œåœ¨Mounts å­—æ®µä¸­å¯ä»¥çœ‹åˆ°ï¼š\nSource è¡¨ç¤ºå®¿ä¸»æœºä¸­è¢«æ˜ å°„çš„ç›®å½•\nDestination è¡¨ç¤ºå®¹å™¨å†…è¦æ˜ å°„çš„ç›®å½•\nè¿™ç§æŒ‚è½½æ–¹å¼ç§°ä¸ºbind mounts\nå®è·µï¼šMySQLæŒ‚è½½ æ‹‰å–mysqlé•œåƒ docker search mysql docker pull mysql:5.7 å¯åŠ¨å®¹å™¨ -d åå°è¿è¡Œ\n-p ç«¯å£æ˜ å°„\n-v æ•°æ®å·æŒ‚è½½\nâ€”name å®¹å™¨åå­—\ndocker run \\ -d \\ -p 3310:3306 \\  -v /home/mysql/conf:/etc/mysql/conf.d \\  -v /home/mysql/data:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=[ä½ é…ç½®çš„mysqlå¯†ç ] \\  --name [å®¹å™¨å] \\ mysql:5.7 -vå¯ä»¥ä¸€æ¬¡å†™å¤šä¸ªæ¥å¤šæ¬¡æŒ‚è½½\nè¿æ¥æµ‹è¯• è¿è¡ŒæˆåŠŸåç”¨navicatè¿æ¥ä¸‹è¯•è¯•\n ä¸»æœºåœ°å€è¿˜æ˜¯æœåŠ¡å™¨å…¬ç½‘ip ç«¯å£æ˜¯æ˜ å°„å‡ºæ¥çš„æš´éœ²ç«¯å£ï¼Œæ¯”å¦‚ä¸Šé¢å‘½ä»¤ä¸­çš„3310 å¯†ç å°±æ˜¯-e MYSQL_ROOT_PASSWORDè®¾ç½®çš„å¯†ç   å¯ä»¥åˆ›å»ºæ–°çš„æ•°æ®åº“çœ‹çœ‹å®¿ä¸»æœºå¯¹åº”æ˜ å°„ç›®å½•ä¸‹æœ‰æ²¡æœ‰åŒæ­¥å‡ºç°æ–°æ•°æ®åº“çš„æ–‡ä»¶\nåˆ é™¤æµ‹è¯• docker rm -f [mysqlå®¹å™¨å] è¿è¡Œä¸Šé¢çš„æŒ‡ä»¤åˆ é™¤æ‰å®¹å™¨ï¼Œå†åœ¨ä¸»æœºä¸‹æŸ¥çœ‹/home/mysql/data ç›®å½•å‘ç°æ•°æ®ä¾æ—§éƒ½è¿˜åœ¨\nå¦‚æœå†æ¬¡å¯åŠ¨ä¸€ä¸ªå®¹å™¨æ•°æ®å°±è¿˜æ˜¯å’Œåˆ é™¤å‰ä¸€æ ·ï¼Œä»è€Œä¿è¯äº†æ•°æ®å®‰å…¨ï¼Œè¿™å°±æ˜¯MySQLæ•°æ®å·æŒ‚è½½\nåŒ¿åæŒ‚è½½å’Œå…·åæŒ‚è½½ volumes åŒ¿åæŒ‚è½½ -P éšæœºæ˜ å°„ç«¯å£\ndocker run -d -P --name nginx01 -v /etc/nginx nginx å¦‚ä¸Šå›¾çš„å‘½ä»¤ï¼Œ-v æ˜¯æ²¡æœ‰æŒ‡å®šå¤–éƒ¨ç›®å½•çš„ï¼Œåªå†™äº†å†…éƒ¨ç›®å½•ï¼Œæ‰€ä»¥æ˜¯åŒ¿åæŒ‚è½½ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹æŒ‚è½½çš„å·\ndocker volume ls å‘ç°å·åæ˜¯éšæœºç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æ˜¯åŒ¿åçš„\nå…·åæŒ‚è½½ docker run -d -P --name nginx01 -v [è‡ªå·±èµ·çš„å·å]:/etc/nginx nginx [å·å]:[ç›®å½•å] è¿™æ ·æŒ‡å®šäº†å·åçš„å½¢å¼å°±æ˜¯å…·åæŒ‚è½½\nè¿™æ ·å†ç”¨docker volume ls çœ‹åˆ°çš„å·åå°±æ˜¯è‡ªå·±æŒ‡å®šçš„äº†\næŸ¥çœ‹æŒ‚è½½çš„ç›®å½• docker volume inspect [å·å] ç”¨è¿™æ¡å‘½ä»¤å°±å¯ä»¥æŸ¥çœ‹å·çš„ä¸€äº›ä¿¡æ¯ï¼Œå…¶ä¸­Mountpoint å°±æ˜¯æ‰€æŒ‚è½½çš„å¤–éƒ¨ç›®å½•\næ‰€ä»¥è¿™ç§åœ¨æ²¡æœ‰æŒ‡å®šç›®å½•çš„æƒ…å†µä¸‹ï¼ˆå…·åæˆ–åŒ¿åï¼‰éƒ½æ˜¯æŒ‚è½½åœ¨/var/lib/docker/volumes/[å·å]/_dataè¿™ä¸ªç›®å½•çš„\nå¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯ç”¨å…·åæŒ‚è½½\nè¿™ä¸¤ç§æŒ‚è½½æ–¹å¼ç»Ÿç§°volumes\næ€»ç»“ -v [å†…è·¯å¾„] åŒ¿åæŒ‚è½½ -v å·å:å†…è·¯å¾„ å…·åæŒ‚è½½ -v å®¿ä¸»æœºè·¯å¾„:å®¹å™¨å†…è·¯å¾„ æŒ‡å®šè·¯å¾„æŒ‚è½½\næ‰©å±• å¯ä»¥ç”¨å‚æ•°æ”¹å˜è¯»å†™æƒé™\nro åªè¯»ï¼Œå®¹å™¨å†…ä¸å¯ä¿®æ”¹ï¼Œå®¹å™¨å¤–å¯ä»¥\nre å¯è¯»å¯å†™\ndocker run -d -P --name nginx02 -v ccq-nginx:/etc/nginx:ro nginx docker run -d -P --name nginx02 -v ccq-nginx:/etc/nginx:rw nginx ä½¿ç”¨Dockerfileæ¥æ„å»ºå’ŒæŒ‚è½½ Dockerfileæ˜¯ç”¨æ¥æ„å»ºdockeré•œåƒçš„æ„å»ºæ–‡ä»¶ï¼Œé‡Œé¢å°±æ˜¯æ„å»ºçš„è„šæœ¬\nè¿™ä¸ªæ–‡ä»¶å¯ä»¥ç”¨æ¥ç”Ÿæˆé•œåƒï¼Œç”±äºé•œåƒæ˜¯ä¸€å±‚ä¸€å±‚çš„ï¼Œæ‰€ä»¥è„šæœ¬å‘½ä»¤ä¹Ÿæ˜¯ä¸€å¥å¥å¯¹åº”ä¸€å±‚å±‚çš„\nä»¥centosæ¥ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨dockerfileé‡Œå†™ä¸‹ä¸‹é¢è¿™äº›å†…å®¹ï¼š\nFROMcentos # ç”±å“ªä¸ªåŸå§‹é•œåƒæ„å»ºVOLUME [\u0026#34;volume01\u0026#34;,\u0026#34;volume02\u0026#34;] # æŒ‚è½½ï¼Œæ­¤å¤„åŒ¿åCMD echo \u0026#34;---end---\u0026#34;CMD /bin/bashè¿è¡Œæ„å»ºå‘½ä»¤å¦‚ä¸‹ï¼š\ndocker build -f [dockerfileè·¯å¾„] -t [é•œåƒå]:[ç‰ˆæœ¬tag] [ç”Ÿæˆç›®å½•] ç„¶åç”¨å‘½ä»¤docker images å°±å¯ä»¥çœ‹åˆ°è‡ªå·±åˆšåˆšæ„å»ºçš„é•œåƒäº†ï¼Œdocker run å°±å¯ä»¥è·‘èµ·æ¥\nä¹‹åä¹Ÿå¯ä»¥docker inspect æŸ¥çœ‹æŒ‚è½½æƒ…å†µï¼ŒæŒ‚è½½åŒæ ·æ˜¯æ•°æ®å†…å¤–ç›®å½•åŒæ­¥çš„\næ•°æ®å·å®¹å™¨ ä¹‹å‰æ˜¯å®¹å™¨å†…çš„ç›®å½•æŒ‚è½½åˆ°å®¹å™¨å¤–åˆ°åˆ°ç›®å½•ï¼Œç°åœ¨æ˜¯ä¸€ä¸ªå®¹å™¨æŒ‚è½½åˆ°å¦ä¸€ä¸ªå®¹å™¨\nè¿™æ ·å°±å®ç°äº†å®¹å™¨ä¹‹é—´åˆ°æ•°æ®åŒæ­¥\nâ€”-volumes-from ä½¿ç”¨æ­¤å‚æ•°å¼€å¯ä¸€ä¸ªå®¹å™¨æŒ‚è½½åˆ°å¦ä¸€ä¸ªå®¹å™¨\nè¢«æŒ‚è½½çš„ç§°ä¸ºçˆ¶å®¹å™¨\ndocker run -it --name [åå­—] --volumes-from [çˆ¶å®¹å™¨å] [é•œåƒå]:[ç‰ˆæœ¬tag] æµ‹è¯•ä¸€ä¸‹ï¼Œå¼€ä¸¤ä¸ªå®¹å™¨ï¼Œè¿›å…¥æŒ‚è½½åˆ°ä¸€èµ·çš„ç›®å½•åˆ›å»ºæ–‡ä»¶è¯•è¯•ï¼Œå‘ç°æ•°æ®æ˜¯åŒæ­¥çš„\nå¤šé‡æŒ‚è½½ å¯ä»¥å¼€å¯ç¬¬ä¸‰ä¸ªå®¹å™¨æŒ‚è½½åˆ°ç¬¬ä¸€æˆ–ç¬¬äºŒä¸ªå®¹å™¨ï¼Œå‘ç°ç°åœ¨è¿™3ä¸ªå®¹å™¨å¯¹åº”åˆ°ç›®å½•çš„æ•°æ®éƒ½æ˜¯åŒæ­¥çš„\næ‰€ä»¥æŒ‚è½½å…¶å®æ˜¯å¯ä»¥å¥—å¨ƒçš„\nå·çš„æŒ‚è½½æœºåˆ¶ ä¸åŒå®¹å™¨çš„æŒ‚è½½æœºåˆ¶å¹¶ä¸æ˜¯æ˜ å°„åˆ°å•ä¸€åˆ°æ–‡ä»¶å¤¹ä¸‹çš„ï¼Œå¦‚æœè¿™æ ·çš„è¯å…¶ä¸­ä¸€ä¸ªå®¹å™¨è¢«åˆ é™¤çš„è¯ï¼Œå…¶å®ƒæ‰€æœ‰å®¹å™¨å¯¹åº”éƒ½æ•°æ®éƒ½ä¼šæ¶ˆå¤±ã€‚\nå®é™…ä¸ŠæŒ‚è½½æ˜¯ä¸€ç§æ‹·è´çš„æœºåˆ¶ï¼Œæ•°æ®æ˜¯æœ‰å¤šä»½ç›¸åŒçš„å¤‡ä»½çš„ï¼Œåˆ é™¤ä¸€ç§ä¸€ä»½å…¶å®ƒçš„éƒ½è¿˜åœ¨ï¼Œä¸ä¼šæ¶ˆå¤±çš„ï¼Œåªæ˜¯ä¼šå ç”¨æ›´å¤šçš„å­˜å‚¨ç©ºé—´\nåªæœ‰æŠŠæŒ‚è½½è¿™ä¸€å·çš„æ‰€æœ‰çš„å®¹å™¨éƒ½åˆ é™¤ï¼Œè¿™ä¸ªå·æ‰ä¼šæ¶ˆå¤±\nå½“ç„¶ï¼Œå¦‚æœæ˜¯bindåˆ°æœ¬åœ°çš„ç›®å½•é‚£å°±åˆ é™¤å…¨éƒ¨å®¹å™¨æ•°æ®ä¹Ÿä»ç„¶åœ¨æœ¬åœ°\nå‚è€ƒè‡ªç‹‚ç¥çš„dockeræ•™ç¨‹\n","date":"2021-01-06T16:51:00+08:00","image":"https://ccqstark.github.io/p/docker_volumes/docker_hu22e70eb00a1bc79d3e2af88d0f9ef83b_73329_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/docker_volumes/","title":"[docker]å®¹å™¨æ•°æ®å·"},{"content":"ç»ˆäºä»Windowsè½¬åˆ°å¿ƒå¿ƒå¿µå¿µçš„MacOSä¸Šè¿›è¡Œå¼€å‘ï¼Œè™½ç„¶æ˜¯é»‘è‹¹æœä½†æ˜¯è½¯ä»¶å±‚é¢ä¸Šæ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œç¨‹åºå‘˜è¿˜æ˜¯å¾—ç”¨macå•Šè¿™ç»ˆç«¯ä¸ŠçœŸçš„æ¯”windowså¥½ç”¨æ— æ•°å€ï¼Œé‚£ç»ˆç«¯åˆ°æ‰‹åè¿˜æ˜¯è¦æŠ˜è…¾ç¾åŒ–çš„ï¼Œé‚£å°±å¼€å§‹å§ã€‚ å…ˆçœ‹ä¸‹æˆ‘ï¼Œè¿˜å¯ä»¥å§ï¼Ÿ å‡†å¤‡å·¥ä½œ å…ˆä¿è¯è‡ªå·±ä¸‹è½½homebrewå’Œwgetï¼Œå®‰è£…è½¯ä»¶æˆ–ä¸‹è½½åŒ…å¾ˆå¤šæƒ…å†µä¸‹è¦ç”¨åˆ°å®ƒä»¬ï¼Œç‰¹åˆ«homebrewæ˜¯macä¸‹æœ€å¥½ç”¨çš„åŒ…ç®¡ç†å™¨ä¸€å®šè¦æœ‰ã€‚ä¸‹è½½æ–¹æ³•ç½‘ä¸Šä¹Ÿå¾ˆå¤šçš„ï¼Œå»ºè®®å…ˆä¸‹homebrewå†ç”¨å®ƒä¸‹wgetã€‚\niTerm2 é¦–å…ˆæ˜¯ä¸‹è½½ç¬¬ä¸‰æ–¹ç»ˆç«¯iTerm2ï¼Œmacè‡ªå¸¦çš„ç»ˆç«¯ç”¨çš„æ¯”è¾ƒå°‘ï¼Œå¤§å®¶ç”¨çš„æœ€å¤šè¿˜æ˜¯è¿™ä¸ªã€‚ å®˜ç½‘ä¸‹è½½\nzsh zshæ˜¯shellçš„ä¸€ç§ï¼Œmacé»˜è®¤çš„shellæ˜¯bashï¼Œä¸€èˆ¬æ¥è¯´æˆ‘ä»¬ä¹Ÿæ˜¯ç”¨zshæ¯”è¾ƒå¤šï¼Œå› ä¸ºå‘½ä»¤æ›´å¤šæ›´å¥½ç”¨ã€‚\nä¸‹è½½zsh brew install zsh åˆ‡æ¢shellä¸ºzsh # æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„shell echo $SHELL # åˆ‡æ¢ä¸ºzsh chsh -s /bin/zsh è¿è¡Œå®Œä¸Šé¢å‘½ä»¤åé‡å¯ä¸€ä¸‹å³å¯\noh-my-zsh oh-my-zshç”¨äºç¾åŒ–ç»ˆç«¯ï¼Œå¯ä»¥è®©ä½ æ‹¥æœ‰å¾ˆå¤šå¥½çœ‹çš„ä¸»é¢˜ã€‚\nå®‰è£… wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh sh install.sh è¿è¡Œä¸Šé¢çš„å‘½ä»¤æ¥ä¸‹è½½å®‰è£…è„šæœ¬å¹¶è¿è¡Œè„šæœ¬ï¼ŒæˆåŠŸåä¼šæœ‰å¦‚ä¸‹ç”»é¢\næ›´æ¢ä¸»é¢˜ oh-my-zshæœ‰å¾ˆå¤šé»˜è®¤çš„ä¸»é¢˜ï¼Œå¯ä»¥åœ¨~/.zshrcä¸­ä¿®æ”¹ZSH_THEMEæ¥åˆ‡æ¢ä¸åŒä¸»é¢˜ã€‚ è¿™é‡Œæˆ‘æ¨èpowerlever10kï¼Œå®ƒé›†åˆäº†å¾ˆå¤šä¸åŒä¸»é¢˜é£æ ¼çš„æ ·å¼ï¼Œæ”¯æŒè‡ªå®šä¹‰ï¼Œå¦‚æœé»˜è®¤ä¸»é¢˜ä¸­æ²¡æœ‰ä½ æ»¡æ„çš„é‚£æ¨èå°±ç”¨å®ƒã€‚ä¸‹é¢å°±è®²powerlevel10kçš„å®‰è£…æ–¹æ³•ã€‚\nä¸‹è½½ git clone --depth=1 https://gitee.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k å®‰è£…æ‰€éœ€å­—ä½“ # å®‰è£… nerd-font å­—ä½“ brew tap homebrew/cask-fonts # å…¶ä»–æ‰€éœ€å­—ä½“ cd ~ git clone https://github.com/powerline/fonts.git --depth=1 # åˆ°ç›®å½•ä¸‹æ‰§è¡Œå®‰è£…è„šæœ¬ cd fonts ./install.sh # åˆ é™¤åˆšåˆšä¸‹è½½çš„ cd .. rm -rf fonts é…ç½® vim ~/.zshrc è¿›å…¥zshé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹å¹¶å¢åŠ \nZSH_THEME = \u0026#34;powerlevel10k/powerlevel10k\u0026#34; [[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh ä¹‹åå¯åŠ¨å‘å¯¼\np10k configure å¯ä»¥ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹é¢œè‰²ä»£å·\nfor i in {0..255}; do print -Pn \u0026#34;%K{$i} %k%F{$i}${(l:3::0:)i}%f \u0026#34; ${${(M)$((i%6)):#3}:+$\u0026#39;\\n\u0026#39;}; done æ¥ä¸‹æ¥éœ€è¦ä¸‹è½½ä¸€äº›å¿…è¦çš„å­—ä½“æˆ–æ ·å¼ï¼Œåœ¨æ­¤ä¹‹å‰éœ€è¦å…ˆæ”¹hostä»¥æ­£å¸¸ä¸‹è½½ ä¸‹è½½è½¯ä»¶SwitchHosts! ä¹‹åå¦‚å›¾åŠ ä¸Š\n199.232.68.133 raw.githubusercontent.com 199.232.68.133 user-images.githubusercontent.com 199.232.68.133 avatars2.githubusercontent.com 199.232.68.133 avatars1.githubusercontent.com å¼€å¯My hostsåé‡å¯ç»ˆç«¯ï¼Œå°±ä¼šè‡ªåŠ¨æç¤ºä¸‹è½½æ‰€éœ€å­—ä½“ï¼Œè€å¿ƒç­‰å¾…å®ƒä¸‹è½½å®Œï¼ˆæœ‰ç‚¹æ…¢ï¼‰åï¼Œå°±å¯ä»¥æ ¹æ®å¼•å¯¼ä¸€æ­¥æ­¥è‡ªå®šä¹‰å±äºè‡ªå·±çš„ä¸»é¢˜äº†ï¼ä»å›¾æ ‡åˆ°å­—ä½“é¢œè‰²é£æ ¼åˆ°æ˜¾ç¤ºä¿¡æ¯éƒ½å¯ä»¥è‡ªå®šä¹‰ï¼\nèƒŒæ™¯é€æ˜+æ¯›ç»ç’ƒ æ‰“å¼€iTerm2çš„åå¥½è®¾ç½®æŒ‰ä¸‹å›¾å³å¯è°ƒèŠ‚èƒŒæ™¯é€æ˜å’Œæ¯›ç»ç’ƒï¼Œä¸‹é¢è¿˜å¯ä»¥è®¾ç½®é»˜è®¤çª—å£å¤§å°ã€‚\nå¿«æ·é”®å”¤é†’ å¦‚ä½•è®©åˆ‡å‡ºç»ˆç«¯æ›´å¿«æ·ï¼Ÿå¯ä»¥è®¾ç½®Hotkey æŒ‰ä¸‹å›¾æ“ä½œ\nå°¾å£° è‡³æ­¤ï¼Œä¸€ä¸ªå¥½ç”¨åˆå¥½çœ‹çš„macç»ˆç«¯åŸºæœ¬é…ç½®å®Œæ¯•å•¦\nå…¶ä»–æœ‰è¶£çš„å¯ä»¥çœ‹ä¸‹è¿™ç¯‡åšå®¢è®²çš„\n","date":"2021-01-06T02:07:00+08:00","image":"https://ccqstark.github.io/p/mac_terminal/Mojave-desktop_hu0caf60027e85952cdd6ae94392d12e9b_35582_120x120_fill_q75_box_smart1.jpg","permalink":"https://ccqstark.github.io/p/mac_terminal/","title":"MacOSç»ˆç«¯ç¾åŒ–æŒ‡åŒ—"},{"content":"äº‹æƒ…ç»è¿‡ 11æœˆ17å·è¿™å¤©æ—©ä¸Šä¸Šç€è¯¾ï¼Œçªç„¶æœ‰ç”¨æˆ·åé¦ˆåº”ç”¨å¡é¡¿ï¼Œä½¿ç”¨ä¸äº†ã€‚æˆ‘æ„Ÿè§‰ä¸Šå»çœ‹äº†æœç„¶æ˜¯è¿™æ ·ï¼Œæœ‰æ—¶æ•°æ®åŠ è½½å¾ˆæ…¢ç”šè‡³åŠ è½½ä¸å‡ºæ¥ï¼Œæˆ‘æ„Ÿåˆ°ç„¦è™‘ä¸å®³æ€•ï¼Œå®³æ€•æ•°æ®åº“å’Œåˆ«äººä¸€æ ·è¢«é»‘äº†ç„¶ååˆ å…‰è¦é’±ï¼Œè¯¾éƒ½æ²¡å¿ƒæƒ…å¬äº†ã€‚ç„¶åæ‰‹æœºä¸‹äº†ä¸ªTermiusï¼Œå…ˆæŠŠæœåŠ¡å…³äº†ã€‚\nä¸­åˆå›åˆ°å®¿èˆåçœ‹äº†æ•°æ®åº“å‘ç°æ•°æ®å®Œå¥½æ— æŸï¼Œèµ¶ç´§å¤‡ä»½äº†ä¸€æ³¢ï¼Œç„¶åå¯»æ‰¾é—®é¢˜ã€‚\nå†…å­˜å’ŒCPUå’Œç£ç›˜éƒ½æŒºæ­£å¸¸ï¼Œçœ‹äº†æœåŠ¡å™¨çš„å®‰å…¨æ—¥å¿—ï¼Œé‚£ç™»å½•è®°å½•åˆ·åˆ·çš„ï¼Œæœ‰äººåœ¨æš´åŠ›ç ´è§£æˆ‘çš„rootå¯†ç ï¼\nç”±äºä¸‹åˆè¿˜æœ‰ä½“è‚²è¯¾ï¼Œå°±å…ˆç›´æ¥å…³äº†æœåŠ¡å™¨ï¼Œç„¶åä¸Šè¯¾å»äº†ã€‚\nä¸‹åˆæ¥åˆ°å®éªŒå®¤ï¼Œé‡æ–°æ‰“å¼€æœåŠ¡å™¨ï¼Œåˆå¼€å§‹æ”»å‡»äº†ï¼Œæ°”æ­»äº†ã€‚ç”¨è„šæœ¬å°äº†æ”»å‡»è€…ä¸€ç™¾å¤šä¸ªè‚‰é¸¡ipï¼Œä»¥ä¸ºå¯ä»¥äº†ä¹‹åï¼ŒæŠŠæœåŠ¡å¼€å¯ï¼Œé€šçŸ¥ç”¨æˆ·å¯ä»¥ç”¨äº†ã€‚\nç»“æœç”¨æˆ·åˆè¯´å¤ªå¡äº†ï¼Œæˆ‘åˆæ£€æŸ¥äº†ä¸€æ³¢ï¼ŒCPUã€å†…å­˜ã€ç£ç›˜æ­£å¸¸ï¼Œç„¶åè¿™ä¸ªå¸¦å®½å°±ä¸å¤ªæ­£å¸¸äº†ï¼Œæˆ‘å­¦ç”Ÿæœºçš„1M/séƒ½è¶…äº†ï¼Œåº”è¯¥æ˜¯è¿™ä¸ªåŸå› å¯¼è‡´å¡çš„ã€‚\nç”¨å‘½ä»¤æ‰¾äº†è¿›ç¨‹å‘ç°å¥½åƒä¹Ÿæ²¡å“ªä¸ªå ç”¨å¾ˆå¤šå‘€ï¼Œå¼„äº†å¾ˆä¹…è¿˜æ˜¯å¾ˆè¿·æƒ‘ï¼Œæ”»å‡»è€…çš„ipä¹Ÿæ˜æ˜è¢«æˆ‘åŠ å…¥é»‘åå•äº†å‘€ï¼Œä¹‹åè¿˜å¼€äº†è…¾è®¯äº‘çš„ä¸“ä¸šæœºé˜»æ–­ï¼Œè¿˜æ˜¯å¾ˆå¡ï¼Œå¡åˆ°æˆ‘sshéƒ½è¿ä¸å¤ªä¸Šã€‚ç„¶åæœ‰ä¸ªåŠæ³•å«æˆ‘æ”¹sshçš„22ç«¯å£ï¼Œæˆ‘æ€•æ“ä½œå¤±è¯¯è¿è‡ªå·±éƒ½ç›´æ¥è¿ä¸ä¸Šå°±GGäº†ï¼Œç„¶åå°±ç®—äº†ä¸è¿™æ ·æäº†ã€‚\næœ€ååªèƒ½å±é¢ å±é¢ å»æ‰¾å®¢æœï¼Œä»–è·Ÿæˆ‘è¯´ä¹Ÿæ˜¯å…¶ä»–æ­£å¸¸å¸¦å®½è·‘æ»¡ï¼Œå«æˆ‘çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆè¿›ç¨‹å ç”¨å¾ˆå¤šï¼Œä¸»è¦æ˜¯å»ºè®®æˆ‘ä¸´æ—¶å‡çº§å¸¦å®½ã€‚\næˆ‘æƒ³ç€ï¼šå•Šå¥½å®¶ä¼™ï¼Œå¼€å§‹äº†ã€‚ä½†æ˜¯ä¹Ÿæ²¡å•¥å…¶ä»–åŠæ³•ï¼Œå°±å»ä¹°äº†3å¤©å‡çº§åˆ°3M/sçš„å¸¦å®½ï¼Œä¸è´µï¼Œç»“æœä¹Ÿæ˜¯çœŸé¦™ã€‚\nåæ¥æœ€å¤šæ‰‹åŠ¨åœ¨å®‰å…¨ç»„åŠ äº†å‡ ä¸ªå¥‡æ€ªipå°æ‰ï¼ŒæœåŠ¡å°±å®Œæˆç¨³å®šä¸‹æ¥äº†ï¼Œçœ‹æ¥æ²¡æœ‰ä»€ä¹ˆæ˜¯åŠ é’±ä¸èƒ½è§£å†³çš„ã€‚\nåæ¥è¿‡äº†ä¸¤å¤©æ”»å‡»è€…è¿˜åœ¨ç»§ç»­å†²ï¼Œé™¤äº†å½±å“æˆ‘å¸¦å®½ä¹‹å¤–å…¶å®ä¹Ÿæ²¡å¤ªå¤§é—®é¢˜åæ­£ä»–è¿›ä¸æ¥çš„ï¼Œé—®äº†å¸ˆå…„å»ºè®®è¯´æ”¹22ç«¯å£ï¼Œåæ­£é‡è¦ä½¿ç”¨æœŸä¹Ÿè¿‡äº†ï¼Œæˆ‘å°±è¯•è¯•æ”¹ä¸‹ï¼Œè¿˜çœŸæœ‰ç”¨ï¼Œå®‰å…¨æ—¥å¿—ä¹Ÿæ²¡æ”»å‡»è€…é‚£äº›ç ´è§£è®°å½•äº†ï¼Œå¸¦å®½ä¹Ÿå ç”¨ä¹Ÿå†é™äº†ï¼Œè¯´æ˜æ”»å‡»è€…ä¹Ÿæ˜¯å†²22ï¼Œè¿™ä¸‹ç›´æ¥å®Œå…¨è¢«æŒ¡ä½ï¼Œå¸¦å®½ä¹Ÿä¸å äº†ã€‚\nç¬¬ä¸€æ¬¡ä¸é»‘å®¢å¯¹çº¿è¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šçš„ï¼Œä¹ŸåŠ å¼ºäº†æˆ‘çš„å®‰å…¨é˜²èŒƒæ„è¯†\næŸ¥çœ‹ç³»ç»ŸçŠ¶æ€å‘½ä»¤ ä¸‹é¢æœ‰äº›å‘½ä»¤å·¥å…·éœ€è¦é¢å¤–å®‰è£…çš„ï¼Œç›´æ¥yum install xxxå®‰è£…å°±è¡Œ\næŸ¥çœ‹æœåŠ¡å™¨å®‰å…¨æ—¥å¿—(åŠ¨æ€å®æ—¶)(CentOS) tail -f /var/log/secure æŸ¥çœ‹CPUç­‰çš„ä½¿ç”¨æƒ…å†µ(æŒ‰è¿›ç¨‹) top æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ free -h æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ df -hl æŸ¥çœ‹ç½‘ç»œå¸¦å®½å ç”¨(æŒ‰ip) iftop -i eth0 jnettop æŒ‰Qé€€å‡º\næŸ¥çœ‹ç½‘ç»œå¸¦å®½å ç”¨(æŒ‰è¿›ç¨‹) nethogs è¿˜æœ‰é˜²ç«å¢™å·¥å…·iptableså’Œfirewall-cmd\nhttps://wangchujiang.com/linux-command/c/iptables.html\nhttps://wangchujiang.com/linux-command/c/firewall-cmd.html\nç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬å°ç¦æš´åŠ›ç ´è§£ç™»å½•çš„ip ä»å®‰å…¨æ—¥å¿—ä¸­è¯»å–è®°å½•ï¼ŒæŠŠé‚£äº›å¤šæ¬¡ç™»å½•å¤±è´¥çš„ipå†™è¿›è¯·æ±‚é»‘åå•ä¸­ï¼ˆhosts.denyï¼‰ï¼Œä½†æ˜¯è¿™ç§åŠæ³•åªæ˜¯æ‹’ç»è¿æ¥ï¼Œå¦‚æœé»‘å®¢ç»§ç»­æ”»å‡»è¿˜æ˜¯ä¼šå ç”¨å¸¦å®½\nå…ˆæ‰¾ä¸ªç›®å½•ï¼Œvimå»ºç«‹ä¸€ä¸ªè„šæœ¬æ–‡ä»¶\nvim /usr/local/secure_ssh.sh ç„¶åç¼–å†™è„šæœ¬\n#! /bin/bash cat /var/log/secure|awk \u0026#39;/Failed/{print $(NF-3)}\u0026#39;|sort|uniq -c|awk \u0026#39;{print $2\u0026#34;=\u0026#34;$1;}\u0026#39; \u0026gt; /usr/local/bin/black.txt for i in `cat /usr/local/bin/black.txt` do IP=`echo $i |awk -F= \u0026#39;{print $1}\u0026#39;` NUM=`echo $i|awk -F= \u0026#39;{print $2}\u0026#39;` result=$(cat /etc/hosts.deny | grep $IP) if [[ $NUM -gt 10 ]];then if [[ $result = \u0026#34;\u0026#34; ]];then echo \u0026#34;sshd: $IP\u0026#34; \u0026gt;\u0026gt; /etc/hosts.deny fi fi done è®¾ç½®å®šæ—¶ä»»åŠ¡\n#é¦–å…ˆæ‰“å¼€å®šæ—¶ä»»åŠ¡åˆ—è¡¨ crontab -e #æ·»åŠ ä¸‹é¢è¿™è¡Œï¼Œè¡¨ç¤ºæ¯ååˆ†é’Ÿ */10 * * * * bash /usr/local/secure_ssh.sh #ä¿å­˜é€€å‡ºåé‡å¯ä¸‹ service crond restart ä¿®æ”¹sshdçš„22ç«¯å£ è¿™ä¸ªæ–¹æ³•å¯ä»¥å®Œå…¨æŠŠå¯¹22ç«¯å£çš„æ”»å‡»ç›´æ¥æ‹’ä¹‹é—¨å¤–ï¼Œå®‰å…¨æ—¥å¿—éƒ½æ²¡è®°å½•ç ´è§£ç™»å½•äº‹ä»¶ï¼Œå¸¦å®½ä¹Ÿä¸ä¼šå½±å“ï¼Œä½†æ“ä½œè¿‡ç¨‹è¦å°å¿ƒä¸€ç‚¹ç‚¹\nä¿®æ”¹sshdé…ç½®æ–‡ä»¶\nvim /etc/ssh/sshd_config #Port 22 //è¿™è¡Œå»æ‰#å·ï¼Œç„¶ååœ¨ä¸‹é¢å¢åŠ è‡ªå·±è¦æ–°å¼€çš„ç«¯å£ï¼Œä¿è¯æ–°ç«¯å£èƒ½ç”¨å†å»æ‰è¿™è¡Œ ä¸‹é¢æ–°å¢ç«¯å£\nPort xxxxx é˜²ç«å¢™å¼€å¯å¯¹åº”ç«¯å£ï¼Œå®‰å…¨ç»„ä¹Ÿè®°å¾—å¼€ï¼Œæˆ–è€…å…ˆæŠŠé˜²ç«å¢™å…³äº†ï¼Œä¹‹åè¯•äº†æ–°ç«¯å£èƒ½ç”¨å†å¼€\nfirewall-cmd --zone=public --add-port=xxxxx/tcp --permanent\ré‡å¯sshd\n/etc/init.d/sshd restart #æˆ–è€… service sshd restart ç„¶åé‡æ–°è¿æœåŠ¡å™¨ç»ˆç«¯è¯•è¯•ï¼Œæ²¡é—®é¢˜ä¹‹åå¯ä»¥æŠŠ22ç›´æ¥ç¦æ‰ï¼Œé˜²ç«å¢™å’Œå®‰å…¨ç»„ä¹Ÿå°äº†22ï¼Œå¯¹æ–°ç«¯å£æ”¾è¡Œå°±è¡Œ\nå…¶ä»– ä½¿ç”¨å¼ºå¯†ç æˆ–è€…åªç”¨å¯†é’¥ç™»å½•\næ•°æ®åº“å¤šåšå¤‡ä»½\nå»ºç«‹å¿«ç…§\nå…³é”®æ•°æ®åŠ å¯†\nè¦å¢å¼ºå®‰å…¨æ„è¯†å‘€ï¼\n","date":"2020-11-22T22:10:00+08:00","permalink":"https://ccqstark.github.io/p/first_attack/","title":"è®°ä¸€æ¬¡æœåŠ¡å™¨è¢«æ”»å‡»"},{"content":"é—®é¢˜å¼•å…¥ä¸ç ”ç©¶ç›®æ ‡ ç›®æ ‡æ£€æµ‹çš„æ•°æ®é›†çš„æ”¶é›†å¾€å¾€æ˜¯åœ¨ç°å®åœºæ™¯ä¸­è¿›è¡Œçš„ï¼Œå› æ­¤æ•°æ®ä¸­ç›®æ ‡çš„å¤–è§‚ã€èƒŒæ™¯ã€å…‰ç…§ã€å›¾åƒè´¨é‡ç­‰æ–¹é¢çš„å·¨å¤§å·®å¼‚ä¼šå¯¼è‡´è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ä¹‹é—´å‡ºç°å·¨å¤§çš„é¢†åŸŸåç§»ã€‚æ¯”å¦‚æ±½è½¦åœ¨ä¸åŒå¤©æ°”æ¡ä»¶ä¸‹é©¾é©¶æ”¶é›†åˆ°çš„æ•°æ®ï¼Œæˆ–è€…æ˜¯ç›¸æœºçš„ç±»å‹å’Œè®¾ç½®çš„ä¸åŒä¹Ÿä¼šå¯¼è‡´æ•°æ®çš„é¢†åŸŸåç§»ã€‚è¿™æ ·çš„åç§»ä¼šå¯¼è‡´æ€§èƒ½æ˜¾è‘—ä¸‹é™ï¼Œå°½ç®¡æ”¶é›†å°½å¯èƒ½å¤šçš„æ•°æ®é›†å¯ä»¥é™ä½è¿™ç§å½±å“ï¼Œä½†æ˜¯æ³¨é‡Šè¾¹ç•Œæ¡†ä¹Ÿæ˜¯ä¸€ä¸ªè´¹æ—¶è´¹åŠ›çš„è¿‡ç¨‹ï¼Œå› æ­¤å¼€å‘ä¸€ä¸ªæ–°çš„ç®—æ³•æ¥åº”å¯¹è·¨é¢†åŸŸç›®æ ‡æ£€æµ‹é—®é¢˜å°±å°¤ä¸ºé‡è¦ã€‚\nè®ºæ–‡ä¸­æ–¹æ³•é€‚ç”¨äºæ— ç›‘ç£åœºæ™¯ï¼Œåœ¨æºåŸŸæœ‰å®Œæ•´çš„ç›‘ç£ï¼Œè€Œåœ¨ç›®æ ‡åŸŸæ²¡æœ‰ç›‘ç£ã€‚è¿™æ ·å°±å¯ä»¥ä¸å¢åŠ äººå·¥æ ‡æ³¨æˆæœ¬çš„å‰æä¸‹å‡å°‘è·¨åŸŸå¯¹ç›®æ ‡æ£€æµ‹æ•ˆç‡çš„å½±å“ã€‚\nå…³é”®æœ¯è¯­ä»‹ç» ç›®æ ‡æ£€æµ‹ Object Detection ç›®æ ‡æ£€æµ‹ï¼Œä¹Ÿå«ç›®æ ‡æå–ï¼Œæ˜¯ä¸€ç§åŸºäºç›®æ ‡å‡ ä½•å’Œç»Ÿè®¡ç‰¹å¾çš„å›¾åƒåˆ†å‰²ï¼Œå®ƒå°†ç›®æ ‡çš„åˆ†å‰²å’Œè¯†åˆ«åˆäºŒä¸ºä¸€ï¼Œå…¶å‡†ç¡®æ€§å’Œå®æ—¶æ€§æ˜¯æ•´ä¸ªç³»ç»Ÿçš„ä¸€é¡¹é‡è¦èƒ½åŠ›ã€‚å°¤å…¶æ˜¯åœ¨å¤æ‚åœºæ™¯ä¸­ï¼Œéœ€è¦å¯¹å¤šä¸ªç›®æ ‡è¿›è¡Œå®æ—¶å¤„ç†æ—¶ï¼Œç›®æ ‡è‡ªåŠ¨æå–å’Œè¯†åˆ«å°±æ˜¾å¾—ç‰¹åˆ«é‡è¦ã€‚ç›®æ ‡æ£€æµ‹ä¸»è¦æœ‰ä¸‰ä¸ªå±‚æ¬¡ï¼š\nä¸€æ˜¯åˆ†ç±»ï¼ˆClassificationï¼‰ï¼Œå³æ˜¯å°†å›¾åƒç»“æ„åŒ–ä¸ºæŸä¸€ç±»åˆ«çš„ä¿¡æ¯ï¼Œç”¨äº‹å…ˆç¡®å®šå¥½çš„ç±»åˆ«(string)æˆ–å®ä¾‹IDæ¥æè¿°å›¾ç‰‡ã€‚è¿™ä¸€ä»»åŠ¡æ˜¯æœ€ç®€å•ã€æœ€åŸºç¡€çš„å›¾åƒç†è§£ä»»åŠ¡ï¼Œä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹æœ€å…ˆå–å¾—çªç ´å’Œå®ç°å¤§è§„æ¨¡åº”ç”¨çš„ä»»åŠ¡ã€‚å…¶ä¸­ï¼ŒImageNetæ˜¯æœ€æƒå¨çš„è¯„æµ‹é›†ï¼Œæ¯å¹´çš„ILSVRCå‚¬ç”Ÿäº†å¤§é‡çš„ä¼˜ç§€æ·±åº¦ç½‘ç»œç»“æ„ï¼Œä¸ºå…¶ä»–ä»»åŠ¡æä¾›äº†åŸºç¡€ã€‚åœ¨åº”ç”¨é¢†åŸŸï¼Œäººè„¸ã€åœºæ™¯çš„è¯†åˆ«ç­‰éƒ½å¯ä»¥å½’ä¸ºåˆ†ç±»ä»»åŠ¡ã€‚\näºŒæ˜¯æ£€æµ‹ï¼ˆDetectionï¼‰ã€‚åˆ†ç±»ä»»åŠ¡å…³å¿ƒæ•´ä½“ï¼Œç»™å‡ºçš„æ˜¯æ•´å¼ å›¾ç‰‡çš„å†…å®¹æè¿°ï¼Œè€Œæ£€æµ‹åˆ™å…³æ³¨ç‰¹å®šçš„ç‰©ä½“ç›®æ ‡ï¼Œè¦æ±‚åŒæ—¶è·å¾—è¿™ä¸€ç›®æ ‡çš„ç±»åˆ«ä¿¡æ¯å’Œä½ç½®ä¿¡æ¯ã€‚ç›¸æ¯”åˆ†ç±»ï¼Œæ£€æµ‹ç»™å‡ºçš„æ˜¯å¯¹å›¾ç‰‡å‰æ™¯å’ŒèƒŒæ™¯çš„ç†è§£ï¼Œæˆ‘ä»¬éœ€è¦ä»èƒŒæ™¯ä¸­åˆ†ç¦»å‡ºæ„Ÿå…´è¶£çš„ç›®æ ‡ï¼Œå¹¶ç¡®å®šè¿™ä¸€ç›®æ ‡çš„æè¿°ï¼ˆç±»åˆ«å’Œä½ç½®ï¼‰ï¼Œå› è€Œï¼Œæ£€æµ‹æ¨¡å‹çš„è¾“å‡ºæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨çš„æ¯ä¸€é¡¹ä½¿ç”¨ä¸€ä¸ªæ•°æ®ç»„ç»™å‡ºæ£€å‡ºç›®æ ‡çš„ç±»åˆ«å’Œä½ç½®ï¼ˆå¸¸ç”¨çŸ©å½¢æ£€æµ‹æ¡†çš„åæ ‡è¡¨ç¤ºï¼‰ã€‚\nä¸‰æ˜¯åˆ†å‰²ï¼ˆSegmentationï¼‰ã€‚åˆ†å‰²åŒ…æ‹¬è¯­ä¹‰åˆ†å‰²ï¼ˆsemantic segmentationï¼‰å’Œå®ä¾‹åˆ†å‰²ï¼ˆinstance segmentationï¼‰ï¼Œå‰è€…æ˜¯å¯¹å‰èƒŒæ™¯åˆ†ç¦»çš„æ‹“å±•ï¼Œè¦æ±‚åˆ†ç¦»å¼€å…·æœ‰ä¸åŒè¯­ä¹‰çš„å›¾åƒéƒ¨åˆ†ï¼Œè€Œåè€…æ˜¯æ£€æµ‹ä»»åŠ¡çš„æ‹“å±•ï¼Œè¦æ±‚æè¿°å‡ºç›®æ ‡çš„è½®å»“ï¼ˆç›¸æ¯”æ£€æµ‹æ¡†æ›´ä¸ºç²¾ç»†ï¼‰ã€‚åˆ†å‰²æ˜¯å¯¹å›¾åƒçš„åƒç´ çº§æè¿°ï¼Œå®ƒèµ‹äºˆæ¯ä¸ªåƒç´ ç±»åˆ«ï¼ˆå®ä¾‹ï¼‰æ„ä¹‰ï¼Œé€‚ç”¨äºç†è§£è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼Œå¦‚æ— äººé©¾é©¶ä¸­å¯¹é“è·¯å’Œéé“è·¯çš„åˆ†å‰²ã€‚\né¢†åŸŸè‡ªé€‚åº” Domain Adaptation é¢†åŸŸè‡ªé€‚åº”ï¼ˆDomain Adaptationï¼‰æ˜¯è¿ç§»å­¦ä¹ ä¸­çš„ä¸€ç§ä»£è¡¨æ€§æ–¹æ³•ï¼ŒæŒ‡çš„æ˜¯åˆ©ç”¨ä¿¡æ¯ä¸°å¯Œçš„æºåŸŸæ ·æœ¬æ¥æå‡ç›®æ ‡åŸŸæ¨¡å‹çš„æ€§èƒ½ã€‚ é¢†åŸŸè‡ªé€‚åº”é—®é¢˜ä¸­ä¸¤ä¸ªè‡³å…³é‡è¦çš„æ¦‚å¿µï¼š\næºåŸŸï¼ˆsource domainï¼‰è¡¨ç¤ºä¸æµ‹è¯•æ ·æœ¬ä¸åŒçš„é¢†åŸŸï¼Œä½†æ˜¯æœ‰ä¸°å¯Œçš„ç›‘ç£ä¿¡æ¯\nç›®æ ‡åŸŸï¼ˆtarget domainï¼‰è¡¨ç¤ºæµ‹è¯•æ ·æœ¬æ‰€åœ¨çš„é¢†åŸŸï¼Œæ— æ ‡ç­¾æˆ–è€…åªæœ‰å°‘é‡æ ‡ç­¾ã€‚æºåŸŸå’Œç›®æ ‡åŸŸå¾€å¾€å±äºåŒä¸€ç±»ä»»åŠ¡ï¼Œä½†æ˜¯åˆ†å¸ƒä¸åŒ\næ ¹æ®ç›®æ ‡åŸŸå’ŒæºåŸŸçš„ä¸åŒç±»å‹ï¼Œé¢†åŸŸè‡ªé€‚åº”é—®é¢˜æœ‰å››ç±»ä¸åŒçš„åœºæ™¯ï¼šæ— ç›‘ç£çš„ï¼Œæœ‰ç›‘ç£çš„ï¼Œå¼‚æ„åˆ†å¸ƒå’Œå¤šä¸ªæºåŸŸé—®é¢˜ã€‚ é€šè¿‡åœ¨ä¸åŒé˜¶æ®µè¿›è¡Œé¢†åŸŸè‡ªé€‚åº”ï¼Œç ”ç©¶è€…æå‡ºäº†ä¸‰ç§ä¸åŒçš„é¢†åŸŸè‡ªé€‚åº”æ–¹æ³•ï¼š\n1ï¼‰æ ·æœ¬è‡ªé€‚åº”ï¼Œå¯¹æºåŸŸæ ·æœ¬è¿›è¡ŒåŠ æƒé‡é‡‡æ ·ï¼Œä»è€Œé€¼è¿‘ç›®æ ‡åŸŸçš„åˆ†å¸ƒã€‚\n2ï¼‰ç‰¹å¾å±‚é¢è‡ªé€‚åº”ï¼Œå°†æºåŸŸå’Œç›®æ ‡åŸŸæŠ•å½±åˆ°å…¬å…±ç‰¹å¾å­ç©ºé—´ã€‚\n3ï¼‰æ¨¡å‹å±‚é¢è‡ªé€‚åº”ï¼Œå¯¹æºåŸŸè¯¯å·®å‡½æ•°è¿›è¡Œä¿®æ”¹ï¼Œè€ƒè™‘ç›®æ ‡åŸŸçš„è¯¯å·®ã€‚\næ•£åº¦ Divergence åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦ç”¨ä¸€ä¸ªåˆ†å¸ƒQå»é€¼è¿‘ä¸€ä¸ªç›®æ ‡åˆ†å¸ƒPï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿæ‰¾åˆ°ä¸€ä¸ªç›®æ ‡å‡½æ•°D ( Q , P ) D( Q,P)D(Q,P)ï¼Œè®¡ç®—Qåˆ°Pçš„è·ç¦»ã€‚è€Œè¿™ä¸€ä¸ªç›®æ ‡å‡½æ•°ï¼Œæ­£æ˜¯Divergence(æ•£åº¦)ï¼Œæ¯”å¦‚å¸¸è§çš„KL-Divergenceï¼ŒJS-Divergenceç­‰ç­‰ã€‚é€šè¿‡è¿™ä¸ªæ•£åº¦çš„è®¡ç®—æˆ‘ä»¬å°±èƒ½ä¸æ–­åœ°å»ä¼˜åŒ–æˆ‘ä»¬çš„Qï¼Œå¯»æ‰¾ä¸€ä¸ªæœ€ä¼˜çš„å‚æ•°å»é€¼è¿‘çœŸå®çš„åˆ†å¸ƒPã€‚\nFaster R-CNN Faster R-CNNæ˜¯ä½•å‡¯æ˜ç­‰å¤§ç¥åœ¨2015å¹´æå‡ºç›®æ ‡æ£€æµ‹ç®—æ³•ï¼Œè¯¥ç®—æ³•åœ¨2015å¹´çš„ILSVRVå’ŒCOCOç«èµ›ä¸­è·å¾—å¤šé¡¹ç¬¬ä¸€ã€‚è¯¥ç®—æ³•åœ¨Fast R-CNNåŸºç¡€ä¸Šæå‡ºäº†RPNå€™é€‰æ¡†ç”Ÿæˆç®—æ³•ï¼Œä½¿å¾—ç›®æ ‡æ£€æµ‹é€Ÿåº¦å¤§å¤§æé«˜ã€‚\n \n \nFaster-RCNNç”±ä¸‹é¢å‡ éƒ¨åˆ†ç»„æˆï¼š\n  æ•°æ®é›†ï¼Œimage input\n  å·ç§¯å±‚CNNç­‰åŸºç¡€ç½‘ç»œï¼Œæå–ç‰¹å¾å¾—åˆ°feature map\n  RPNå±‚ï¼Œå†åœ¨ç»è¿‡å·ç§¯å±‚æå–åˆ°çš„feature mapä¸Šç”¨ä¸€ä¸ª3x3çš„slide windowï¼Œå»éå†æ•´ä¸ªfeature map,åœ¨éå†è¿‡ç¨‹ä¸­æ¯ä¸ªwindowä¸­å¿ƒæŒ‰rateï¼Œscaleï¼ˆ1:2,1:1,2:1ï¼‰ç”Ÿæˆ9ä¸ªanchorsï¼Œç„¶åå†åˆ©ç”¨å…¨è¿æ¥å¯¹æ¯ä¸ªanchorsåšäºŒåˆ†ç±»ï¼ˆæ˜¯å‰æ™¯è¿˜æ˜¯èƒŒæ™¯ï¼‰å’Œåˆæ­¥bbox regressionï¼Œæœ€åè¾“å‡ºæ¯”è¾ƒç²¾ç¡®çš„300ä¸ªROIsã€‚ æŠŠç»è¿‡å·ç§¯å±‚feature mapç”¨ROI poolingå›ºå®šå…¨è¿æ¥å±‚çš„è¾“å…¥ç»´åº¦ã€‚\n  ç„¶åæŠŠç»è¿‡RPNè¾“å‡ºçš„roisæ˜ å°„åˆ°ROIpoolingçš„feature mapä¸Šè¿›è¡Œbboxå›å½’å’Œåˆ†ç±»ã€‚\n  äº¤å‰ç†µ cross entropy äº¤å‰ç†µæè¿°äº†ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå½“äº¤å‰ç†µè¶Šå°è¯´æ˜äºŒè€…ä¹‹é—´è¶Šæ¥è¿‘ã€‚\nåœ¨ä¿¡æ¯è®ºä¸­ï¼ŒåŸºäºç›¸åŒäº‹ä»¶æµ‹åº¦çš„ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„äº¤å‰ç†µæ˜¯æŒ‡ï¼Œå½“åŸºäºä¸€ä¸ªâ€œéè‡ªç„¶â€ï¼ˆç›¸å¯¹äºâ€œçœŸå®â€åˆ†å¸ƒè€Œè¨€ï¼‰çš„æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œç¼–ç æ—¶ï¼Œåœ¨äº‹ä»¶é›†åˆä¸­å”¯ä¸€æ ‡è¯†ä¸€ä¸ªäº‹ä»¶æ‰€éœ€è¦çš„å¹³å‡æ¯”ç‰¹æ•°ã€‚\næ¢¯åº¦ä¸‹é™ gradient descent åœ¨æœºå™¨å­¦ä¹ ç®—æ³•ä¸­ï¼Œåœ¨æœ€å°åŒ–æŸå¤±å‡½æ•°æ—¶ï¼Œå¯ä»¥é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ¥ä¸€æ­¥æ­¥çš„è¿­ä»£æ±‚è§£ï¼Œå¾—åˆ°æœ€å°åŒ–çš„æŸå¤±å‡½æ•°ï¼Œå’Œæ¨¡å‹å‚æ•°å€¼ã€‚\næ¢¯åº¦ä¸‹é™åœ¨æœºå™¨å­¦ä¹ ä¸­åº”ç”¨ååˆ†çš„å¹¿æ³›ï¼Œä¸è®ºæ˜¯åœ¨çº¿æ€§å›å½’è¿˜æ˜¯Logisticå›å½’ä¸­ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯é€šè¿‡è¿­ä»£æ‰¾åˆ°ç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ï¼Œæˆ–è€…æ”¶æ•›åˆ°æœ€å°å€¼ã€‚\n \nåŸºæœ¬æ€è·¯ è®ºæ–‡ä¸­ä¸ºäº†è§£å†³åŸŸåç§»é—®é¢˜ï¼Œåœ¨Faster R-CNNæ¨¡å‹ä¸­åŠ å…¥äº†å›¾åƒçº§å’Œå®ä¾‹çº§çš„ä¸¤ä¸ªåŸŸé€‚åº”ç»„ä»¶ï¼Œä»è€Œæ¥æœ€å°åŒ–ä¸¤ä¸ªåŸŸä¹‹é—´çš„hæ•£åº¦ã€‚åœ¨æ¯ä¸ªç»„ä»¶ä¸­ï¼Œè®­ç»ƒä¸€ä¸ªé¢†åŸŸåˆ†ç±»å™¨ï¼Œå¹¶ä½¿ç”¨å¯¹æŠ—æ€§è®­ç»ƒç­–ç•¥æ¥å­¦ä¹ é¢†åŸŸä¸å˜é‡çš„é²æ£’ç‰¹å¾ã€‚å¹¶ä¸”è¿›ä¸€æ­¥æ•´åˆä¸åŒå±‚æ¬¡çš„åŸŸåˆ†ç±»å™¨ä¹‹é—´çš„ä¸€è‡´æ€§è§„åˆ™ï¼Œåœ¨Faster R-CNNæ¨¡å‹ä¸­å­¦ä¹ ä¸€ä¸ªåŸŸä¸å˜åŒºåŸŸå»ºè®®ç½‘ç»œ(RPN)ã€‚\nç ”ç©¶æˆæœ   ä»æ¦‚ç‡çš„è§’åº¦å¯¹è·¨åŸŸç›®æ ‡æ£€æµ‹çš„åŸŸç§»é—®é¢˜è¿›è¡Œäº†ç†è®ºåˆ†æã€‚\n  è®¾è®¡äº†ä¸¤ä¸ªåŸŸè‡ªé€‚åº”ç»„ä»¶ï¼Œä»¥ç¼“è§£å›¾åƒçº§å’Œå®ä¾‹çº§çš„åŸŸå·®å¼‚ã€‚\n  è¿›ä¸€æ­¥æå‡ºäº†ä¸€è‡´æ€§æ­£åˆ™åŒ–ï¼Œä»¥ä¿ƒè¿›RPNå˜æˆé¢†åŸŸä¸å˜çš„ã€‚\n  å°†æå‡ºçš„ç»„ä»¶é›†æˆåˆ°Faster R-CNNæ¨¡å‹ä¸­ï¼Œå¾—åˆ°çš„ç³»ç»Ÿå¯ä»¥ä»¥ç«¯åˆ°ç«¯çš„æ–¹å¼è¿›è¡Œè®­ç»ƒã€‚\n  ä¸ç”¨äºåˆ†ç±»çš„é¢†åŸŸé€‚åº”ç ”ç©¶ç›¸æ¯”ï¼Œå…¶ä»–è®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„é¢†åŸŸé€‚åº”ç ”ç©¶è¾ƒå°‘ã€‚è¿‘å¹´æ¥åœ¨è¯­ä¹‰åˆ†å‰²ã€ç²¾ç»†è¯†åˆ«ç­‰æ–¹é¢è¿›è¡Œäº†ç ”ç©¶ã€‚å¯¹äºæ£€æµ‹ä»»åŠ¡ï¼Œæå‡ºé€šè¿‡å¼•å…¥è‡ªé€‚åº”æ”¯æŒå‘é‡æœºæ¥ç¼“è§£å¯å˜å½¢é›¶ä»¶æ¨¡å‹(DPM)çš„åŸŸæ¼‚ç§»é—®é¢˜ã€‚åœ¨è¿‘æœŸçš„ç ”ç©¶ä¸­ï¼Œå…¶ä»–ç ”ç©¶è€…ä½¿ç”¨R-CNNæ¨¡å‹ä½œä¸ºç‰¹å¾æå–å™¨ï¼Œç„¶åç”¨å­ç©ºé—´å¯¹é½æ–¹æ³•å¯¹ç‰¹å¾è¿›è¡Œå¯¹é½ã€‚ä¹Ÿæœ‰ä»å…¶ä»–æ¥æºå­¦ä¹ æ¢æµ‹å™¨çš„å·¥ä½œï¼Œä¾‹å¦‚ä»å›¾åƒåˆ°è§†é¢‘ï¼Œä»3Dæ¨¡å‹ï¼Œæˆ–è€…ä»åˆæˆæ¨¡å‹ã€‚ä»¥å‰çš„å·¥ä½œè¦ä¹ˆä¸èƒ½ä»¥ç«¯åˆ°ç«¯çš„æ–¹å¼è¿›è¡ŒåŸ¹è®­ï¼Œè¦ä¹ˆä¾§é‡äºç‰¹å®šçš„æ¡ˆä¾‹ã€‚åœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œè®ºæ–‡ä½œè€…å»ºç«‹äº†ä¸€ä¸ªç”¨äºç›®æ ‡æ£€æµ‹çš„ç«¯åˆ°ç«¯çš„å¯è®­ç»ƒæ¨¡å‹ï¼Œä¹Ÿæ˜¯ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªã€‚\né¢†åŸŸé€‚åº”ç»„ä»¶ Domain Adaptation Components æ˜ åƒçº§åˆ«é€‚åº” Image-Level Adaptation åœ¨Faster R-CNNæ¨¡å‹ä¸­ï¼ŒæŒ‡çš„åŠŸèƒ½æ˜ å°„è¾“å‡ºæ˜ åƒçº§åˆ«è¡¨ç¤ºåŸºæœ¬å·ç§¯çš„å±‚ã€‚æ¶ˆé™¤åŸŸåˆ†å¸ƒä¸åŒ¹é…åœ¨å›¾åƒå±‚æ¬¡,é‡‡ç”¨patch-basedåŸŸåˆ†ç±»å™¨ã€‚\nè¿™ç§é€‰æ‹©çš„å¥½å¤„:\n å¯¹é½å›¾åƒçº§è¡¨ç¤ºé€šå¸¸æœ‰åŠ©äºå‡å°‘ç”±å…¨å±€å›¾åƒå·®å¼‚å¼•èµ·çš„ä½ç§»ï¼Œå¦‚å›¾åƒé£æ ¼ã€å›¾åƒå°ºåº¦ã€å…‰ç…§ç­‰ã€‚ç±»ä¼¼çš„åŸºäºå—çš„æŸå¤±åœ¨æœ€è¿‘çš„å…³äºstyle transferçš„å·¥ä½œä¸­ä¹Ÿè¢«è¯æ˜æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒä¹Ÿå¤„ç†å…¨å±€å˜æ¢ ç”±äºä½¿ç”¨äº†é«˜åˆ†è¾¨ç‡çš„è¾“å…¥ï¼Œå¯¹äºè®­ç»ƒä¸€ä¸ªç›®æ ‡æ£€æµ‹ç½‘ç»œæ¥è¯´ï¼Œæ‰¹å¤„ç†çš„å¤§å°é€šå¸¸éå¸¸å°ã€‚è¿™ç§åŸºäºå—çš„è®¾è®¡æœ‰åŠ©äºå¢åŠ è®­ç»ƒé¢†åŸŸåˆ†ç±»å™¨çš„è®­ç»ƒæ ·æœ¬çš„æ•°é‡ã€‚  ç”¨Diè¡¨ç¤ºç¬¬iä¸ªè®­ç»ƒå›¾åƒçš„å®šä¹‰åŸŸæ ‡ç­¾ï¼ŒæºåŸŸçš„Di= 0ï¼Œç›®æ ‡åŸŸçš„Di= 1ã€‚å°†ç»è¿‡åŸºå·ç§¯å±‚åçš„ç¬¬iå¹…å›¾åƒçš„feature mapä½äº(u, v)å¤„çš„æ¿€æ´»è¡¨ç¤ºä¸ºÏ†u,v(Ii)ã€‚å°†åŸŸåˆ†ç±»å™¨çš„è¾“å‡ºè¡¨ç¤ºä¸ºpi(u,v)ï¼Œåˆ©ç”¨äº¤å‰ç†µæŸå¤±ï¼Œå›¾åƒçº§è‡ªé€‚åº”æŸå¤±å¯è¡¨ç¤ºä¸º:\n \nå®ä¾‹çº§é€‚åº” Instance-Level Adaptation å®ä¾‹çº§è¡¨ç¤ºæ˜¯æŒ‡åœ¨è¾“å…¥åˆ°æœ€ç»ˆçš„ç±»åˆ«åˆ†ç±»å™¨ä¹‹å‰åŸºäºROIçš„ç‰¹å¾å‘é‡\nå¯¹é½å®ä¾‹çº§è¡¨ç¤ºæœ‰åŠ©äºå‡å°‘æœ¬åœ°å®ä¾‹å·®å¼‚ï¼Œå¦‚å¯¹è±¡å¤–è§‚ã€å¤§å°ã€è§†ç‚¹ç­‰ã€‚ä¸å›¾åƒçº§è‡ªé€‚åº”ç›¸ä¼¼ï¼Œç ”ç©¶è€…è®­ç»ƒäº†ä¸€ä¸ªé’ˆå¯¹ç‰¹å¾å‘é‡çš„é¢†åŸŸåˆ†ç±»å™¨æ¥å¯¹é½å®ä¾‹çº§åˆ†å¸ƒã€‚\nå°†ç¬¬iå¹…å›¾åƒä¸­ç¬¬jä¸ªåŒºåŸŸå»ºè®®çš„å®ä¾‹çº§åŸŸåˆ†ç±»å™¨çš„è¾“å‡ºè¡¨ç¤ºä¸ºpi,jã€‚å®ä¾‹çº§é€‚åº”æŸå¤±ç°åœ¨å¯ä»¥å†™æˆ:\n \nä¸€è‡´æ€§æ­£è§„åŒ– Consistency Regularization åŠ å¼ºä¸åŒå±‚æ¬¡çš„åŸŸåˆ†ç±»å™¨ä¹‹é—´çš„ä¸€è‡´æ€§æœ‰åŠ©äºå­¦ä¹ è¾¹ç•Œç›’é¢„æµ‹å™¨(å³Faster R-CNNæ¨¡å‹ä¸­çš„RPN)çš„è·¨åŸŸé²æ£’æ€§ã€‚å› æ­¤ï¼Œç ”ç©¶è€…è¿›ä¸€æ­¥è®¾ç½®äº†ä¸€ä¸ªä¸€è‡´æ€§è§„åˆ™ã€‚ç”±äºå›¾åƒçº§åŸŸåˆ†ç±»å™¨ä¼šä¸ºå›¾åƒçº§è¡¨ç¤ºçš„æ¯æ¬¡æ¿€æ´»ç”Ÿæˆä¸€ä¸ªè¾“å‡ºï¼Œå› æ­¤å–å›¾åƒä¸­æ‰€æœ‰æ¿€æ´»çš„å¹³å‡å€¼ä½œä¸ºå…¶å›¾åƒçº§æ¦‚ç‡ã€‚ä¸€è‡´æ€§è°ƒèŠ‚å™¨å¯ä»¥å†™æˆ:\n \nç½‘ç»œæ¦‚è¿° Faster R-CNNä¸2ä¸ªç»„ä»¶ä¹‹é—´çš„æ•´åˆå…³ç³»å¦‚ä¸‹å›¾ï¼š\n \nåœ¨æ¯ä¸€å±‚ä¸Šæ„å»ºä¸€ä¸ªé¢†åŸŸåˆ†ç±»å™¨ï¼Œä»¥ä¸€ç§å¯¹æŠ—æ€§çš„è®­ç»ƒæ–¹å¼è¿›è¡Œè®­ç»ƒã€‚åœ¨è¿™ä¸¤ä¸ªåˆ†ç±»å™¨ä¸­åŠ å…¥äº†ä¸€è‡´æ€§è§„åˆ™å™¨ï¼Œä»¥å­¦ä¹ ç”¨äºFaster R-CNNæ¨¡å‹çš„é¢†åŸŸä¸å˜RPNã€‚\nå·¦è¾¹éƒ¨åˆ†æ˜¯åŸå§‹çš„Faster R-CNNæ¨¡å‹ã€‚åº•å±‚çš„å·ç§¯å±‚åœ¨æ‰€æœ‰ç»„ä»¶ä¹‹é—´å…±äº«ã€‚ç„¶ååœ¨å…¶ä¸Šæ„å»ºRPNå’ŒROIæ± åŒ–å±‚ï¼Œç„¶åæ„å»ºä¸¤ä¸ªå®Œå…¨è¿æ¥çš„å±‚æ¥æå–å®ä¾‹çº§ç‰¹å¾ã€‚\nä»åˆæˆæ•°æ®ä¸­å­¦ä¹  éšç€è®¡ç®—æœºå›¾å½¢æŠ€æœ¯çš„å‘å±•ï¼Œåˆ©ç”¨åˆæˆæ•°æ®è®­ç»ƒCNNå˜å¾—è¶Šæ¥è¶Šæµè¡Œã€‚å°½ç®¡å¦‚æ­¤ï¼Œåˆæˆçš„æ•°æ®ä¸çœŸå®ä¸–ç•Œçš„å›¾åƒä»ç„¶æœ‰æ˜æ˜¾çš„è§†è§‰å·®å¼‚ï¼Œå¹¶ä¸”é€šå¸¸ä¸åœ¨çœŸå®æ•°æ®ä¸Šè®­ç»ƒçš„æ¨¡å‹å­˜åœ¨æ€§èƒ½å·®è·ã€‚ç ”ç©¶è€…ç”¨ä¸åŒäºçœŸå®ä¸–ç•Œçš„åˆæˆæ•°æ®è¿›è¡Œè¯•éªŒã€‚\næ•°æ®é›†:æ˜¯SIM 10kç”±10000å¼ ç”±ä¾ ç›—çŒè½¦æ‰‹(GTA5)æ¸²æŸ“çš„å›¾åƒç»„æˆï¼Œåœ¨SIM 10kä¸­ï¼Œ10000å¼ è®­ç»ƒå›¾åƒä¸­æä¾›äº†58,701è¾†è½¦çš„åŒ…å›´æ¡†ã€‚æ‰€æœ‰çš„å›¾åƒéƒ½åœ¨è®­ç»ƒä¸­ä½¿ç”¨ã€‚Cityscapesæ•°æ®é›†æ˜¯ä¸€ä¸ªåŸå¸‚åœºæ™¯æ•°æ®é›†ä¸ºé©¾é©¶åœºæ™¯ã€‚è¿™äº›å›¾åƒæ˜¯ç”±è½¦è½½æ‘„åƒæœºæ‹æ‘„çš„ã€‚2975å›¾åƒè®­ç»ƒé›†,500å›¾åƒéªŒè¯é›†ã€‚ä½¿ç”¨çš„æ ‡è®°å›¾åƒè®­ç»ƒé›†ä½œä¸ºç›®æ ‡åŸŸé€‚åº”æˆ‘ä»¬çš„æ£€æµ‹å™¨, å¹¶æŠ¥å‘Šç»“æœéªŒè¯é›†ã€‚\nç»“æœï¼šä¸åŒæ–¹æ³•çš„ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚å…·ä½“æ¥è¯´ï¼Œä¸Faster R-CNNç›¸æ¯”ï¼Œä»…ä½¿ç”¨å›¾åƒçº§è‡ªé€‚åº”ç»„ä»¶è·å¾—+2.9%çš„æ€§èƒ½æå‡ï¼Œè€Œä»…ä½¿ç”¨å®ä¾‹çº§å¯¹é½ç»„ä»¶è·å¾—+5.6%çš„æ€§èƒ½æå‡ã€‚è¿™è¡¨æ˜ï¼Œå›¾åƒçº§é€‚åº”å’Œå®ä¾‹çº§é€‚åº”ç»„ä»¶å¯ä»¥æœ‰æ•ˆåœ°å‡å°‘å„å±‚æ¬¡ä¸Šçš„åŸŸæ¼‚ç§»ã€‚å°†è¿™ä¸¤ä¸ªéƒ¨åˆ†ç»“åˆåœ¨ä¸€èµ·å¯ä»¥å¾—åˆ°7.7%çš„æ”¹è¿›ï¼Œè¿™éªŒè¯äº†å…³äºå‡å°‘ä¸¤å±‚åŸŸç§»ä½çš„å¿…è¦æ€§çš„çŒœæƒ³ã€‚é€šè¿‡è¿›ä¸€æ­¥åº”ç”¨ä¸€è‡´æ€§æ­£åˆ™åŒ–ï¼ŒåŸŸè‡ªé€‚åº”Faster R-CNNæ¨¡å‹å°†æ›´å¿«çš„R-CNNæ¨¡å‹æé«˜äº†+8.8%ã€‚\n \nå…¶å®ƒ ä¸ºäº†éªŒè¯æ¨¡å‹çš„æ•ˆæœï¼Œç ”ç©¶è€…è¿˜é€šè¿‡æ¶åŠ£å¤©æ°”ä¸­æ”¶é›†çš„å›¾åƒæ•°æ®ã€ä¸åŒæ‘„åƒæœºæ‹æ‘„å‡ºæ¥çš„å›¾åƒæ•°æ®å¯¹ç®—æ³•è¿›è¡Œæµ‹è¯•ï¼Œç»“æœéƒ½æ˜¾ç¤ºå‡ºä¸é”™çš„ç»“æœ\nè¿˜è¿›ä¸€æ­¥åˆ†æäº†å›¾åƒçº§å’Œå®ä¾‹çº§é€‚åº”çš„å½±å“ï¼Œåšäº†æœ‰å…³äºå›¾åƒçº§å’Œå®ä¾‹çº§å¯¹é½çš„å®éªŒï¼ŒéªŒè¯äº†æ¨¡å‹å¯ä»¥ä»æ›´é«˜åˆ†è¾¨ç‡çš„å›¾åƒè¾“å…¥ä¸­è·å¾—æ›´å¥½çš„æ€§èƒ½ç»“æœã€‚å®éªŒç»“è®ºæ˜¯ä»200åƒç´ å¢åŠ åˆ°1000åƒç´ ã€‚\nè¿˜åšäº†å®éªŒç ”ç©¶äº†ä½¿ç”¨ä¸€è‡´æ€§æ­£åˆ™åŒ–å‰åRPNçš„æ€§èƒ½ï¼Œå‘ç°RPNçš„æ€§èƒ½å¯ä»¥è¿›ä¸€æ­¥æé«˜åˆ°30.3%ï¼Œè¯´æ˜ä¸€è‡´æ€§è°ƒèŠ‚å™¨æé«˜äº†RPNçš„é²æ£’æ€§ã€‚\n","date":"2020-11-22T22:07:00+08:00","permalink":"https://ccqstark.github.io/p/ml_domain_adaptation/","title":"[æœºå™¨å­¦ä¹ è®ºæ–‡]Domain Adaptive Faster R-CNN for Object Detection in the Wild"},{"content":"é—®é¢˜ è®¾Aå’ŒBæ˜¯2ä¸ªå­—ç¬¦ä¸²ã€‚è¦ç”¨æœ€å°‘çš„å­—ç¬¦æ“ä½œå°†å­—ç¬¦ä¸²Aè½¬æ¢ä¸ºå­—ç¬¦ä¸²Bã€‚è¿™é‡Œæ‰€è¯´çš„å­—ç¬¦æ“ä½œåŒ…æ‹¬ (1)åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼› (2)æ’å…¥ä¸€ä¸ªå­—ç¬¦ï¼› (3)å°†ä¸€ä¸ªå­—ç¬¦æ”¹ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ã€‚ å°†å­—ç¬¦ä¸²Aå˜æ¢ä¸ºå­—ç¬¦ä¸²Bæ‰€ç”¨çš„æœ€å°‘å­—ç¬¦æ“ä½œæ•°ç§°ä¸ºå­—ç¬¦ä¸²Aåˆ° Bçš„ç¼–è¾‘è·ç¦»ï¼Œè®°ä¸ºd(A,B)ã€‚ å¯¹äºç»™å®šçš„å­—ç¬¦ä¸²Aå’Œå­—ç¬¦ä¸²Bï¼Œè®¡ç®—å…¶ç¼–è¾‘è·ç¦» d(A,B)ã€‚\nè¾“å…¥æ ¼å¼: ç¬¬ä¸€è¡Œæ˜¯å­—ç¬¦ä¸²Aï¼Œæ–‡ä»¶çš„ç¬¬äºŒè¡Œæ˜¯å­—ç¬¦ä¸²Bã€‚\næç¤ºï¼šå­—ç¬¦ä¸²é•¿åº¦ä¸è¶…è¿‡2000ä¸ªå­—ç¬¦ã€‚\nè¾“å‡ºæ ¼å¼: è¾“å‡ºç¼–è¾‘è·ç¦»d(A,B)\nè¾“å…¥æ ·ä¾‹: åœ¨è¿™é‡Œç»™å‡ºä¸€ç»„è¾“å…¥ã€‚ä¾‹å¦‚ï¼š\nfxpimu\rxwrs è¾“å‡ºæ ·ä¾‹: åœ¨è¿™é‡Œç»™å‡ºç›¸åº”çš„è¾“å‡ºã€‚ä¾‹å¦‚ï¼š\n5\ræ€è·¯ ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•å¯ä»¥å°†é—®é¢˜åˆ†è§£å‡ºæœ€ä¼˜å­ç»“æ„ã€‚\nè®¾dp[i][j]è¡¨ç¤ºæŠŠAå­—ç¬¦ä¸²å‰iä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²è½¬å˜ä¸ºBå­—ç¬¦ä¸²å‰jä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²æ‰€éœ€çš„æœ€å°‘çš„å­—ç¬¦æ“ä½œæ•°\nå¦‚æœAå­—ç¬¦ä¸²çš„ç¬¬iä¸ªå­—ç¬¦ä¸Bå­—ç¬¦ä¸²çš„ç¬¬jä¸ªå­—ç¬¦ä¸²ç›¸åŒï¼Œåˆ™è¿™ä¸ªä½ç½®ä¸éœ€è¦æ“ä½œï¼Œæ‰€éœ€çš„æ“ä½œç­‰äºdp[i-1][j-1]ï¼Œå¦åˆ™éœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œæ“ä½œæ•°å°±è¦+1\nç”±äºæ¯ä¸ªä½ç½®éƒ½å¯ä»¥è¿›è¡Œä¿®æ”¹ã€åˆ é™¤ã€æ’å…¥ä¸‰ç§æ“ä½œï¼Œå› æ­¤éœ€è¦æŠŠè¿™ä¸‰ç§æ“ä½œä¸­ç¼–è¾‘è·ç¦»æœ€å°çš„ä½œä¸ºdp[i][j]çš„å€¼\né€’æ¨å…¬å¼(ä»£ç è¡¨ç¤º)ï¼š\nif (A[i - 1] == B[j - 1]) // dpçŸ©é˜µä»¥1å¼€å§‹ï¼Œå­—ç¬¦æ•°ç»„æ˜¯0å¼€å§‹ï¼Œå› æ­¤å¯¹åº”çš„è¯è¦-1 \tdp[i][j] = dp[i - 1][j - 1]; // å¦‚æœå¯¹åº”çš„ä½ç½®ç›¸åŒå°±ä¸ç”¨æ“ä½œï¼Œå¦åˆ™è¦ä¿®æ”¹æ‰€ä»¥è¦+1 else dp[i][j] = dp[i - 1][j - 1] + 1; // ä¿®æ”¹ åˆ é™¤ æ’å…¥ dp[i][j] = min(dp[i][j], min(dp[i - 1][j] + 1, dp[i][j - 1] + 1)); è¡¨çš„ç»´åº¦ï¼šäºŒç»´\nå¡«è¡¨çš„èŒƒå›´ï¼šï¼ˆlen_Aå’Œlen_Båˆ†åˆ«ä¸ºå­—ç¬¦ä¸²Aã€Bçš„é•¿åº¦ï¼‰\niï¼š1 ~ len_A\njï¼š1 ~ len_B\nå¡«è¡¨é¡ºåºï¼šä»å·¦è‡³å³ï¼Œè‡ªé¡¶å‘ä¸‹ï¼ˆiä¸jçš„é€’å¢æ–¹å‘ï¼‰\næ—¶é—´å¤æ‚åº¦ï¼šç”±äºå¡«å†™çš„æ˜¯äºŒç»´è¡¨ï¼Œéœ€è¦äºŒé‡å¾ªç¯ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯O(n^2)\nç©ºé—´å¤æ‚åº¦ï¼šéœ€è¦ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå› è€Œæ˜¯O(n^2)\nä»£ç  // ç¼–è¾‘è·ç¦»é—®é¢˜ #include \u0026lt;iostream\u0026gt;#include \u0026lt;cstring\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; #define MAX 2002 char A[MAX]; char B[MAX]; int dp[MAX][MAX]; int calculate_distance() { // aã€bå­—ç¬¦ä¸²çš„é•¿åº¦  int len_a = strlen(A); int len_b = strlen(B); // è¾¹ç•Œåˆå§‹åŒ–  for (int i = 0; i \u0026lt;= len_a; i++) dp[i][0] = i; for (int j = 0; j \u0026lt;= len_b; j++) dp[0][j] = j; for (int i = 1; i \u0026lt;= len_a; i++) { for (int j = 1; j \u0026lt;= len_b; j++) { // dpçŸ©é˜µä»¥1å¼€å§‹ï¼Œå­—ç¬¦æ•°ç»„æ˜¯0å¼€å§‹ï¼Œå› æ­¤å¯¹åº”çš„è¯è¦-1  if (A[i - 1] == B[j - 1]) // å¦‚æœå¯¹åº”çš„ä½ç½®ç›¸åŒå°±ä¸ç”¨æ“ä½œï¼Œå¦åˆ™è¦ä¿®æ”¹æ‰€ä»¥è¦+1  dp[i][j] = dp[i - 1][j - 1]; else dp[i][j] = dp[i - 1][j - 1] + 1; // ä¿®æ”¹ åˆ é™¤ æ’å…¥  dp[i][j] = min(dp[i][j], min(dp[i - 1][j] + 1, dp[i][j - 1] + 1)); } } return dp[len_a][len_b]; } int main() { cin \u0026gt;\u0026gt; A \u0026gt;\u0026gt; B; cout \u0026lt;\u0026lt; calculate_distance(); } ","date":"2020-10-31T17:03:00+08:00","permalink":"https://ccqstark.github.io/p/dp_edit_distance/","title":"DPåŠ¨æ€è§„åˆ’â€”â€”ç¼–è¾‘è·ç¦»é—®é¢˜"},{"content":"é¢˜ç›® å‡è®¾è¦åœ¨è¶³å¤Ÿå¤šçš„ä¼šåœºé‡Œå®‰æ’ä¸€æ‰¹æ´»åŠ¨ï¼Œå¹¶å¸Œæœ›ä½¿ç”¨å°½å¯èƒ½å°‘çš„ä¼šåœºã€‚è®¾è®¡ä¸€ä¸ªæœ‰æ•ˆçš„ è´ªå¿ƒç®—æ³•è¿›è¡Œå®‰æ’ã€‚ï¼ˆè¿™ä¸ªé—®é¢˜å®é™…ä¸Šæ˜¯è‘—åçš„å›¾ç€è‰²é—®é¢˜ã€‚è‹¥å°†æ¯ä¸€ä¸ªæ´»åŠ¨ä½œä¸ºå›¾çš„ä¸€ä¸ª é¡¶ç‚¹ï¼Œä¸ç›¸å®¹æ´»åŠ¨é—´ç”¨è¾¹ç›¸è¿ã€‚ä½¿ç›¸é‚»é¡¶ç‚¹ç€æœ‰ä¸åŒé¢œè‰²çš„æœ€å°ç€è‰²æ•°ï¼Œç›¸åº”äºè¦æ‰¾çš„æœ€å° ä¼šåœºæ•°ã€‚ï¼‰\nè¾“å…¥æ ¼å¼: ç¬¬ä¸€è¡Œæœ‰ 1 ä¸ªæ­£æ•´æ•°kï¼Œè¡¨ç¤ºæœ‰ kä¸ªå¾…å®‰æ’çš„æ´»åŠ¨ã€‚ æ¥ä¸‹æ¥çš„ kè¡Œä¸­ï¼Œæ¯è¡Œæœ‰ 2ä¸ªæ­£æ•´æ•°ï¼Œåˆ†åˆ«è¡¨ç¤º kä¸ªå¾…å®‰æ’çš„æ´»åŠ¨å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ã€‚æ—¶é—´ ä»¥ 0 ç‚¹å¼€å§‹çš„åˆ†é’Ÿè®¡ã€‚\nè¾“å‡ºæ ¼å¼: è¾“å‡ºæœ€å°‘ä¼šåœºæ•°ã€‚\nè¾“å…¥æ ·ä¾‹: 5\r1 23\r12 28\r25 35\r27 80\r36 50 è¾“å‡ºæ ·ä¾‹: åœ¨è¿™é‡Œç»™å‡ºç›¸åº”çš„è¾“å‡ºã€‚ä¾‹å¦‚ï¼š\n3\ræ€è·¯ é¦–å…ˆè¿™é“é¢˜å°±å¾ˆåƒä¹¦ä¸­é‚£é“åœ¨ä¸€ä¸ªä¼šåœºä¸­å®‰æ’å°½å¯èƒ½å¤šçš„æ´»åŠ¨ï¼Œä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æŒ‰ä¹‹å‰é‚£ä¸ªæ€è·¯æ¥åšï¼\nè¿™é‡Œæ˜¯è¦ç”¨å°½å¯èƒ½å°‘çš„ä¼šåœºï¼Œè€Œä¸”ä»é¢˜ä¸­å¯ä»¥çœ‹å‡ºä¼šåœºçš„ç»“æŸæ—¶é—´æ²¡æœ‰é™åˆ¶ï¼Œåªè¦æ´»åŠ¨çš„å¼€å§‹æ—¶é—´æ¯”ä¸Šä¸€åœºè¦æ™šå°±è¡Œã€‚å¦‚æœæˆ‘ä»¬æŒ‰ä¹¦ä¸­çš„åŠæ³•æŠŠæ´»åŠ¨å…ˆæŒ‰ç»“æŸæ—¶é—´ä»å°åˆ°å¤§æ’åºï¼Œç„¶åå¯¹å½“å‰æœªå®‰æ’çš„æ´»åŠ¨ç”¨ä¸€ä¸ªä¼šåœºè¿›è¡Œå°½å¯èƒ½å¤šçš„å®‰æ’ï¼Œä¹‹åè‹¥è¿˜æ¯å®‰æ’å®Œåœ¨å¼€è¾Ÿä¸€ä¸ªæ–°çš„ä¼šåœºç»§ç»­ä¹‹å‰çš„æ“ä½œã€‚è¿™æ ·çš„ç®—æ³•æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºè¿™æ ·çš„åœ¨ä¸€ä¸ªä¼šåœºä¸­å°½å¯èƒ½å¤šçš„å®‰æ’æ´»åŠ¨ï¼Œè€Œä»å…¨å±€æ¥çœ‹ï¼ˆè¿˜æœ‰è¿™é“é¢˜çš„ç‰¹ç‚¹ï¼šä¼šåœºç»“æŸæ—¶é—´æ— é™åˆ¶ï¼‰ï¼Œè¿™ç§ç­–ç•¥å¹¶ä¸èƒ½ä¿è¯æŠŠæ‰€æœ‰æ´»åŠ¨å®‰æ’åœ¨æœ€å°‘çš„ä¼šåœºï¼Œæ‰€ä»¥ä¸¤ä¸ªé—®é¢˜å¹¶ä¸èƒ½å®Œå…¨ç­‰åŒï¼Œè¿™å°±æ˜¯æˆ‘ä¸€å¼€å§‹çŠ¯çš„é”™è¯¯ã€‚\nå…¶å®åŸå› å°±åœ¨äºï¼šä¼šåœºç»“æŸæ—¶é—´æ— é™åˆ¶ï¼Œè¦ç”¨æœ€å°‘çš„ä¼šåœºã€‚\næ­£ç¡®è§£æ³•æœ‰2ç§ï¼š\n æŠŠæ´»åŠ¨æŒ‰å¼€å§‹æ—¶é—´ä»å°åˆ°å¤§æ’ï¼Œå½“å¼€å§‹æ—¶é—´ç›¸åŒåˆ™ç»“æŸæ—¶é—´æ—©çš„ä¼˜å…ˆã€‚éå†æ´»åŠ¨å†ç”¨ä¹‹å‰çš„é‚£ç§åœ¨ä¸€ä¸ªä¼šåœºå®‰æ’å°½å¯èƒ½å¤šçš„æ´»åŠ¨ï¼Œå®Œäº†ä¹‹åå¼€è¾Ÿä¸€ä¸ªæ–°çš„ä¼šåœºç»§ç»­å®‰æ’ï¼Œç›´åˆ°å…¨éƒ¨æ´»åŠ¨å®‰æ’å®Œæ¯•ã€‚ æŠŠæ´»åŠ¨æŒ‰ç»“æŸæ—¶é—´ä»å°åˆ°å¤§æ’ï¼Œå½“ç»“æŸæ—¶é—´ç›¸åŒåˆ™å¼€å§‹æ—¶é—´æ—©çš„ä¼˜å…ˆã€‚éå†æ´»åŠ¨ï¼Œæ¯æ¬¡å†éå†ä¸€æ¬¡æ‰€æœ‰ä¼šåœºçœ‹ç»“æŸæ—¶é—´æ˜¯å¦æ»¡è¶³å¯ä»¥å®‰æ’ä¸‹ï¼Œéƒ½ä¸èƒ½å®‰æ’ä¸‹å°±æ–°å¼€ä¸€ä¸ªä¼šåœºï¼Œç„¶åæ¯æ¬¡è¿˜è¦å¯¹æ‰€æœ‰å·²ç»å¼€è¾Ÿçš„ä¼šåœºæŒ‰ç»“æŸæ—¶é—´è¿›è¡Œä»å¤§åˆ°å°å†æ¬¡æ’åºï¼Œè¿™æ ·ç›´åˆ°æ‰€æœ‰æ´»åŠ¨éå†å®‰æ’å®Œæ¯•ã€‚  æ‰€ä»¥è¿™é“é¢˜æ˜¯è¦æŠŠæœ‰é™çš„æ´»åŠ¨å°½é‡å¡åœ¨æœ€å°‘çš„ä¼šåœºä¸­ï¼Œè¦ä»æ‰€æœ‰ä¼šåœºå…¨å±€å»è€ƒè™‘ï¼Œè€Œä¸”è¿™é“é¢˜çš„ç‰¹ç‚¹æ˜¯å•ä¸ªä¼šåœºçš„ç»“æŸæ—¶é—´æ²¡æœ‰é™åˆ¶ï¼Œæ‰€ä»¥ç¬¬ä¸€ç§è§£æ³•æ˜¯æŒ‰å¼€å§‹æ—¶é—´æ’çš„è€Œä¸ç”¨æŒ‰ç»“æŸæ—¶é—´ã€‚ç¬¬äºŒç§æŒ‰ç»“æŸæ—¶é—´çš„è¯å°±éœ€è¦æ¯æ¬¡é‡æ–°éå†æ‰€æœ‰ä¼šåœºï¼Œæ¯æ¬¡è¿˜é‡æ’ï¼Œä¿è¯ä»å…¨å±€å»è€ƒè™‘ã€‚\nä»£ç  è§£æ³•1ï¼š // æŒ‰å¼€å§‹æ—¶é—´æ’åº #include \u0026lt;iostream\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; #define MAX 666  struct activity { int start; int end; int arrage; } activities[MAX]; int n; bool struct_compare(activity a, activity b) { if (a.start != b.start) return a.start \u0026lt; b.start; //ä¼˜å…ˆè¿›è¡Œæœ€å…ˆå¼€å§‹çš„æ´»åŠ¨  else return a.end \u0026lt; b.end; //å½“å¼€å§‹æ—¶é—´ç›¸åŒæ—¶,ä¼˜å…ˆè¿›è¡Œæœ€æ—©ç»“æŸçš„æ´»åŠ¨ } int main() { cin \u0026gt;\u0026gt; n; for (int i = 0; i \u0026lt; n; i++) { cin \u0026gt;\u0026gt; activities[i].start; cin \u0026gt;\u0026gt; activities[i].end; activities[i].arrage = 0; } // åˆå§‹åŒ–ä¼šåœºæ•°  int room = 0; // å¯¹æ´»åŠ¨\u0026#39;å¼€å§‹æ—¶é—´\u0026#39;è¿›è¡Œä»å°åˆ°å¤§æ’åº  sort(activities, activities + n, struct_compare); // è®°å½•å½“å‰å®‰æ’ä¼šåœºçš„ç»“æŸæ—¶é—´ï¼Œè¢«å®‰æ’çš„ä¼šåœºæ•°  int lastest = 0, arrage_num = 0; // å¦‚æœä¼šåœºè¿˜æ²¡æœ‰è¢«å…¨éƒ¨å®‰æ’å®Œ  while (arrage_num != n) { // æ–°å¢ä¸€ä¸ªä¼šåœº  room++; for (int i = 0; i \u0026lt; n; i++) { // åœ¨ä¸€ä¸ªä¼šåœºä¸­å®‰æ’å°½å¯èƒ½å¤šçš„æ´»åŠ¨  if (activities[i].arrage == 0 \u0026amp;\u0026amp; activities[i].start \u0026gt;= lastest) { activities[i].arrage = 1; // æ ‡è®°æ´»åŠ¨ä¸ºå·²è¢«å®‰æ’  arrage_num++; lastest = activities[i].end; // æ›´æ–°å½“å‰ä¼šåœºçš„ç»“æŸæ—¶é—´  } } lastest = 0; } //å¦å¤–ä¸€ç§å†™æ³•ï¼Œæ•ˆæœä¸€æ ·  /* for (int i = 0; i \u0026lt; n; i++) { if (activities[i].arrage == 0) { room++; activities[i].arrage = 1; lastest = activities[i].end; for (int j = i + 1; j \u0026lt; n; j++) { if (activities[j].arrage == 0 \u0026amp;\u0026amp; activities[j].start \u0026gt;= lastest) { activities[j].arrage = 1; lastest = activities[j].end; } } } } */ cout \u0026lt;\u0026lt; room; return 0; } è§£æ³•2ï¼š //æŒ‰ç»“æŸæ—¶é—´æ’åº #include \u0026lt;iostream\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; #define MAX 666  struct activity { int start; int end; } activities[MAX]; int n; int end_time[MAX] = {0}; // è®°å½•æ¯ä¸ªä¼šåœºçš„ç»“æŸæ—¶é—´ int room = 1; // ä¼šåœºæ•°  bool struct_compare(activity a, activity b) { if (a.end != b.end) return a.end \u0026lt; b.end; //ä¼˜å…ˆè¿›è¡Œæœ€æ—©ç»“æŸçš„æ´»åŠ¨  else return a.start \u0026lt; b.start; //å½“ç»“æŸæ—¶é—´ç›¸åŒæ—¶,ä¼˜å…ˆè¿›è¡Œæœ€æ—©å¼€å§‹çš„æ´»åŠ¨ } bool dcmp(int a, int b) { return a \u0026gt; b; // ä»å¤§åˆ°å°æ’åº } int main() { cin \u0026gt;\u0026gt; n; for (int i = 0; i \u0026lt; n; i++) { cin \u0026gt;\u0026gt; activities[i].start; cin \u0026gt;\u0026gt; activities[i].end; } // å¯¹æ´»åŠ¨æŒ‰\u0026#39;ç»“æŸæ—¶é—´\u0026#39;è¿›è¡Œæ’åº  sort(activities, activities + n, struct_compare); // éå†æ´»åŠ¨  for (int i = 0; i \u0026lt; n; i++) { int flag = 0; // æ ‡è®°æ˜¯å¦åœ¨å·²å¼€è¾Ÿçš„ä¼šåœºä¸­è¢«å®‰æ’  for (int j = 1; j \u0026lt;= room; j++) // éå†å·²æœ‰ä¼šåœºå¯»æ‰¾åˆé€‚çš„  { if (activities[i].start \u0026gt;= end_time[j]) { end_time[j] = activities[i].end; flag = 1; break; } } // å·²æœ‰ä¼šåœºæ‰¾ä¸åˆ°åˆé€‚çš„å°±å¼€è¾Ÿä¸€ä¸ªæ–°çš„  if (!flag) { room++; end_time[room] = activities[i].end; } // æ¯æ¬¡å®‰æ’å®Œä¸€ä¸ªæ´»åŠ¨éƒ½è¦å¯¹ä¼šåœºä»¬æŒ‰ç»“æŸæ—¶é—´ä»å¤§åˆ°å°é‡æ’  sort(end_time + 1, end_time + room + 1, dcmp); } cout \u0026lt;\u0026lt; room; return 0; } å‚è€ƒåšæ–‡\n","date":"2020-10-31T09:45:00+08:00","permalink":"https://ccqstark.github.io/p/greedy_activity/","title":"è´ªå¿ƒç®—æ³•â€”â€”ä¼šåœºå®‰æ’é—®é¢˜"},{"content":"é¢˜ç›® åœ¨ä¸€ä¸ªåœ°å›¾ä¸Šæœ‰nä¸ªåœ°çª–ï¼ˆnâ‰¤200ï¼‰,æ¯ä¸ªåœ°çª–ä¸­åŸ‹æœ‰ä¸€å®šæ•°é‡çš„åœ°é›·ã€‚åŒæ—¶ï¼Œç»™å‡ºåœ°çª–ä¹‹é—´çš„è¿æ¥è·¯å¾„ï¼Œå¹¶è§„å®šè·¯å¾„éƒ½æ˜¯å•å‘çš„,ä¸”ä¿è¯éƒ½æ˜¯å°åºå·åœ°çª–æŒ‡å‘å¤§åºå·åœ°çª–ï¼Œä¹Ÿä¸å­˜åœ¨å¯ä»¥ä»ä¸€ä¸ªåœ°çª–å‡ºå‘ç»è¿‡è‹¥å¹²åœ°çª–ååˆå›åˆ°åŸæ¥åœ°çª–çš„è·¯å¾„ã€‚æŸäººå¯ä»¥ä»ä»»æ„ä¸€å¤„å¼€å§‹æŒ–åœ°é›·ï¼Œç„¶åæ²¿ç€æŒ‡å‡ºçš„è¿æ¥å¾€ä¸‹æŒ–ï¼ˆä»…èƒ½é€‰æ‹©ä¸€æ¡è·¯å¾„ï¼‰ï¼Œå½“æ— è¿æ¥æ—¶æŒ–åœ°é›·å·¥ä½œç»“æŸã€‚è®¾è®¡ä¸€ä¸ªæŒ–åœ°é›·çš„æ–¹æ¡ˆï¼Œä½¿ä»–èƒ½æŒ–åˆ°æœ€å¤šçš„åœ°é›·ã€‚\nè¾“å…¥æ ¼å¼: ç¬¬ä¸€è¡Œï¼šåœ°çª–çš„ä¸ªæ•°ï¼›\nç¬¬äºŒè¡Œï¼šä¸ºä¾æ¬¡æ¯ä¸ªåœ°çª–åœ°é›·çš„ä¸ªæ•°ï¼›\nä¸‹é¢è‹¥å¹²è¡Œï¼š\nxi yi //è¡¨ç¤ºä»xiå¯åˆ°yiï¼Œxi\u0026lt;yiã€‚\næœ€åä¸€è¡Œä¸º\u0026quot;0 0\u0026quot;è¡¨ç¤ºç»“æŸã€‚\nè¾“å‡ºæ ¼å¼: k1-k2âˆ’â€¦âˆ’kv //æŒ–åœ°é›·çš„é¡ºåº æŒ–åˆ°æœ€å¤šçš„é›·ã€‚\nè¾“å…¥æ ·ä¾‹: 6\r5 10 20 5 4 5\r1 2\r1 4\r2 4\r3 4\r4 5\r4 6\r5 6\r0 0\rè¾“å‡ºæ ·ä¾‹: 3-4-5-6\r34\rä»£ç  #include \u0026lt;iostream\u0026gt;using namespace std; #define MAX 203 int matrix[MAX][MAX]; // å­˜æ”¾é€šè·¯æƒ…å†µ int mines[MAX]; // å­˜æ”¾å„å‘åœ°é›·æ•° int dp_mat[MAX][MAX]; // å­˜æ”¾å­é—®é¢˜æœ€ä¼˜è§£ int path[MAX]; // å­˜æ”¾è·¯å¾„ int n, ans, last_update; // last_updateæ˜¯æœ€åä¸€ä¸ªæ›´æ–°æœ€å¤§å€¼çš„ç‚¹  void dig() { // ä¸€è¡Œè¡Œæ‰«  for (int i = 1; i \u0026lt;= n; i++) { // max_lastæ˜¯æ­¤ç‚¹ä¹‹å‰æ‰€æœ‰ç‚¹å¯ä»¥æŒ–åˆ°çš„æœ€å¤§åœ°é›·æ•°  int max_last = 0; for (int k = 1; k \u0026lt;= i - 1; k++) { // åˆ¤æ–­ä¹‹å‰æ‰€æœ‰å¯ä»¥é€šå‘ç°åœ¨çš„ç‚¹ä¸­ï¼Œå¯ä»¥æŒ–åˆ°æœ€å¤§çš„åœ°é›·æ•°çš„è·¯å¾„çš„æœ€åä¸€ç‚¹  if (matrix[k][i] == 1) { // æŒ‰åˆ—æ–¹å‘æ‰«ï¼Œå¯ä»¥é€šå‘æœ¬ç‚¹çš„ç‚¹  if (dp_mat[k][i] \u0026gt; max_last) { max_last = dp_mat[k][i]; path[i] = k; // è·¯å¾„æ˜¯æ‰€è¿æ¥çš„ä¸Šä¸€ç‚¹  } } } for (int j = i; j \u0026lt;= n; j++) { // max_last + æœ¬ç‚¹åœ°é›·æ•° = ä»¥æœ¬ç‚¹ä½œä¸ºè·¯å¾„æœ«ç‚¹å¯ä»¥æŒ–åˆ°çš„æœ€å¤§åœ°é›·æ•°  dp_mat[i][j] = max_last + mines[i]; if (dp_mat[i][j] \u0026gt; ans) { // æ›´æ–°æœ€ç»ˆç­”æ¡ˆçš„æœ€å¤§åœ°é›·æ•°  ans = dp_mat[i][j]; // è®°å½•æœ€åæ›´æ–°æœ€ç»ˆç­”æ¡ˆçš„é‚£ä¸ªç‚¹ï¼Œä½œä¸ºç­”æ¡ˆè·¯å¾„çš„æœ«å°¾ç‚¹ï¼Œç”¨æ•°ç»„å›æº¯å¯ä»¥æ‰“å°å‡ºå®Œæ•´è·¯å¾„  last_update = i; } } } } // é€’å½’å›æº¯æ‰“å°å®Œæ•´è·¯å¾„ void print_path(int point) { if (point == 0) return; print_path(path[point]); if (point == last_update) { cout \u0026lt;\u0026lt; point \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; point \u0026lt;\u0026lt; \u0026#34;-\u0026#34;; } } int main() { cin \u0026gt;\u0026gt; n; for (int i = 1; i \u0026lt;= n; i++) { cin \u0026gt;\u0026gt; mines[i]; } int a, b; while (cin \u0026gt;\u0026gt; a \u0026gt;\u0026gt; b) { if (a == 0 \u0026amp;\u0026amp; b == 0) break; matrix[a][b] = 1; } dig(); print_path(last_update); cout \u0026lt;\u0026lt; ans; } ","date":"2020-10-22T01:05:00+08:00","permalink":"https://ccqstark.github.io/p/dp_digmines/","title":"DPåŠ¨æ€è§„åˆ’â€”â€”æŒ–åœ°é›·"},{"content":"é¢˜ç›® è®¾è®¡ä¸€ä¸ªO(n2)æ—¶é—´çš„ç®—æ³•ï¼Œæ‰¾å‡ºç”±nä¸ªæ•°ç»„æˆçš„åºåˆ—çš„æœ€é•¿å•è°ƒé€’å¢å­åºåˆ—ã€‚\nè¾“å…¥æ ¼å¼: è¾“å…¥æœ‰ä¸¤è¡Œï¼š ç¬¬ä¸€è¡Œï¼šnï¼Œä»£è¡¨è¦è¾“å…¥çš„æ•°åˆ—çš„ä¸ªæ•° ç¬¬äºŒè¡Œï¼šnä¸ªæ•°ï¼Œæ•°å­—ä¹‹é—´ç”¨ç©ºæ ¼æ ¼å¼€\nè¾“å‡ºæ ¼å¼: æœ€é•¿å•è°ƒé€’å¢å­åºåˆ—çš„é•¿åº¦\nè¾“å…¥æ ·ä¾‹: åœ¨è¿™é‡Œç»™å‡ºä¸€ç»„è¾“å…¥ã€‚ä¾‹å¦‚ï¼š\n5\r1 3 5 2 9\rè¾“å‡ºæ ·ä¾‹: åœ¨è¿™é‡Œç»™å‡ºç›¸åº”çš„è¾“å‡ºã€‚ä¾‹å¦‚ï¼š\n4\ræ€è·¯ ç”¨åŠ¨æ€è§„åˆ’çš„æ€æƒ³ï¼Œåˆ©ç”¨å­é—®é¢˜çš„æœ€ä¼˜è§£æ±‚æ›´å¤§ä¸€ç‚¹çš„å­é—®é¢˜ã€‚\nè®¾ä¸€ä¸ªæ•°ç»„dp[i]ç”¨äºå­˜æ”¾æ•°ç»„ä¸­ä»0åˆ°iä¸‹æ ‡çš„åºåˆ—ä¸­ï¼Œæœ€é•¿çš„é€’å¢å­åºåˆ—çš„é•¿åº¦\nåŒé‡éå†ï¼Œå¦‚æœarr[j]å°äºarr[i]ï¼Œåˆ™dp[i]ä¸ºdp[j]+1å’Œdp[i]ä¸­è¾ƒå¤§çš„é‚£ä¸ªã€‚å³\ndp[i] = max{ dp[j]+1, dp[i] }\nç”±äºæ¯æ¬¡é‡å¤´åˆéå†äº†ä¸€æ¬¡ï¼Œå¹¶æ¯æ¬¡éƒ½åˆ†ææœ€ä¼˜è§£ï¼Œé¿å…äº†1 2 3 9 6 7 è¿™æ ·åœ¨æœ€å¤§æ•°åé¢è¿˜æœ‰2ä¸ªè¾ƒå°çš„æ•°å¯ä»¥äº§ç”Ÿæ›´é•¿é€’å¢å­åºåˆ—çš„æƒ…å†µå¯èƒ½çŠ¯çš„é”™è¯¯ã€‚\nè¿™ä¹Ÿè¯´æ˜è¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åªèƒ½æ˜¯O(n2)\nä»£ç  // å•è°ƒé€’å¢æœ€é•¿å­åºåˆ— #include \u0026lt;iostream\u0026gt;using namespace std; #define MAX 666 int arr[MAX]; int dp[MAX]; int n; int longest_increasing(){ // åˆå§‹åŒ–ç¬¬ä¸€ä¸ª  dp[0] = 1; // åŒé‡éå†  for (int i = 0;i\u0026lt;n;i++){ for (int j = 0;j\u0026lt;i;j++){ // åˆ©ç”¨å­é—®é¢˜æœ€ä¼˜è§£  if(arr[i]\u0026gt;arr[j]){ dp[i] = (dp[j]+1\u0026gt;dp[i])?dp[j]+1:dp[i]; } } } // æ‰¾å‡ºdp[]ä¸­æœ€å¤§çš„é‚£ä¸ªä½œä¸ºç­”æ¡ˆ  int max_len = 1; for (int i = 0;i\u0026lt;n;i++){ max_len = (dp[i]\u0026gt;max_len)?dp[i]:max_len; } return max_len; } int main() { cin\u0026gt;\u0026gt;n; for (int i = 0;i\u0026lt;n;i++){ cin\u0026gt;\u0026gt;arr[i]; } cout\u0026lt;\u0026lt;longest_increasing(); } ","date":"2020-10-21T21:07:00+08:00","permalink":"https://ccqstark.github.io/p/dp_increasing/","title":"DPåŠ¨æ€è§„åˆ’â€”â€”å•è°ƒé€’å¢æœ€é•¿å­åºåˆ—"},{"content":"æ·»åŠ ä¾èµ– \u0026lt;!-- shiro --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.shiro\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;shiro-spring\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- JWT --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.auth0\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;java-jwt\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.11.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.jsonwebtoken\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;jjwt\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.9.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; JWTåŠ å¯†è§£å¯†éªŒè¯å·¥å…·ç±» package com.ccqstark.springbootquick.util; import com.auth0.jwt.JWT; import com.auth0.jwt.JWTVerifier; import com.auth0.jwt.algorithms.Algorithm; import io.jsonwebtoken.Claims; import io.jsonwebtoken.JwtBuilder; import io.jsonwebtoken.Jwts; import io.jsonwebtoken.SignatureAlgorithm; import org.apache.commons.codec.binary.Base64; import java.util.Date; import java.util.HashMap; import java.util.Map; import java.util.UUID; /* * æ€»çš„æ¥è¯´ï¼Œå·¥å…·ç±»ä¸­æœ‰ä¸‰ä¸ªæ–¹æ³• * è·å–JwtTokenï¼Œè·å–JwtTokenä¸­å°è£…çš„ä¿¡æ¯ï¼Œåˆ¤æ–­JwtTokenæ˜¯å¦å­˜åœ¨ * 1. encode()ï¼Œå‚æ•°æ˜¯=ç­¾å‘äººï¼Œå­˜åœ¨æ—¶é—´ï¼Œä¸€äº›å…¶ä»–çš„ä¿¡æ¯=ã€‚è¿”å›å€¼æ˜¯JwtTokenå¯¹åº”çš„å­—ç¬¦ä¸² * 2. decode()ï¼Œå‚æ•°æ˜¯=JwtToken=ã€‚è¿”å›å€¼æ˜¯è·è½½éƒ¨åˆ†çš„é”®å€¼å¯¹ * 3. isVerify()ï¼Œå‚æ•°æ˜¯=JwtToken=ã€‚è¿”å›å€¼æ˜¯è¿™ä¸ªJwtTokenæ˜¯å¦å­˜åœ¨ * */ public class JwtUtil { // åˆ›å»ºé»˜è®¤çš„ç§˜é’¥å’Œç®—æ³•ï¼Œä¾›æ— å‚çš„æ„é€ æ–¹æ³•ä½¿ç”¨  private static final String defaultbase64EncodedSecretKey = \u0026#34;wdnmd\u0026#34;; private static final SignatureAlgorithm defaultsignatureAlgorithm = SignatureAlgorithm.HS256; // æ— å‚æ„é€ ï¼Œä½¿ç”¨é»˜è®¤  public JwtUtil() { this(defaultbase64EncodedSecretKey, defaultsignatureAlgorithm); } private final String base64EncodedSecretKey; private final SignatureAlgorithm signatureAlgorithm; // æœ‰å‚æ„é€   public JwtUtil(String secretKey, SignatureAlgorithm signatureAlgorithm) { this.base64EncodedSecretKey = Base64.encodeBase64String(secretKey.getBytes()); this.signatureAlgorithm = signatureAlgorithm; } /* *è¿™é‡Œå°±æ˜¯äº§ç”Ÿjwtå­—ç¬¦ä¸²çš„åœ°æ–¹ * jwtå­—ç¬¦ä¸²åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ† * 1. header * -å½“å‰å­—ç¬¦ä¸²çš„ç±»å‹ï¼Œä¸€èˆ¬éƒ½æ˜¯â€œJWTâ€ * -å“ªç§ç®—æ³•åŠ å¯†ï¼Œâ€œHS256â€æˆ–è€…å…¶ä»–çš„åŠ å¯†ç®—æ³• * æ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯å›ºå®šçš„ï¼Œæ²¡æœ‰ä»€ä¹ˆå˜åŒ– * 2. payload * ä¸€èˆ¬æœ‰å››ä¸ªæœ€å¸¸è§çš„æ ‡å‡†å­—æ®µï¼ˆä¸‹é¢æœ‰ï¼‰ * iatï¼šç­¾å‘æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªjwtä»€ä¹ˆæ—¶å€™ç”Ÿæˆçš„ * jtiï¼šJWTçš„å”¯ä¸€æ ‡è¯† * issï¼šç­¾å‘äººï¼Œä¸€èˆ¬éƒ½æ˜¯usernameæˆ–è€…userId * expï¼šè¿‡æœŸæ—¶é—´ * * */ public String encode(String iss, long ttlMillis, Map\u0026lt;String, Object\u0026gt; claims) { //issç­¾å‘äººï¼ŒttlMillisç”Ÿå­˜æ—¶é—´ï¼Œclaimsæ˜¯æŒ‡è¿˜æƒ³è¦åœ¨jwtä¸­å­˜å‚¨çš„ä¸€äº›ééšç§ä¿¡æ¯  if (claims == null) { claims = new HashMap\u0026lt;\u0026gt;(); } long nowMillis = System.currentTimeMillis(); JwtBuilder builder = Jwts.builder() .setClaims(claims) .setId(UUID.randomUUID().toString())// è¿™ä¸ªæ˜¯JWTçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€èˆ¬è®¾ç½®æˆå”¯ä¸€çš„ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥ç”Ÿæˆå”¯ä¸€æ ‡è¯†  .setIssuedAt(new Date(nowMillis))// è¿™ä¸ªåœ°æ–¹å°±æ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œæ¢ç®—å½“å‰ç³»ç»Ÿæ—¶é—´ç”Ÿæˆçš„iat  .setIssuer(iss)// ç­¾å‘äººï¼Œä¹Ÿå°±æ˜¯JWTæ˜¯ç»™è°çš„ï¼ˆé€»è¾‘ä¸Šä¸€èˆ¬éƒ½æ˜¯usernameæˆ–è€…userIdï¼‰  .signWith(signatureAlgorithm, base64EncodedSecretKey);//è¿™ä¸ªåœ°æ–¹æ˜¯ç”Ÿæˆjwtä½¿ç”¨çš„ç®—æ³•å’Œç§˜é’¥  if (ttlMillis \u0026gt;= 0) { // è¿‡æœŸæ—¶é—´ = å½“å‰æ—¶é—´ + ç”Ÿå­˜æ—¶é—´  long expMillis = nowMillis + ttlMillis; Date exp = new Date(expMillis);// è¿‡æœŸæ—¶é—´ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ä½¿ç”¨æ¯«ç§’ç”Ÿæˆçš„  builder.setExpiration(exp); } return builder.compact(); } //ç›¸å½“äºencodeçš„é€†å‘ï¼Œä¼ å…¥jwtTokenç”Ÿæˆå¯¹åº”çš„usernameå’Œpasswordç­‰å­—æ®µã€‚Claimå°±æ˜¯ä¸€ä¸ªmap  //ä¹Ÿå°±æ˜¯æ‹¿åˆ°è·è½½éƒ¨åˆ†æ‰€æœ‰çš„é”®å€¼å¯¹  public Claims decode(String jwtToken) { // å¾—åˆ° DefaultJwtParser  return Jwts.parser() // è®¾ç½®ç­¾åçš„ç§˜é’¥  .setSigningKey(base64EncodedSecretKey) // è®¾ç½®éœ€è¦è§£æçš„ jwt  .parseClaimsJws(jwtToken) .getBody(); } //åˆ¤æ–­jwtTokenæ˜¯å¦åˆæ³•  public boolean isVerify(String jwtToken) { //è¿™ä¸ªæ˜¯å®˜æ–¹çš„æ ¡éªŒè§„åˆ™ï¼Œè¿™é‡Œåªå†™äº†ä¸€ä¸ª\u0026#34;æ ¡éªŒç®—æ³•\u0026#34;ï¼Œå¯ä»¥è‡ªå·±åŠ   Algorithm algorithm = null; switch (signatureAlgorithm) { case HS256: algorithm = Algorithm.HMAC256(Base64.decodeBase64(base64EncodedSecretKey)); break; default: throw new RuntimeException(\u0026#34;ä¸æ”¯æŒè¯¥ç®—æ³•\u0026#34;); } JWTVerifier verifier = JWT.require(algorithm).build(); verifier.verify(jwtToken); // æ ¡éªŒä¸é€šè¿‡ä¼šæŠ›å‡ºå¼‚å¸¸  //åˆ¤æ–­åˆæ³•çš„æ ‡å‡†ï¼š1. å¤´éƒ¨å’Œè·è½½éƒ¨åˆ†æ²¡æœ‰ç¯¡æ”¹è¿‡ã€‚2. æ²¡æœ‰è¿‡æœŸ  return true; } public static void main(String[] args) { JwtUtil util = new JwtUtil(\u0026#34;wdnmd\u0026#34;, SignatureAlgorithm.HS256); //ä»¥tomä½œä¸ºç§˜é’¥ï¼Œä»¥HS256åŠ å¯†  Map\u0026lt;String, Object\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); map.put(\u0026#34;username\u0026#34;, \u0026#34;ccq\u0026#34;); map.put(\u0026#34;password\u0026#34;, \u0026#34;1428\u0026#34;); map.put(\u0026#34;age\u0026#34;, 20); String jwtToken = util.encode(\u0026#34;ccqstark\u0026#34;, 30000, map); System.out.println(jwtToken); util.decode(jwtToken).entrySet().forEach((entry) -\u0026gt; { System.out.println(entry.getKey() + \u0026#34;: \u0026#34; + entry.getValue()); }); } } å…³é—­shiroçš„session package com.ccqstark.springbootquick.auth; import org.apache.shiro.subject.Subject; import org.apache.shiro.subject.SubjectContext; import org.apache.shiro.web.mgt.DefaultWebSubjectFactory; // å…³é—­shiroçš„session public class JwtDefaultSubjectFactory extends DefaultWebSubjectFactory { @Override public Subject createSubject(SubjectContext context) { // ä¸åˆ›å»º session  context.setSessionCreationEnabled(false); return super.createSubject(context); } } ä½¿ç”¨UsernamePasswordToken package com.ccqstark.springbootquick.auth; import org.apache.shiro.authc.AuthenticationToken; //è¿™ä¸ªå°±ç±»ä¼¼UsernamePasswordToken public class JwtToken implements AuthenticationToken { private String jwt; public JwtToken(String jwt) { this.jwt = jwt; } @Override//ç±»ä¼¼æ˜¯ç”¨æˆ·å  public Object getPrincipal() { return jwt; } @Override//ç±»ä¼¼å¯†ç   public Object getCredentials() { return jwt; } //è¿”å›çš„éƒ½æ˜¯jwt } RealméªŒè¯ç±» package com.ccqstark.springbootquick.auth; import com.ccqstark.springbootquick.util.JwtUtil; import lombok.extern.slf4j.Slf4j; import org.apache.shiro.authc.*; import org.apache.shiro.authz.AuthorizationInfo; import org.apache.shiro.realm.AuthorizingRealm; import org.apache.shiro.subject.PrincipalCollection; @Slf4j public class JwtRealm extends AuthorizingRealm { /* * å¤šé‡å†™ä¸€ä¸ªsupport * æ ‡è¯†è¿™ä¸ªRealmæ˜¯ä¸“é—¨ç”¨æ¥éªŒè¯JwtToken * ä¸è´Ÿè´£éªŒè¯å…¶ä»–çš„tokenï¼ˆUsernamePasswordTokenï¼‰ * */ @Override public boolean supports(AuthenticationToken token) { //è¿™ä¸ªtokenå°±æ˜¯ä»è¿‡æ»¤å™¨ä¸­ä¼ å…¥çš„jwtToken  return token instanceof JwtToken; } //æˆæƒ  @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) { return null; } //è®¤è¯  //è¿™ä¸ªtokenå°±æ˜¯ä»è¿‡æ»¤å™¨ä¸­ä¼ å…¥çš„jwtToken  @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException { String jwt = (String) token.getPrincipal(); if (jwt == null) { throw new NullPointerException(\u0026#34;jwtToken ä¸å…è®¸ä¸ºç©º\u0026#34;); } //åˆ¤æ–­  JwtUtil jwtUtil = new JwtUtil(); if (!jwtUtil.isVerify(jwt)) { throw new UnknownAccountException(); } //ä¸‹é¢æ˜¯éªŒè¯è¿™ä¸ªuseræ˜¯å¦æ˜¯çœŸå®å­˜åœ¨çš„  String username = (String) jwtUtil.decode(jwt).get(\u0026#34;username\u0026#34;);//åˆ¤æ–­æ•°æ®åº“ä¸­usernameæ˜¯å¦å­˜åœ¨  log.info(\u0026#34;åœ¨ä½¿ç”¨tokenç™»å½•\u0026#34;+username); return new SimpleAuthenticationInfo(jwt,jwt,\u0026#34;JwtRealm\u0026#34;); //è¿™é‡Œè¿”å›çš„æ˜¯ç±»ä¼¼è´¦å·å¯†ç çš„ä¸œè¥¿ï¼Œä½†æ˜¯jwtTokenéƒ½æ˜¯jwtå­—ç¬¦ä¸²ã€‚è¿˜éœ€è¦ä¸€ä¸ªè¯¥Realmçš„ç±»å  } } Filterè¿‡æ»¤å™¨ package com.ccqstark.springbootquick.auth; import lombok.extern.slf4j.Slf4j; import org.apache.shiro.web.filter.AccessControlFilter; import javax.servlet.ServletRequest; import javax.servlet.ServletResponse; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import java.io.IOException; /* * è‡ªå®šä¹‰ä¸€ä¸ªFilterï¼Œç”¨æ¥æ‹¦æˆªæ‰€æœ‰çš„è¯·æ±‚åˆ¤æ–­æ˜¯å¦æºå¸¦Token * isAccessAllowed()åˆ¤æ–­æ˜¯å¦æºå¸¦äº†æœ‰æ•ˆçš„JwtToken * onAccessDenied()æ˜¯æ²¡æœ‰æºå¸¦JwtTokençš„æ—¶å€™è¿›è¡Œè´¦å·å¯†ç ç™»å½•ï¼Œç™»å½•æˆåŠŸå…è®¸è®¿é—®ï¼Œç™»å½•å¤±è´¥æ‹’ç»è®¿é—® * */ @Slf4j public class JwtFilter extends AccessControlFilter { /* * 1. è¿”å›trueï¼Œshiroå°±ç›´æ¥å…è®¸è®¿é—®url * 2. è¿”å›falseï¼Œshiroæ‰ä¼šæ ¹æ®onAccessDeniedçš„æ–¹æ³•çš„è¿”å›å€¼å†³å®šæ˜¯å¦å…è®¸è®¿é—®url * */ @Override protected boolean isAccessAllowed(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception { log.warn(\u0026#34;isAccessAllowed æ–¹æ³•è¢«è°ƒç”¨\u0026#34;); //è¿™é‡Œå…ˆè®©å®ƒå§‹ç»ˆè¿”å›falseæ¥ä½¿ç”¨onAccessDenied()æ–¹æ³•  return false; } /** * è¿”å›ç»“æœä¸ºtrueè¡¨æ˜ç™»å½•é€šè¿‡ */ @Override protected boolean onAccessDenied(ServletRequest servletRequest, ServletResponse servletResponse) throws Exception { log.warn(\u0026#34;onAccessDenied æ–¹æ³•è¢«è°ƒç”¨\u0026#34;); //è¿™ä¸ªåœ°æ–¹å’Œå‰ç«¯çº¦å®šï¼Œè¦æ±‚å‰ç«¯å°†jwtTokenæ”¾åœ¨è¯·æ±‚çš„Headeréƒ¨åˆ†  //æ‰€ä»¥ä»¥åå‘èµ·è¯·æ±‚çš„æ—¶å€™å°±éœ€è¦åœ¨Headerä¸­æ”¾ä¸€ä¸ªAuthorizationï¼Œå€¼å°±æ˜¯å¯¹åº”çš„Token  HttpServletRequest request = (HttpServletRequest) servletRequest; String jwt = request.getHeader(\u0026#34;Authorization\u0026#34;); log.info(\u0026#34;è¯·æ±‚çš„ Header ä¸­è—æœ‰ jwtToken {}\u0026#34;, jwt); JwtToken jwtToken = new JwtToken(jwt); /* * ä¸‹é¢å°±æ˜¯å›ºå®šå†™æ³• * */ try { // å§”æ‰˜ realm è¿›è¡Œç™»å½•è®¤è¯  //æ‰€ä»¥è¿™ä¸ªåœ°æ–¹æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨JwtRealmè¿›è¡Œçš„è®¤è¯  getSubject(servletRequest, servletResponse).login(jwtToken); //ä¹Ÿå°±æ˜¯subject.login(token)  } catch (Exception e) { e.printStackTrace(); onLoginFail(servletResponse); //è°ƒç”¨ä¸‹é¢çš„æ–¹æ³•å‘å®¢æˆ·ç«¯è¿”å›é”™è¯¯ä¿¡æ¯  return false; } return true; //æ‰§è¡Œæ–¹æ³•ä¸­æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸å°±è¡¨ç¤ºç™»å½•æˆåŠŸ  } //ç™»å½•å¤±è´¥æ—¶é»˜è®¤è¿”å› 401 çŠ¶æ€ç   private void onLoginFail(ServletResponse response) throws IOException { HttpServletResponse httpResponse = (HttpServletResponse) response; httpResponse.setStatus(HttpServletResponse.SC_UNAUTHORIZED); httpResponse.getWriter().write(\u0026#34;login error\u0026#34;); } } shiroé…ç½® package com.ccqstark.springbootquick.config; import com.ccqstark.springbootquick.auth.*; import org.apache.shiro.mgt.DefaultSessionStorageEvaluator; import org.apache.shiro.mgt.DefaultSubjectDAO; import org.apache.shiro.mgt.SubjectFactory; import org.apache.shiro.realm.Realm; import org.apache.shiro.spring.web.ShiroFilterFactoryBean; import org.apache.shiro.web.filter.authc.AnonymousFilter; import org.apache.shiro.web.filter.authc.LogoutFilter; import org.apache.shiro.web.mgt.DefaultWebSecurityManager; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import javax.servlet.Filter; import java.util.HashMap; import java.util.LinkedHashMap; import java.util.Map; //springBootæ•´åˆjwtå®ç°è®¤è¯æœ‰ä¸‰ä¸ªä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œå¯¹åº”ä¸‹é¢abc @Configuration public class ShiroConfig { /* * a. å‘Šè¯‰shiroä¸è¦ä½¿ç”¨é»˜è®¤çš„DefaultSubjectåˆ›å»ºå¯¹è±¡ï¼Œå› ä¸ºä¸èƒ½åˆ›å»ºSession * */ @Bean public SubjectFactory subjectFactory() { return new JwtDefaultSubjectFactory(); } @Bean public Realm realm() { return new JwtRealm(); } @Bean public DefaultWebSecurityManager securityManager() { DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager(); securityManager.setRealm(realm()); /* * b * */ // å…³é—­ ShiroDAO åŠŸèƒ½  DefaultSubjectDAO subjectDAO = new DefaultSubjectDAO(); DefaultSessionStorageEvaluator defaultSessionStorageEvaluator = new DefaultSessionStorageEvaluator(); // ä¸éœ€è¦å°† Shiro Session ä¸­çš„ä¸œè¥¿å­˜åˆ°ä»»ä½•åœ°æ–¹ï¼ˆåŒ…æ‹¬ Http Session ä¸­ï¼‰  defaultSessionStorageEvaluator.setSessionStorageEnabled(false); subjectDAO.setSessionStorageEvaluator(defaultSessionStorageEvaluator); securityManager.setSubjectDAO(subjectDAO); //ç¦æ­¢Subjectçš„getSessionæ–¹æ³•  securityManager.setSubjectFactory(subjectFactory()); return securityManager; } @Bean public ShiroFilterFactoryBean shiroFilterFactoryBean() { ShiroFilterFactoryBean shiroFilter = new ShiroFilterFactoryBean(); shiroFilter.setSecurityManager(securityManager()); shiroFilter.setLoginUrl(\u0026#34;/unauthenticated\u0026#34;); shiroFilter.setUnauthorizedUrl(\u0026#34;/unauthorized\u0026#34;); /* * c. æ·»åŠ jwtè¿‡æ»¤å™¨ï¼Œå¹¶åœ¨ä¸‹é¢æ³¨å†Œ * ä¹Ÿå°±æ˜¯å°†jwtFilteræ³¨å†Œåˆ°shiroçš„Filterä¸­ * æŒ‡å®šé™¤äº†loginå’Œlogoutä¹‹å¤–çš„è¯·æ±‚éƒ½å…ˆç»è¿‡jwtFilter * */ Map\u0026lt;String, Filter\u0026gt; filterMap = new HashMap\u0026lt;\u0026gt;(); //è¿™ä¸ªåœ°æ–¹å…¶å®å¦å¤–ä¸¤ä¸ªfilterå¯ä»¥ä¸è®¾ç½®ï¼Œé»˜è®¤å°±æ˜¯  filterMap.put(\u0026#34;anon\u0026#34;, new AnonymousFilter()); filterMap.put(\u0026#34;jwt\u0026#34;, new JwtFilter()); filterMap.put(\u0026#34;logout\u0026#34;, new LogoutFilter()); shiroFilter.setFilters(filterMap); // æ‹¦æˆªå™¨  Map\u0026lt;String, String\u0026gt; filterRuleMap = new LinkedHashMap\u0026lt;\u0026gt;(); filterRuleMap.put(\u0026#34;/login\u0026#34;, \u0026#34;anon\u0026#34;); filterRuleMap.put(\u0026#34;/logout\u0026#34;, \u0026#34;logout\u0026#34;); filterRuleMap.put(\u0026#34;/**\u0026#34;, \u0026#34;jwt\u0026#34;); shiroFilter.setFilterChainDefinitionMap(filterRuleMap); return shiroFilter; } } æµ‹è¯•Controller package com.ccqstark.springbootquick.controller; import com.ccqstark.springbootquick.util.JwtUtil; import io.jsonwebtoken.SignatureAlgorithm; import lombok.extern.slf4j.Slf4j; import org.springframework.http.ResponseEntity; import org.springframework.stereotype.Controller; import org.springframework.web.bind.annotation.RequestMapping; import java.util.HashMap; import java.util.Map; @Slf4j @Controller public class LoginController { @RequestMapping(\u0026#34;/login\u0026#34;) public ResponseEntity\u0026lt;Map\u0026lt;String, String\u0026gt;\u0026gt; login(String username, String password) { log.info(\u0026#34;username:{},password:{}\u0026#34;,username,password); Map\u0026lt;String, String\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); if (!\u0026#34;tom\u0026#34;.equals(username) || !\u0026#34;123\u0026#34;.equals(password)) { map.put(\u0026#34;msg\u0026#34;, \u0026#34;ç”¨æˆ·åå¯†ç é”™è¯¯\u0026#34;); return ResponseEntity.ok(map); } JwtUtil jwtUtil = new JwtUtil(\u0026#34;wdnmd\u0026#34;, SignatureAlgorithm.HS256); Map\u0026lt;String, Object\u0026gt; chaim = new HashMap\u0026lt;\u0026gt;(); chaim.put(\u0026#34;username\u0026#34;, username); // ç”Ÿå­˜æ—¶é—´åœ¨è¿™é‡Œè®¾ç½®  String jwtToken = jwtUtil.encode(username, 20*1000, chaim); map.put(\u0026#34;msg\u0026#34;, \u0026#34;ç™»å½•æˆåŠŸ\u0026#34;); map.put(\u0026#34;token\u0026#34;, jwtToken); return ResponseEntity.ok(map); } @RequestMapping(\u0026#34;/testdemo\u0026#34;) public ResponseEntity\u0026lt;String\u0026gt; testdemo() { return ResponseEntity.ok(\u0026#34;æˆ‘çˆ±è›‹ç‚’é¥­\u0026#34;); } } è¯·æ±‚ç™»å½•æ¥å£ï¼Œå¯†ç æ­£ç¡®åè¿”å›ä¸€ä¸ªtokenï¼Œä»¥åæ¯æ¬¡è¯·æ±‚å¸¦ä¸Šè¿™ä¸ªtokenä»¥headeré‡Œçš„Authorizationå­—æ®µçš„å½¢å¼\nä¹‹åçš„é¡µé¢éƒ½ä¼šç»è¿‡æ‹¦æˆªå™¨åˆ†é…åˆ°å¯¹åº”çš„è¿‡æ»¤å™¨è¿›è¡ŒéªŒè¯tokenæ˜¯å¦æœ‰æ•ˆï¼Œå®ç°äº†é‰´æƒã€‚\n","date":"2020-10-17T16:52:00+08:00","permalink":"https://ccqstark.github.io/p/springboot_shiro_jwt/","title":"[SpringBoot]æ•´åˆshiro+JWTåšé‰´æƒ"},{"content":"å¼€é€šæœåŠ¡ ç™»å½•é˜¿é‡Œäº‘ï¼Œå¼€é€šOSSæœåŠ¡ï¼Œé»˜è®¤æŒ‰é‡è®¡è´¹ï¼Œä¸ºäº†ä¸šåŠ¡ç¨³å®šå¯ä»¥è´­ä¹°åŒ…æœˆåŒ…å¹´çš„èµ„æºåŒ…ã€‚\nå‡†å¤‡å·¥ä½œ åˆ›å»ºBucketï¼Œå¦‚æœæ˜¯ä¸ºäº†ä½œä¸ºç½‘ç«™çš„é™æ€èµ„æºå­˜å‚¨ä¾›ç”¨æˆ·è®¿é—®çš„è¯æŠŠæƒé™è®¾ä¸ºå…¬å…±è¯»ï¼Œå¡«å†™ä¿¡æ¯ååˆ›å»ºæˆåŠŸï¼Œå¯ä»¥åœ¨Bucketä¸‹æ–°å»ºç›®å½•ä»€ä¹ˆçš„ã€‚\nå•ç‹¬åˆ›å»ºä¸€ä¸ªRAMå­ç”¨æˆ·ç”¨æ¥è°ƒç”¨APIï¼Œé€‰æ‹©ç¼–ç¨‹è®¿é—®ï¼Œåˆ›å»ºæˆåŠŸåä¸€å®šè¦æŠŠAccessKeyIDå’ŒAccessKeySecretç­‰é‡è¦ä¿¡æ¯è®°ä¸‹æ¥ï¼Œåé¢é…ç½®æ–‡ä»¶è¦ç”¨åˆ°ã€‚\nç„¶åè¦ç»™è¿™ä¸ªå­ç”¨æˆ·æ·»åŠ æƒé™AliyunOSSFullAccess\nMavenä¾èµ– \u0026lt;!-- OSS --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.aliyun.oss\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;aliyun-sdk-oss\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.4.2\u0026lt;/version\u0026gt; \u0026lt;exclusions\u0026gt; \u0026lt;exclusion\u0026gt; \u0026lt;groupId\u0026gt;org.apache.httpcomponents\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;httpclient\u0026lt;/artifactId\u0026gt; \u0026lt;/exclusion\u0026gt; \u0026lt;/exclusions\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.httpcomponents\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;httpclient\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.4.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; é…ç½®æ–‡ä»¶ endpointå°±æ˜¯åœ¨å­˜å‚¨æ¡¶çš„æ¦‚è§ˆé‡Œåœ°åŸŸèŠ‚ç‚¹ï¼Œå¡«å¤–ç½‘è®¿é—®é‚£ä¸ªå°±è¡Œ\nurlå¡«èµ„æºè®¿é—®çš„URLçš„å‰é¢éƒ¨åˆ†ï¼ˆå¡«åˆ°.com/ï¼‰\naccessKeyIdå’ŒaccessKeySecretå°±æ˜¯åˆ›å»ºå­ç”¨æˆ·æ—¶é‚£ä¸ª\nbucketNameå°±æ˜¯å­˜å‚¨æ¡¶çš„åå­—\n# é˜¿é‡Œäº‘ossoss:endpoint:*url:*accessKeyId:*accessKeySecret:*bucketName:*é…ç½®ç±» é¡¹ç›®çš„configç›®å½•ä¸‹æ–°å»ºOSSçš„é…ç½®ç±»\npackage com.ccqstark.springbootquick.config; import lombok.Data; import org.springframework.boot.context.properties.ConfigurationProperties; import org.springframework.context.annotation.Configuration; import org.springframework.stereotype.Component; import java.io.Serializable; /** * @Description: é˜¿é‡Œäº‘ OSS é…ç½®ä¿¡æ¯ * @Author: ccq * @Date: 2020/10/16 */ @Component //æ³¨å†Œbean @Data @Configuration @ConfigurationProperties(prefix = \u0026#34;oss\u0026#34;) public class OSSConfig implements Serializable { private String endpoint; private String url; private String accessKeyId; private String accessKeySecret; private String bucketName; } ä¸Šä¼ æ–‡ä»¶å·¥å…·ç±» é¡¹ç›®çš„utilç›®å½•ä¸‹æ–°å»ºè¿™ä¸Šä¼ å·¥å…·ç±»\npackage com.ccqstark.springbootquick.util; import com.aliyun.oss.ClientConfiguration; import com.aliyun.oss.OSSClient; import com.aliyun.oss.common.auth.DefaultCredentialProvider; import com.ccqstark.springbootquick.config.OSSConfig; import org.springframework.web.multipart.MultipartFile; import java.io.IOException; import java.util.UUID; /** * @Description: é˜¿é‡Œäº‘ oss ä¸Šä¼ å·¥å…·ç±»(é«˜ä¾èµ–ç‰ˆ) * @Author: ccq * @Date: 2020/10/17 */ public class OSSBootUtil { private OSSBootUtil(){} /** * oss å·¥å…·å®¢æˆ·ç«¯ */ private volatile static OSSClient ossClient = null; /** * ä¸Šä¼ æ–‡ä»¶è‡³é˜¿é‡Œäº‘ OSS * æ–‡ä»¶ä¸Šä¼ æˆåŠŸ,è¿”å›æ–‡ä»¶å®Œæ•´è®¿é—®è·¯å¾„ * æ–‡ä»¶ä¸Šä¼ å¤±è´¥,è¿”å› null * * @param ossConfig oss é…ç½®ä¿¡æ¯ * @param file å¾…ä¸Šä¼ æ–‡ä»¶ * @param fileDir æ–‡ä»¶ä¿å­˜ç›®å½• * @return oss ä¸­çš„ç›¸å¯¹æ–‡ä»¶è·¯å¾„ */ public static String upload(OSSConfig ossConfig, MultipartFile file, String fileDir){ // åˆå§‹åŒ–å®¢æˆ·ç«¯  initOSS(ossConfig); // æ–‡ä»¶URL  StringBuilder fileUrl = new StringBuilder(); try { String suffix = file.getOriginalFilename().substring(file.getOriginalFilename().lastIndexOf(\u0026#39;.\u0026#39;)); String fileName = System.currentTimeMillis() + \u0026#34;-\u0026#34; + UUID.randomUUID().toString().substring(0,18) + suffix; if (!fileDir.endsWith(\u0026#34;/\u0026#34;)) { fileDir = fileDir.concat(\u0026#34;/\u0026#34;); } fileUrl = fileUrl.append(fileDir + fileName); // ä¸Šä¼ æ–‡ä»¶åˆ°æŒ‡å®šçš„å­˜å‚¨ç©ºé—´ï¼Œå¹¶å°†å…¶ä¿å­˜ä¸ºæŒ‡å®šçš„æ–‡ä»¶åç§°  ossClient.putObject(ossConfig.getBucketName(), fileUrl.toString(), file.getInputStream()); } catch (IOException e) { e.printStackTrace(); return null; } fileUrl = fileUrl.insert(0,ossConfig.getUrl()); return fileUrl.toString(); } /** * åˆå§‹åŒ– oss å®¢æˆ·ç«¯ * @param ossConfig * @return */ private static OSSClient initOSS(OSSConfig ossConfig) { if (ossClient == null ) { synchronized (OSSBootUtil.class) { if (ossClient == null) { ossClient = new OSSClient(ossConfig.getEndpoint(), new DefaultCredentialProvider(ossConfig.getAccessKeyId(), ossConfig.getAccessKeySecret()), new ClientConfiguration()); } } } return ossClient; } } æœåŠ¡å±‚ åœ¨é¡¹ç›®çš„serviceç›®å½•ä¸‹æ–°å»ºæœåŠ¡å±‚æ¥å£\npackage com.ccqstark.springbootquick.service; import com.ccqstark.springbootquick.model.ApiResult; import org.springframework.web.multipart.MultipartFile; /** * @Description: å…¬å…±ä¸šåŠ¡ * @Author: ccq * @Date: 2020/10/17 */ public interface CommonService { /** * ä¸Šä¼ æ–‡ä»¶è‡³é˜¿é‡Œäº‘ oss * * @param file * @param uploadKey * @return * @throws Exception */ ApiResult uploadOSS(MultipartFile file, String uploadKey) throws Exception; } æ–°å»ºå®ç°ç±»\npackage com.ccqstark.springbootquick.service; import com.ccqstark.springbootquick.config.OSSConfig; import com.ccqstark.springbootquick.model.ApiResult; import com.ccqstark.springbootquick.util.OSSBootUtil; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.stereotype.Service; import org.springframework.web.multipart.MultipartFile; import java.util.HashMap; import java.util.Map; /** * @Description: å…¬å…±ä¸šåŠ¡å…·ä½“å®ç°ç±» * @Author: ccq * @Date: 2020/10/17 */ @Service(\u0026#34;commonService\u0026#34;) public class CommonServiceImpl implements CommonService { @Autowired private OSSConfig ossConfig; /** * ä¸Šä¼ æ–‡ä»¶è‡³é˜¿é‡Œäº‘ oss * * @param file * @param uploadKey * @return * @throws Exception */ @Override public ApiResult uploadOSS(MultipartFile file, String uploadKey) throws Exception { // é«˜ä¾èµ–ç‰ˆæœ¬ oss ä¸Šä¼ å·¥å…·  String ossFileUrlBoot = null; ossFileUrlBoot = OSSBootUtil.upload(ossConfig, file, \u0026#34;image/\u0026#34;); // æ³¨æ„è¿™é‡Œå¡«å†™çš„æ˜¯å­˜å‚¨æ¡¶ä¸­ä½ è¦å­˜æ”¾æ–‡ä»¶çš„ç›®å½•  Map\u0026lt;String, Object\u0026gt; resultMap = new HashMap\u0026lt;\u0026gt;(16); resultMap.put(\u0026#34;ossFileUrlBoot\u0026#34;, ossFileUrlBoot); return new ApiResult(200, resultMap); } } Controllerä¸Šä¼ æµ‹è¯• package com.ccqstark.springbootquick.controller; import com.ccqstark.springbootquick.model.ApiResult; import com.ccqstark.springbootquick.service.CommonService; import lombok.extern.slf4j.Slf4j; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.http.HttpHeaders; import org.springframework.http.HttpStatus; import org.springframework.http.MediaType; import org.springframework.http.ResponseEntity; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RequestMethod; import org.springframework.web.bind.annotation.RequestParam; import org.springframework.web.bind.annotation.RestController; import org.springframework.web.multipart.MultipartFile; /** * @Description: ä¸Šä¼ æ–‡ä»¶ * @Author: ccq * @Date: 2020/10/17 */ @Slf4j @RestController @RequestMapping(\u0026#34;/upload\u0026#34;) public class UploadController { @Autowired private CommonService commonService; /** * ä¸Šä¼ æ–‡ä»¶è‡³é˜¿é‡Œäº‘ oss * * @param file * @param uploadKey * @return * @throws Exception */ @RequestMapping(value = \u0026#34;/oss\u0026#34;, method = {RequestMethod.POST}, produces = {MediaType.APPLICATION_JSON_VALUE}) public ResponseEntity\u0026lt;?\u0026gt; uploadOSS(@RequestParam(value = \u0026#34;file\u0026#34;) MultipartFile file, String uploadKey) throws Exception { ApiResult apiResult = commonService.uploadOSS(file, uploadKey); HttpHeaders headers = new HttpHeaders(); headers.setContentType(MediaType.APPLICATION_JSON); return new ResponseEntity\u0026lt;\u0026gt;(apiResult, headers, HttpStatus.CREATED); } } Postmanå·¥å…·ï¼Œç”¨POSTè¯·æ±‚ï¼Œåœ¨form-dataä¸­ç”¨fileå­—æ®µå¯¹åº”å›¾ç‰‡æˆ–å…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œç„¶åè¯·æ±‚æ¥å£\nè¿”å›çš„URLåœ¨æµè§ˆå™¨ä¸­å¯ä»¥ç”¨å…¬ç½‘è®¿é—®è¯´æ˜æˆåŠŸäº†ï¼\n","date":"2020-10-17T10:54:00+08:00","permalink":"https://ccqstark.github.io/p/springboot_oss/","title":"[SpringBoot]ä½¿ç”¨é˜¿é‡Œäº‘OSSä¸Šä¼ æ–‡ä»¶"},{"content":"æ·»åŠ ä¾èµ– \u0026lt;!-- druidæ•°æ®åº“è¿æ¥æ±  --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;druid\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.1.21\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- MySqlæ•°æ®åº“é©±åŠ¨ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;mysql\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mysql-connector-java\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!--åˆ†é¡µæ’ä»¶ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.github.pagehelper\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;pagehelper-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- log4jæ—¥å¿— --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;log4j\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;log4j\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.17\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; æ·»åŠ é…ç½® spring:datasource:username:rootpassword:root#serverTimezone=UTCè§£å†³æ—¶åŒºçš„æŠ¥é”™url:jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC\u0026amp;useUnicode=true\u0026amp;characterEncoding=utf-8driver-class-name:com.mysql.cj.jdbc.Drivertype:com.alibaba.druid.pool.DruidDataSource#Spring Boot é»˜è®¤æ˜¯ä¸æ³¨å…¥è¿™äº›å±æ€§å€¼çš„ï¼Œéœ€è¦è‡ªå·±ç»‘å®š#druid æ•°æ®æºä¸“æœ‰é…ç½®initialSize:5minIdle:5maxActive:20maxWait:60000timeBetweenEvictionRunsMillis:60000minEvictableIdleTimeMillis:300000validationQuery:SELECT 1 FROM DUALtestWhileIdle:truetestOnBorrow:falsetestOnReturn:falsepoolPreparedStatements:true#é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filtersï¼Œstat:ç›‘æ§ç»Ÿè®¡ã€log4jï¼šæ—¥å¿—è®°å½•ã€wallï¼šé˜²å¾¡sqlæ³¨å…¥#å¦‚æœå…è®¸æ—¶æŠ¥é”™ java.lang.ClassNotFoundException: org.apache.log4j.Priority#åˆ™å¯¼å…¥ log4j ä¾èµ–å³å¯ï¼ŒMaven åœ°å€ï¼šhttps://mvnrepository.com/artifact/log4j/log4jfilters:stat,wall,log4jmaxPoolPreparedStatementPerConnectionSize:20useGlobalDataSourceStat:trueconnectionProperties:druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500æµ‹è¯• ç¼–å†™æµ‹è¯•ç±»\n@SpringBootTest class SpringbootQuickApplicationTests { @Autowired DataSource dataSource; @Test void contextLoads() throws SQLException { System.out.println(dataSource.getClass()); Connection connection = dataSource.getConnection(); System.out.println(connection); connection.close(); } } è¿è¡Œåæ§åˆ¶å°å‡ºç°å¦‚ä¸‹druidè¿æ¥æ± ç›¸å…³å­—æ ·è¯´æ˜æˆåŠŸ\n2020-10-15 10:40:34.179 INFO 11352 --- [ main] com.alibaba.druid.pool.DruidDataSource : {dataSource-1} inited\rDEBUG [main] - {conn-10005} pool-connect\rcom.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@31db34da\rDEBUG [main] - {conn-10005} pool-recycle\ræ·»åŠ åå°ç›‘æ§ é¡¹ç›®åº”ç”¨ç›®å½•ä¸‹çš„cofigç›®å½•æ·»åŠ \n@Configuration public class DruidConfig { @ConfigurationProperties(prefix = \u0026#34;spring.datasource\u0026#34;) @Bean public DataSource druidDataSource(){ return new DruidDataSource(); } @Bean // åå°ç›‘æ§  public ServletRegistrationBean statViewServlet(){ ServletRegistrationBean\u0026lt;StatViewServlet\u0026gt; bean = new ServletRegistrationBean\u0026lt;\u0026gt;(new StatViewServlet(),\u0026#34;/druid/*\u0026#34;); // å­˜å‚¨è´¦å·å¯†ç   HashMap\u0026lt;String,String\u0026gt; initParameters = new HashMap\u0026lt;\u0026gt;(); // è®¾ç½®åå°ç™»å½•è´¦å·å¯†ç   initParameters.put(\u0026#34;loginUsername\u0026#34;,\u0026#34;admin\u0026#34;); initParameters.put(\u0026#34;loginPassword\u0026#34;,\u0026#34;123456\u0026#34;); // è°éƒ½å¯ä»¥è®¿é—®  initParameters.put(\u0026#34;allow\u0026#34;,\u0026#34;\u0026#34;); bean.setInitParameters(initParameters); // è®¾ç½®åˆå§‹åŒ–å‚æ•°  return bean; } // filter  public FilterRegistrationBean webStatFilter(){ FilterRegistrationBean bean = new FilterRegistrationBean(); bean.setFilter(new WebStatFilter()); // è¢«è¿‡æ»¤çš„è¯·æ±‚  Map\u0026lt;String,String\u0026gt; initParameters = new HashMap\u0026lt;\u0026gt;(); initParameters.put(\u0026#34;exclusions\u0026#34;,\u0026#34;*.js,*.css,/druid/*\u0026#34;); bean.setInitParameters(initParameters); return bean; } } è¿è¡Œé¡¹ç›®åæ‰“å¼€localhost:8080/druid/å‡ºç°åå°ç›‘æ§ç™»å½•é¡µé¢è¯´æ˜æˆåŠŸ\n","date":"2020-10-17T10:54:00+08:00","permalink":"https://ccqstark.github.io/p/springboot_druid/","title":"[SpringBoot]æ•´åˆDruidæ•°æ®æº"},{"content":"ä»¥æˆ‘çš„é¡¹ç›®ç›®å½•ç»“æ„ä¸ºä¾‹: com.ccqstark.springbootquick\nå¯¼å…¥ä¾èµ– \u0026lt;!-- springbootçš„mybatis --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.mybatis.spring.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.1.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; é…ç½® #æ•´åˆmybatismybatis:type-aliases-package:com.ccqstark.springbootquick.pojomapper-locations:classpath:mybatis/mapper/*.xmlç¼–å†™POJO(ç”¨äº†Lombok) åœ¨com.ccqstark.springbootquickä¸‹æ–°å»ºç›®å½•pojoï¼Œç„¶åæ–°å»ºç±»User.javaï¼Œç”¨äºå­˜å‚¨æ•°æ®çš„å¯¹è±¡ï¼ˆä¸æ•°æ®åº“ä¸­çš„è¡¨å¯¹åº”ï¼‰\npackage com.ccqstark.springbootquick.pojo; import lombok.AllArgsConstructor; import lombok.Data; import lombok.NoArgsConstructor; @Data @NoArgsConstructor @AllArgsConstructor public class User { private int id; private String name; private String pwd; } ç¼–å†™Mapper åœ¨com.ccqstark.springbootquickä¸‹æ–°å»ºç›®å½•mapperï¼Œç„¶åæ–°å»ºUserMapper.javaï¼Œç”¨äºå†™æ¥å£ï¼ŒCRUDå‡½æ•°\npackage com.ccqstark.springbootquick.mapper; import com.ccqstark.springbootquick.pojo.User; import org.apache.ibatis.annotations.Mapper; import org.springframework.stereotype.Repository; import java.util.List; // Mapperæ³¨è§£è¯´æ˜è¿™æ˜¯ä¸€ä¸ªmybatisçš„mapperç±» //@Mapper //å¦‚æœæœ‰æ‰«æçš„è¯è¿™é‡Œå¯ä»¥ä¸ç”¨å†™è¿™ä¸ªæ³¨è§£äº† @Repository public interface UserMapper { List\u0026lt;User\u0026gt; queryUserList(); User queryByUserId(int id); int addUser(User user); int updateUser(User user); int deleteUser(int id); } å¦‚æœæ˜¯ä»¥æ‰«æçš„å½¢å¼ï¼Œå°±æ˜¯åœ¨é¡¹ç›®çš„appå¯åŠ¨ç±»åŠ ä¸Šæ³¨è§£**@MapperScan**\n@SpringBootApplication // ä¹Ÿå¯ä»¥ç”¨ç€æ–¹å¼æ‰«æï¼Œå°±ä¸ç”¨ä¸€ä¸ªä¸ªå†™@Mapperäº† @MapperScan(\u0026#34;com.ccqstark.springbootquick.mapper\u0026#34;) public class SpringbootQuickApplication { public static void main(String[] args) { SpringApplication.run(SpringbootQuickApplication.class, args); } } åœ¨XMLé‡Œç¼–å†™SQLè¯­å¥ åœ¨resourcesç›®å½•ä¸‹æ–°å»ºmybatis/mapperç›®å½•ï¼Œå†åœ¨ä¸‹é¢æ–°å»ºxmlæ–‡ä»¶ï¼Œå¦‚è¿™é‡Œçš„UserMapper.xmlï¼Œåœ¨é‡Œé¢è®°å¾—é…å¥½namespaceï¼Œç„¶åå°±å¯ä»¥å†™è‡ªå®šä¹‰SQLè¯­å¥å•¦\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.ccqstark.springbootquick.mapper.UserMapper\u0026#34;\u0026gt; \u0026lt;!-- namespaceè¦é…å¥½ï¼Œå¦‚ä¸Šé¢çš„æ ¼å¼ï¼Œå¯¹åº”æºç ç›®å½•ä¸­çš„mapperæ¥å£ --\u0026gt; \u0026lt;!-- ä¸‹é¢å°±æ˜¯CRUDçš„SQLè¯­å¥ --\u0026gt; \u0026lt;!-- idå¯¹åº”çš„å°±æ˜¯æ¥å£å®šä¹‰çš„å‡½æ•°å --\u0026gt; \u0026lt;select id=\u0026#34;queryUserList\u0026#34; resultType=\u0026#34;User\u0026#34;\u0026gt; // idå¯¹ç°æœ‰ SELECT * FROM user \u0026lt;/select\u0026gt; \u0026lt;!-- #{id}å°±æ˜¯æ¨¡æ¿å¾…å¡«ç©ºä½--\u0026gt; \u0026lt;select id=\u0026#34;queryByUserId\u0026#34; resultType=\u0026#34;User\u0026#34;\u0026gt; SELECT * FROM user WHERE id = #{id} \u0026lt;/select\u0026gt; \u0026lt;insert id=\u0026#34;addUser\u0026#34; parameterType=\u0026#34;User\u0026#34;\u0026gt; INSERT into user (id,name,pwd) values (#{id},#{name},#{pwd}) \u0026lt;/insert\u0026gt; \u0026lt;update id=\u0026#34;updateUser\u0026#34; parameterType=\u0026#34;User\u0026#34;\u0026gt; UPDATE user SET name=#{name},pwd=#{pwd} where id = #{id} \u0026lt;/update\u0026gt; \u0026lt;delete id=\u0026#34;deleteUser\u0026#34; parameterType=\u0026#34;int\u0026#34;\u0026gt; DELETE FROM user WHERE id = #{id} \u0026lt;/delete\u0026gt; \u0026lt;/mapper\u0026gt; è°ƒç”¨æ¥è¿›è¡ŒCRUD åœ¨Controlleræˆ–è€…Serviceé‡Œè°ƒç”¨Mybatisè¿›è¡ŒCRUDï¼Œå…ˆ@Autowiredæ³¨å…¥ä¸€ä¸ªMapperï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªæ¥å£ç±»å‹æŒ‡å‘çš„å¯¹è±¡å°±å¯ä»¥è°ƒç”¨æ¥å£é‡Œé¢çš„æ–¹æ³•äº†ã€‚è¿™äº›æ–¹æ³•å¯¹åº”çš„sqlè¯­å¥æ“ä½œå°±æ˜¯åœ¨xmlä¸­å®šä¹‰çš„ã€‚\n@RestController @RequestMapping(\u0026#34;/mybatis\u0026#34;) public class UserController { @Autowired private UserMapper userMapper; @PostMapping(\u0026#34;/query\u0026#34;) public List\u0026lt;User\u0026gt; queryUserList(){ List\u0026lt;User\u0026gt; userList = userMapper.queryUserList(); return userList; } @PostMapping(\u0026#34;/create\u0026#34;) public String createUser(){ userMapper.addUser(new User(4,\u0026#34;wuhu\u0026#34;,\u0026#34;5555\u0026#34;)); return \u0026#34;ok\u0026#34;; } @PostMapping(\u0026#34;/update\u0026#34;) public String updateUser(){ userMapper.updateUser(new User(1,\u0026#34;qqq\u0026#34;,\u0026#34;33\u0026#34;)); return \u0026#34;ok\u0026#34;; } @PostMapping(\u0026#34;/delete\u0026#34;) public String deleteUser(){ userMapper.deleteUser(4); return \u0026#34;ok\u0026#34;; } } ","date":"2020-10-17T10:54:00+08:00","permalink":"https://ccqstark.github.io/p/springboot_mybatis/","title":"[SpringBoot]æ•´åˆMybatis"},{"content":"å¯¼å…¥ä¾èµ– \u0026lt;!-- SLF4j - log4j --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.slf4j\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;slf4j-log4j12\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.8.0-alpha2\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; ç„¶åè¦åœ¨IDEAä¸‹è½½æ’ä»¶Maven Helperä¸­æŠŠlogbackç›¸å…³çš„åŒ…ç»™Excludeï¼Œå¦åˆ™ä¼šå‡ºç°å†²çª\né…ç½® log4j.propertiesä¸­é…ç½®\n# rootLoggerå‚æ•°åˆ†åˆ«ä¸ºï¼šæ ¹Loggerçº§åˆ«ï¼Œè¾“å‡ºå™¨stdoutï¼Œè¾“å‡ºå™¨log\rlog4j.rootLogger = info,stdout,log\r# è¾“å‡ºä¿¡æ¯åˆ°æ§åˆ¶å°\rlog4j.appender.stdout = org.apache.log4j.ConsoleAppender\rlog4j.appender.stdout.layout = org.apache.log4j.PatternLayout\rlog4j.appender.stdout.layout.ConversionPattern = %d [%-5p] %l %rms: %m%n\r# è¾“å‡ºDEBUGçº§åˆ«ä»¥ä¸Šçš„æ—¥å¿—åˆ°D://log/debug.logï¼Œè¿™ä¸ªæ˜¯æ—¥å¿—æ–‡ä»¶å­˜æ”¾çš„è·¯å¾„ï¼Œæ ¹æ®æ—¶é—´æƒ…å†µè¿›è¡Œè®¾ç½®\rlog4j.appender.log = org.apache.log4j.DailyRollingFileAppender\rlog4j.appender.log.DatePattern = '.'yyyy-MM-dd\rlog4j.appender.log.File = D://log/debug.log\rlog4j.appender.log.Encoding = UTF-8\r#log4j.appender.log.Threshold = INFO\rlog4j.appender.log.layout = org.apache.log4j.PatternLayout\rlog4j.appender.log.layout.ConversionPattern = %d [%-5p] (%c.%t): %m%n\ræµ‹è¯• ç¼–å†™æµ‹è¯•ç±»ï¼Œä½¿ç”¨@Slf4jæ³¨è§£ä¹‹å‰ç¡®ä¿ä½¿ç”¨äº†lombok\npackage com.ccqstark.springbootquick; import lombok.extern.slf4j.Slf4j; import org.junit.Test; @Slf4j public class LoggerTest { // private static final Logger log = LoggerFactory.getLogger(LoggerTest.class);  @Test public void TestSLF4j(){ log.info(\u0026#34;Current Time: {}\u0026#34;, System.currentTimeMillis()); log.info(\u0026#34;Current Time: \u0026#34; + System.currentTimeMillis()); log.info(\u0026#34;Current Time: {}\u0026#34;, System.currentTimeMillis()); log.trace(\u0026#34;trace log\u0026#34;); log.warn(\u0026#34;warn log\u0026#34;); log.debug(\u0026#34;debug log\u0026#34;); log.info(\u0026#34;info log\u0026#34;); log.error(\u0026#34;error log\u0026#34;); } } è¿è¡Œåè¾“å‡ºä»¥ä¸‹è¯´æ˜æˆåŠŸ\n2020-10-15 16:36:45,459 [INFO ] com.ccqstark.springbootquick.LoggerTest.TestSLF4j(LoggerTest.java:13) 0ms: Current Time: 1602751005450\r2020-10-15 16:36:45,464 [INFO ] com.ccqstark.springbootquick.LoggerTest.TestSLF4j(LoggerTest.java:14) 5ms: Current Time: 1602751005464\r2020-10-15 16:36:45,465 [INFO ] com.ccqstark.springbootquick.LoggerTest.TestSLF4j(LoggerTest.java:15) 6ms: Current Time: 1602751005465\r2020-10-15 16:36:45,466 [WARN ] com.ccqstark.springbootquick.LoggerTest.TestSLF4j(LoggerTest.java:17) 7ms: warn log\r2020-10-15 16:36:45,466 [INFO ] com.ccqstark.springbootquick.LoggerTest.TestSLF4j(LoggerTest.java:19) 7ms: info log\r2020-10-15 16:36:45,468 [ERROR] com.ccqstark.springbootquick.LoggerTest.TestSLF4j(LoggerTest.java:20) 9ms: error log\rç”¨æ³• æ·»åŠ æ³¨è§£@Slf4jï¼ˆç¡®ä¿ä½¿ç”¨äº†lombokï¼‰\nç„¶åå¦‚æµ‹è¯•ç±»ä¸­log.infoæˆ–å…¶ä»–ç±»å‹çš„æ—¥å¿—ä¾¿å¯ä»¥ä½¿ç”¨äº†\n","date":"2020-10-17T10:54:00+08:00","permalink":"https://ccqstark.github.io/p/springboot_slf4j-log4j/","title":"[SpringBoot]æ•´åˆSLF4J-log4j"},{"content":"é—®é¢˜å¼•å…¥ å­¦è¿‡çº¿æ€§ä»£æ•°éƒ½çŸ¥é“çŸ©é˜µçš„ä¹˜æ³•ï¼Œæ¯”å¦‚è¯´çŸ©é˜µAÃ—Bï¼Œå°±æ˜¯Açš„æ¯ä¸€è¡Œä¸Šçš„å…ƒç´ åˆ†åˆ«å’ŒBçš„æ¯ä¸€åˆ—ä¸Šå¯¹åº”ä½ç½®çš„å…ƒç´ ç›¸ä¹˜å†æ€»ä½“ç›¸åŠ ï¼Œæ¯æ¬¡å¾—åˆ°ä¸€ä¸ªä½ç½®ä¸Šçš„å…ƒç´ çš„å€¼ã€‚\nå‡è®¾Aæ˜¯p Ã— qï¼ŒBæ˜¯q Ã— rï¼Œé‚£ç»“æœçŸ©é˜µå°±æ˜¯p Ã— rï¼Œå½“ç„¶ï¼Œèƒ½å¤Ÿç›¸ä¹˜çš„æ¡ä»¶æ˜¯Açš„åˆ—æ•°ç­‰äºBçš„è¡Œæ•°ã€‚\nè€ŒAÃ—Bæ€»å…±éœ€è¦åšçš„ä¹˜æ³•æ•°æ˜¯p Ã— q Ã— rï¼Œç”±çŸ©é˜µä¹˜æ³•çš„è¿‡ç¨‹å¯çŸ¥ã€‚\nå¯ä»¥å‘ç°ï¼Œå½“è‡³å°‘3ä¸ªçŸ©é˜µç›¸ä¹˜æ—¶ï¼Œæ¯”å¦‚ABCï¼Œ(AB)Cå’Œ(A)BCä¸¤ç§è®¡ç®—é¡ºåºæ‰€éœ€åšçš„ä¹˜æ³•æ•°æ˜¯ä¸åŒçš„ã€‚\nç°åœ¨çš„é—®é¢˜æ˜¯ä¸€ä¸ªçŸ©é˜µé“¾ï¼Œæ¯”å¦‚A Ã— B Ã— C Ã— D Ã— E Ã— F Ã— Gï¼Œè¦ä»¥ä»€ä¹ˆæ ·çš„é¡ºåºç›¸ä¹˜æ‰èƒ½å¾—ä½¿å¾—æ‰€éœ€åšçš„ä¹˜æ³•æ•°æœ€å°å‘¢ï¼Ÿ\né¢˜ç›® è¾“å…¥æ ¼å¼: æ¯ä¸ªè¾“å…¥æ–‡ä»¶ä¸ºä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹çš„ç¬¬ä¸€è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•°(1â‰¤nâ‰¤100)ï¼Œè¡¨ç¤ºä¸€å…±æœ‰nä¸ªçŸ©é˜µAâ€‹1â€‹â€‹ ,Aâ€‹2â€‹â€‹ ,â€¦,Aâ€‹nâ€‹â€‹ ï¼Œç¬¬äºŒè¡Œç»™å‡ºn+1ä¸ªæ•´æ•°Pâ€‹0â€‹â€‹ ,Pâ€‹1â€‹â€‹ â€¦Pâ€‹nâ€‹â€‹ ï¼Œä»¥ç©ºæ ¼åˆ†éš”ï¼Œå…¶ä¸­1â‰¤Pâ€‹iâ€‹â€‹ â‰¤100(0â‰¤iâ‰¤n)ï¼Œç¬¬iä¸ªçŸ©é˜µAâ€‹iâ€‹â€‹ æ˜¯é˜¶ä¸ºPâ€‹iâˆ’1â€‹â€‹ âˆ—Pâ€‹iâ€‹â€‹ çš„çŸ©é˜µã€‚\nè¾“å‡ºæ ¼å¼: è·å¾—ä¸Šè¿°çŸ©é˜µçš„ä¹˜ç§¯ï¼Œæ‰€éœ€çš„æœ€å°‘ä¹˜æ³•æ¬¡æ•°ã€‚\nè¾“å…¥æ ·ä¾‹: åœ¨è¿™é‡Œç»™å‡ºä¸€ç»„è¾“å…¥ã€‚ä¾‹å¦‚ï¼š\n 5\n30 35 15 5 10 20\n è¾“å‡ºæ ·ä¾‹: åœ¨è¿™é‡Œç»™å‡ºç›¸åº”çš„è¾“å‡ºã€‚ä¾‹å¦‚ï¼š\n 11875\n æ€è·¯ å¯ä»¥å…ˆæ±‚2ä¸ª2ä¸ªç›¸é‚»ç›¸ä¹˜çš„å€¼ï¼Œç„¶åç”¨ä»–ä»¬æ±‚3ä¸ª3ä¸ªç›¸ä¹˜çš„ï¼Œå†4ä¸ª\u0026hellip;ä¾ç…§æ­¤è§„å¾‹ç›´åˆ°nä¸ª\nå½“å‰ä¸ªæ•°é˜¶æ®µä¹Ÿéœ€è¦æŠŠæ¯ç§åˆ’åˆ†æ–¹æ¡ˆè¿›è¡Œå°è¯•ï¼Œå¹¶å¾—å‡ºæœ€å°çš„é‚£ç§ã€‚æ¯”å¦‚æˆ‘åœ¨ç®—4ä¸ª4ä¸ªç›¸ä¹˜çš„ï¼Œé‚£åˆ’åˆ†ä½ç½®å°±æœ‰3ä¸ªï¼Œæ¯ä¸ªéƒ½è¦éå†ç®—ä¸€æ¬¡ï¼Œæœ€åé€‰æœ€å°é‚£ä¸ªï¼Œä¸ºä¸‹ä¸€é˜¶æ®µä½¿ç”¨ã€‚\næˆ‘ä»¬åˆ©ç”¨äºŒç»´æ•°ç»„m[i][j]è¡¨ç¤ºç¬¬iä¸ªåˆ°ç¬¬jä¸ªçŸ©é˜µè¿ä¹˜çš„æœ€ä¼˜è§£ï¼Œæœ‰å¦‚ä¸‹å…¬å¼ã€‚\nå°±æ˜¯æ¯æ¬¡åˆ’åˆ†ä¸º2éƒ¨åˆ†ï¼Œæ•´ä½“æœ€ä¼˜è§£=å·¦éƒ¨åˆ†æœ€ä¼˜è§£+å³éƒ¨åˆ†çš„æœ€ä¼˜è§£+ä¸¤è€…ç›¸ä¹˜æ‰€éœ€ä¹˜æ³•æ•°\nçŸ©é˜µiçš„è¡Œæ•°ä¸ºp[i-1]ï¼Œåˆ—æ•°ä¸ºp[i]\n \næˆ‘ä»¬ç”¨ä¸€ä¸ªäºŒç»´çŸ©é˜µæ¥å­˜å‚¨å„é˜¶æ®µç»“æœï¼Œæ•°æ®å°±ä¸€æ­¥æ­¥å¾€å³ä¸Šè§’å¡«ä¸Šå»ï¼Œæœ€ç»ˆç­”æ¡ˆå°±åœ¨æœ€å³ä¸Šè§’ã€‚\nä»£ç  // çŸ©é˜µé“¾ç›¸ä¹˜é—®é¢˜ #include \u0026lt;iostream\u0026gt;#include \u0026lt;string.h\u0026gt;using namespace std; const int MAX = 1000; int p[MAX]; // å­˜æ”¾è¡Œåˆ—æ•°ï¼Œå°±æ˜¯é¢˜ç›®è¾“å…¥çš„åºåˆ— int m[MAX][MAX]; // å­˜æ”¾å±€éƒ¨å’Œæœ€ç»ˆç»“æœçš„çŸ©é˜µ int n; // éœ€è¦ç›¸ä¹˜çš„çŸ©é˜µä¸ªæ•°  void matrix() { memset(m, 0, sizeof(m)); // åˆå§‹åŒ–çŸ©é˜µä¸º0  // åŒæ—¶è¿ç»­ç›¸ä¹˜çš„ä¸ªæ•°  for (int r = 2; r \u0026lt;= n; r++) { // ä»ç¬¬å‡ ä¸ªå¼€å§‹(åˆ°ç¬¬å‡ ç»„äº†)  for (int i = 1; i \u0026lt;= n - r + 1; i++) { // ç›¸ä¹˜é“¾çš„æœ€åä¸€ä¸ª  int j = i + r - 1; // ä¸ºäº†é€šè¿‡æ¯”è¾ƒä»è€Œå¾—å‡ºæœ€å°çš„é‚£ä¸ªï¼Œè¦æœ‰ä¸€ä¸ªæ¯”è¾ƒçš„åˆå€¼ï¼Œè¿™é‡Œæ˜¯åˆ’åˆ†ç¬¬ä¸€ä¸ªå’Œå…¶ä½™çš„ä¸º2ç»„  m[i][j] = m[i + 1][j] + p[i - 1] * p[i] * p[j]; // ä¸€æ­¥æ­¥ç§»åŠ¨åˆ’åˆ†ç‚¹  for (int k = i + 1; k \u0026lt; j; k++) { // ä»¥kä½ç½®ä¸ºåˆ’åˆ†ç‚¹ï¼Œåˆ’åˆ†iåˆ°jçš„ç›¸ä¹˜é“¾  int t = m[i][k] + m[k + 1][j] + p[i - 1] * p[k] * p[j]; // æ¯”è¾ƒæ‰¾å‡ºæœ€å°çš„é‚£ä¸ª  if (t \u0026lt; m[i][j]) { m[i][j] = t; } } } } } int main() { cin \u0026gt;\u0026gt; n; // è¾“å…¥çš„æ•°å­—æ€»æ•°æ¯”çŸ©é˜µä¸ªæ•°å¤š1  for (int i = 0; i \u0026lt; n + 1; i++) { cin \u0026gt;\u0026gt; p[i]; } matrix(); // æœ€åç­”æ¡ˆä¼šåœ¨å³ä¸Šè§’å‡ºç°  cout \u0026lt;\u0026lt; m[1][n]; } å‚è€ƒåšæ–‡\n","date":"2020-10-12T21:07:00+08:00","permalink":"https://ccqstark.github.io/p/dp_matrix/","title":"DPåŠ¨æ€è§„åˆ’â€”â€”çŸ©é˜µé“¾ç›¸ä¹˜é—®é¢˜"},{"content":"â€œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨â€ï¼Œä½œä¸ºåç«¯æ¬ç –å·¥ï¼Œæˆ‘ä»¬æ•²ä»£ç ä¹‹å‰éœ€è¦ç»™æˆ‘ä»¬çš„ç”µè„‘é…ä¸Šæ‰€éœ€çš„è½¯ä»¶ç¯å¢ƒï¼Œè¿™æ ·æˆ‘ä»¬å†™çš„ä»£ç æ‰èƒ½è·‘èµ·æ¥ï¼ŒåŸåœ°èµ·é£ï¼\nä¸‹è½½é›†æˆç¯å¢ƒå·¥å…· å¯ä»¥é€‰æ‹©xamppæˆ–phpenvï¼ˆäºŒé€‰ä¸€å°±è¡Œï¼‰\nxampp xampp = Apache + MySQL(MariaDB) + PHP + Perlï¼Œæ˜¯ä¸€ä¸ªé›†æˆç¯å¢ƒè½¯ä»¶ï¼Œè£…äº†ä¸€ä¸ªå°±å¯ä»¥è½»æ¾è·å¾—æœåŠ¡å™¨ï¼Œæ•°æ®åº“å’Œphpè¯­è¨€çš„ç¯å¢ƒï¼Œè½»æ¾å¿«æ·è€Œä¸”å…è´¹ï¼Œå”¯ä¸€çš„ç¼ºç‚¹å¯èƒ½æ˜¯å› ä¸ºæ˜¯å¤–ç½‘æ‰€ä»¥é€Ÿåº¦ç¨æ…¢æˆ–è€…å¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘\nå®˜ç½‘ä¸‹è½½ï¼šhttps://www.apachefriends.org/zh_cn/index.html\né€‰æ‹©è‡ªå·±çš„å¹³å°ï¼Œç„¶åç‚¹å‡»ä¸‹è½½ï¼Œå®Œæˆåè¿è¡Œexe\næŒ‰æ™®é€šå®‰è£…æ­¥éª¤æ¥å°±å¥½ï¼Œä¸‹é¢è¿™ä¸ªç•Œé¢ä¹Ÿé»˜è®¤é€‰æ‹©å°±å¥½ï¼Œæœ‰äº›ç¯å¢ƒä¹‹åä¼šç”¨åˆ°\n \nå®‰è£…è·¯å¾„å»ºè®®å®‰è£…åœ¨Dç›˜ï¼Œç„¶åç­‰å¾…å®‰è£…å®Œæˆå°±å¯ä»¥äº†ï¼Œæ‰“å¼€è½¯ä»¶çœ‹åˆ°ä¸»é¢æ¿\n \nç‚¹å‡»Apacheå’ŒstartæŒ‰é’®ï¼Œç­‰å¾…å›¾æ ‡å˜ç»¿åå†ç‚¹å‡»adminæŒ‰é’®æˆ–è€…æµè§ˆå™¨åœ°å€æ è¾“å…¥localhostè¿›è¡Œè®¿é—®\nå¦‚æœå¯ä»¥çœ‹åˆ°æœåŠ¡å™¨ä¸»é¡µé¢è¯´æ˜æˆåŠŸ\nç„¶åç‚¹å‡»MySQLçš„startå’Œadminï¼Œæˆ–è€…åœ°å€æ è¾“å…¥localhost/phpmyadmin/\nå‡ºç°ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œè´¦å·å¡«å†™rootï¼Œå¯†ç ä¸ºç©ºä¸ç”¨å¡«ï¼Œç›´æ¥ç‚¹å‡»ç™»å½•ï¼Œå‡ºç°ä¸‹é¢ç”»é¢è¯´æ˜æˆåŠŸ\n \nphpEnv å¦‚æœxamppå®åœ¨å¤ªæ…¢æˆ–è€…æ ¹æœ¬æ— æ³•ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥ç”¨phpEnv\nå®˜ç½‘ä¸‹è½½ï¼šhttps://www.phpenv.cn/\næ ¹æ®ä½ ç”µè„‘æ˜¯64ä½æˆ–è€…32ä½è¿›è¡Œé€‰æ‹©å¯¹åº”ç‰ˆæœ¬ä¸‹è½½ï¼Œå¦‚æœä¸çŸ¥é“è‡ªå·±ç”µè„‘æ˜¯å‡ ä½çš„å¯ä»¥ç‚¹å‡»æ•™ç¨‹æŸ¥çœ‹\nåŒæ ·å»ºè®®æ”¾åœ¨Dç›˜ï¼Œå…¶å®ƒçš„é»˜è®¤å°±è¡Œï¼Œè¿è¡Œåå‡ºç°ä¸‹é¢ç•Œé¢\n \nç‚¹å‡»å¯åŠ¨æœåŠ¡ä¸Šé¢çš„å›¾æ ‡ï¼Œå†ç‚¹å‡»æ‰“å¼€ä¸»é¡µçš„å›¾æ ‡ï¼Œçœ‹åˆ°phpEnvçš„ä¸»é¡µé¢å°±è¯´æ˜æˆåŠŸäº†\né¡µé¢æ‹‰åˆ°æœ€ä¸‹é¢å¦‚ä¸‹\n \næ•°æ®åº“ç«¯å£å¡«3306\nç”¨æˆ·åå¡«root\nå¯†ç ä¹Ÿå¡«rootï¼ˆæ³¨æ„ï¼šè¿™é‡Œå’Œxamppä¸ä¸€æ ·ï¼‰\nç‚¹å‡»è¿æ¥æŒ‰é’®åå†æŠŠé¡µé¢æ‹‰åˆ°æœ€ä¸‹é¢æ˜¾ç¤ºè¿æ¥æˆåŠŸå°±è¡Œå•¦\nç‚¹å‡»é¡¶éƒ¨èœå•æ çš„å¼€å§‹ï¼Œå†ç‚¹å‡»phpMyAdminï¼Œç„¶åæŒ‰ä¸Šé¢xamppçš„å¯¹åº”å†…å®¹æ“ä½œå°±è¡Œ\nå®‰è£…IDE IDE(Integrated Development Environment)ï¼Œé›†æˆå¼€å‘ç¯å¢ƒï¼Œä¸ºå¼€å‘è€…æä¾›äº†åŸºæœ¬çš„ä»£ç ç¼–è¾‘å™¨çš„åŒæ—¶è¿˜æä¾›äº†è®¸å¤šé€‚ç”¨å·¥å…·ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œæ˜¯ç å†œå¼€å‘çš„åˆ©å™¨ã€‚\nphpè¯­è¨€æˆ‘ä»¬ä½¿ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯JetBrainså…¬å¸å‡ºçš„PhpStorm\nå®˜ç½‘ä¸‹è½½ï¼šhttps://www.jetbrains.com/phpstorm/\nè½¯ä»¶ä½“ç§¯è¾ƒå¤§ï¼Œå¦‚æœä½ ä¸æƒ³è£…å®ƒçš„è¯å¯ä»¥è‡ªå·±ä¸‹è½½VSCodeç„¶åä¸‹è½½ç›¸åº”æ’ä»¶ï¼ˆè‡ªå·±æŸ¥ï¼‰\nç”±äºè½¯ä»¶æ˜¯æ”¶è´¹çš„ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯å­¦ç”Ÿï¼Œå¯ä»¥ç”¨å­¦æ ¡ç»™çš„é‚®ç®±è¿›è¡Œå­¦ç”Ÿè®¤è¯å°±å¯ä»¥åœ¨æ¯•ä¸šå‰éƒ½å…è´¹ä½¿ç”¨\nå­¦ç”Ÿè®¤è¯åœ°å€ï¼šhttps://www.jetbrains.com/community/education/#students\nå­¦æ ¡é‚®ç®±è·å–æ–¹æ³• è¿›å…¥å­¦æ ¡å®˜ç½‘ï¼Œè¿›å…¥æ™ºæ…§å¹¿å¤–ï¼Œ\tåœ¨ä¸ªäººäº‹åŠ¡ä¸­å¯ä»¥çœ‹åˆ°è‡ªå·±çš„é‚®ç®±åœ°å€ï¼Œä¸€èˆ¬æ˜¯å­¦å·@gdufs.edu.cn\n \nä¸‹è½½ç ´è§£ç‰ˆä¹Ÿå¯ä»¥ï¼Œä½†å¯èƒ½æ¯”è¾ƒèŠ±æ—¶é—´\næŒ‰æ­¥éª¤å®Œæˆåæ‰“å¼€phpstormï¼Œè¿›è¡Œä¸‹é¢çš„é…ç½®æµç¨‹\n1. æ–°å»ºä¸€ä¸ªé¡¹ç›®  \n2. é€‰æ‹©åˆ›å»ºè·¯å¾„ å»ºè®®æŠŠç›®å½•å»ºåœ¨é›†æˆç¯å¢ƒæŒ‡å®šçš„ç½‘ç»œæ ¹ç›®å½•ä¸‹ï¼Œç›®å½•è·¯å¾„å¦‚ä¸‹ï¼ˆä»¥å®‰è£…åœ¨Dç›˜ä¸ºä¾‹ï¼‰ï¼š\nxamppï¼šD:\\xampp\\htdocs\nphpEnvï¼šD:\\phpEnv\\www\\localhost\n \nè·¯å¾„æœ€åè‡ªå®šä¹‰ä¸€ä¸ªé¡¹ç›®åï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œå«testï¼Œç„¶åç‚¹å‡»creat\n3. ä¿®æ”¹è¿è¡Œç›®å½•  \nå¦‚å›¾æ‰“å¼€è®¾ç½®\n \né€‰æ‹©Deploymentï¼Œç‚¹å‡»é¡¶éƒ¨+å·ï¼Œé€‰æ‹©Local or mounted folder\n \nFolderå°±å¡«å†™è‡ªå·±å®‰è£…çš„é›†æˆç¯å¢ƒè½¯ä»¶çš„ç½‘ç»œæ ¹ç›®å½•\nWeb server URLè®°å¾—è¦åœ¨æœ€åè¡¥ä¸Šæ–œæ†å’Œå½“å‰é¡¹ç›®å\nç‚¹å‡»å³ä¸‹è§’çš„Applyå’ŒOK\n4. Hello World!  \nå¯¹é¡¹ç›®æ–‡ä»¶å¤¹å³é”®æ–°å»ºä¸€ä¸ªphpæ–‡ä»¶ï¼Œè‡ªå®šä¹‰å‘½åï¼Œç„¶åå¼€å§‹å†™ä¸‹ç¬¬ä¸€è¡Œphpä»£ç å§ï¼š\n\u0026lt;?php echo \u0026#34;hello world!\u0026#34;; é¼ æ ‡ç§»åˆ°å³ä¸Šè§’é€‰æ‹©ä¸€ä¸ªæµè§ˆå™¨è¿è¡Œï¼Œæˆ–è€…å³é”®å¹¶é€‰æ‹©runï¼Œæˆ–è€…å¿«æ·é”®Ctrl+Shift+F10\n \nå¦‚æœå‡ºç°äº†æé†’ä½ é€‰æ‹©phpè§£é‡Šå™¨çš„æƒ…å†µ\n \nå°±é€‰æ‹©ä¸€ä¸ªå·²æœ‰çš„ç‰ˆæœ¬å°±è¡Œï¼Œåœ¨settings -\u0026gt; Languages\u0026amp;Frameworks -\u0026gt; PHPä¹Ÿå¯ä»¥è®¾ç½®\nç‚¹å‡»è¿è¡Œåå‡ºç°\n \næˆ–è€…æ˜¯\n \nå¤§åŠŸå‘Šæˆï¼ç°åœ¨å¯ä»¥æ„‰å¿«åœ°æ•²ä»£ç äº†ï¼\nå½“ç„¶ï¼Œè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿æœ¬åœ°å¼€å‘è€Œå®‰è£…çš„é›†æˆç¯å¢ƒï¼Œæœ‰å…´è¶£çš„å°æœ‹å‹å¯ä»¥è‡ªå·±å°è¯•åˆ†åˆ«å®‰è£…æ¯ä¸ªç¯å¢ƒæˆ–è€…åœ¨Linuxä¸Šè¿›è¡Œç¼–è¯‘å®‰è£…\nPHPerç°åœ¨å¯ä»¥å¸¦ç€ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å¼€å†²äº†ï¼\n \n","date":"2020-10-10T11:39:00+08:00","image":"https://ccqstark.github.io/p/php_env/php_hu30aa9710d612d752c63ae5cdcfcf5665_61468_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/php_env/","title":"phpåå°å¼€å‘åŸºç¡€ç¯å¢ƒæ­å»ºæ•™ç¨‹"},{"content":"åŸºæœ¬æ“ä½œ ä¸‹è½½hugo é¦–å…ˆè¦æœ‰Golangçš„ç¯å¢ƒ\nç„¶ååœ¨GitHubä¸Šé€‰æ‹©å¯¹åº”å¹³å°ä¸‹è½½\nhttps://github.com/gohugoio/hugo/releases\nWindowsä¸‹è½½å®Œè¦è®¾ç½®ç¯å¢ƒå˜é‡\nåˆ›å»ºæ–°çš„ç«™ç‚¹ hugo new site \u0026lt;path\u0026gt; \nåœ¨æŒ‡å®šè·¯å¾„ä¸‹åˆ›å»ºåšå®¢ç«™ç‚¹ç›®å½•ï¼Œç›®å½•æœ€åæ˜¯åšå®¢ç«™ç‚¹å\næ‰¾åˆ°å¿ƒä»ªä¸»é¢˜ åœ¨ä¸‹é¢è¿™ä¸ªç½‘ç«™ä¸Šæ‰¾åˆ°å–œæ¬¢çš„ä¸»é¢˜ï¼ŒæŒ‰ç…§å„è‡ªçš„æ–‡æ¡£è¿›è¡Œè®¾ç½®\nhttps://themes.gohugo.io/\næœ¬åœ°é¢„è§ˆ hugo server -t \u0026lt;theme\u0026gt; --buildDrafts \u0026lt;theme\u0026gt;çš„ä½ç½®å¡«å†™ä¸»é¢˜çš„åç§°\nåˆ›å»ºåšå®¢ hugo new post/blog.md åšå®¢çš„markdownæ–‡ä»¶ä¸€å¼€å§‹éƒ½æ˜¯æ”¾åœ¨\\content\\postç›®å½•ä¸‹\nåˆ›å»ºGitHub/Giteeä»“åº“ GithubæŠŠä»“åº“å‘½åä¸º\u0026lt;name\u0026gt;.github.ioå³å¯å¼€å¯åšå®¢æ‰˜ç®¡æœåŠ¡\nGiteeç›´æ¥å‘½åä¸ºè‡ªå·±çš„ç”¨æˆ·åï¼Œä¸€å­—ä¸å·®ï¼ŒåŒæ—¶éœ€è¦æ‰‹åŠ¨å¼€å¯Gitee PageæœåŠ¡\néƒ¨ç½²åˆ°è¿œç«¯ä»“åº“  ç”Ÿæˆ\\publicç›®å½•  hugo --theme=hugo-theme-stack --baseUrl=\u0026#34;https://ccqstark.github.io/\u0026#34; --buildDrafts æ ¹æ®å…·ä½“ä»“åº“ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥æ˜¯\u0026quot;https://ccqstark.gitee.io/\u0026quot; ç„¶åcdè¿›publicç›®å½• åœ¨è¿™ä¸ªç›®å½•ä¸‹åˆ›å»ºgitä»“åº“ï¼Œéƒ¨ç½²ä¹Ÿæ˜¯éƒ¨ç½²è¿™ä¸ªç›®å½•ä¸­çš„å†…å®¹\n ä¸‰éƒ¨æ›²  git add . git commit -m \u0026#39;...\u0026#39; git push github master æ›´æ–°åšå®¢ è¦æ–°å¢ä¸€ç¯‡åšå®¢å°±ç»§ç»­æŒ‰ä¸‹é¢è¿™ä¸ªæ­¥éª¤èµ°\nhugo new post/name.md hugo --theme=hugo-theme-stack --baseUrl=\u0026#34;https://ccqstark.github.io/\u0026#34; --buildDrafts cd public git add . git commit -m \u0026#39;...\u0026#39; git push github master å¦‚æœåªæ˜¯æ›´æ–°å°±é‡æ–°è¿è¡Œç”Ÿæˆ\\publicç›®å½•çš„å‘½ä»¤ï¼Œå†é‡æ–°éƒ¨ç½²å³å¯\nä¸»é¢˜Stacké…ç½® æ­¤åšå®¢çš„ä¸»é¢˜ç”¨çš„æ˜¯Stackï¼Œä¸‹é¢æ˜¯ä¸»é¢˜åœ°å€ï¼Œå¯ä»¥æ‰¾åˆ°æ–‡æ¡£å’ŒDemo\nhttps://themes.gohugo.io/hugo-theme-stack/\niconè®¾ç½® ä½¿ç”¨.icoæ–‡ä»¶ç±»å‹çš„å›¾æ ‡ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨\\publicç›®å½•ä¸‹\n\\layouts\\partials\\headä¸‹æ–°å»ºä¸€ä¸ªcustom.htmlï¼Œå†™ä¸Š\n\u0026lt;link rel=\u0026#34;shortcut icon\u0026#34; href=\u0026#34;https://ccqstark.github.io/icon.ico\u0026#34;/\u0026gt; ä¸ºäº†è®¿é—®ç¨³å®šä¹Ÿå¯ä»¥æ”¹ä¸ºgitee\næ–‡ç« å¤–éƒ¨å±•ç¤ºå›¾ åœ¨\\content\\postç›®å½•ä¸‹åˆ›å»ºåšå®¢æ—¶ï¼Œå…ˆåˆ›å»ºåšå®¢æ ‡é¢˜å‘½åçš„æ–‡ä»¶å¤¹ï¼Œå†åœ¨å…¶ä¸‹åˆ›å»ºmdæ–‡ä»¶index.md\nå›¾ç‰‡ä¹Ÿæ˜¯æ”¾åœ¨å…¶ä¸‹ï¼Œåœ¨mdæ–‡ä»¶å¼€å¤´çš„è®¾ç½®ä¸­æ·»åŠ image: \u0026quot;image.jpg\u0026quot;å³å¯\nTagså’Œåˆ†ç±» æ–‡ç« å¼€å¤´è®¾ç½®\ntags: - Spring categories: - Tech ä¸€ä¸ªæ˜¯æ‰“æ ‡ç­¾ï¼Œä¸€ä¸ªæ˜¯åˆ†ç±»\nAboutå’ŒArchives åœ¨\\content\\pageç›®å½•ä¸‹åˆ›å»ºabout.mdå’Œarchives.md\nabout.mdç”¨äºå†™ä¸ªäººä¿¡æ¯é¡µé¢ï¼Œéœ€è¦æ–‡ç« é¡¶éƒ¨çš„è®¾ç½®å†™æ³•æ”¹ä¸ºå­—æ®µåŠ å†’å·çš„å½¢å¼ï¼Œé…ç½®slugä¸ºabout\narchives.mdç”¨äºåˆ†ç±»å’Œå½’æ¡£é¡µé¢ï¼Œç”¨exampleSiteçš„å°±è¡Œï¼Œä¸ç”¨åšä»»ä½•ä¿®æ”¹\nCategories åœ¨\\content\\categoriesç›®å½•ä¸‹åˆ›å»ºä»¥å„åˆ†ç±»å‘½åçš„æ–‡ä»¶å¤¹\nå„åˆ†ç±»çš„æ–‡ä»¶å¤¹ä¸‹æ”¾ç½®_index.mdå’Œåˆ†ç±»çš„å±•ç¤ºå›¾\n_index.mdä¸­çš„å†…å®¹å°±æ˜¯æ™®é€šæ–‡ç« é¡¶éƒ¨çš„é…ç½®é¡¹ï¼Œæ³¨æ„å›¾ç‰‡åé…ç½®å¯¹äº†å°±è¡Œ\n","date":"2020-10-04T02:44:33+08:00","image":"https://ccqstark.github.io/p/%E4%BD%BF%E7%94%A8hugo-github/gitee%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/hugo_hu8b6407a07803ab5ecf8133363f04b00e_28892_120x120_fill_box_smart1_2.png","permalink":"https://ccqstark.github.io/p/%E4%BD%BF%E7%94%A8hugo-github/gitee%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/","title":"ä½¿ç”¨Hugo+github/giteeæ­å»ºä¸ªäººåšå®¢"}]